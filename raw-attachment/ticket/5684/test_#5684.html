<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript">
    function move() {
        $("div#container > p").animate({"marginLeft": "+=200px"}, 1000, "linear", function() {
            if(this.id=="asd") {
                //this if block is just to show that the callback
                //never fires for the second paragraph
                this.id="bsd";
                alert("Boohoo, I won't ever be called :-(");
            }
            foo(); //undefined function call --> exception
        });
    }
    function moveBack() {
        $('div#container > p').css('marginLeft', '')
    }
    </script>
    <title>Test for Ticket #5684</title>
</head>
<body>
    <div id="container">
        <p>Move me right</p>
        <p id="asd">Move me right too</p>
    </div>
    <input type="button" value="#1: Move paragraphs right" onclick="move()" />
    <input type="button" value="#2: Reset paragraphs" onclick="moveBack()" /><br/><br/>
    <div id="explanation" style="border:1px solid black; padding-left:5px">
        <p>Clicking the first button (#1) will move the above paragraphs 200px to the right</p>
        <p>Clicking the second button (#2) will reset them to the original position</p>
        <p>Due to the nature of the bug I described in the bug ticket a second click on #1 won't
            move the paragraphs further to the right</p>
        <p>Also due to the nature of this bug clicking the button #2 after the animation will
            only reset one of the two paragraphs the other will keep moving right</p>
        <p>If you click the button #2 fast you will notice how also the first paragraph is reset
            but springs back to the right immediatly</p>
    </div>
</body>
</html>