<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#6577 (jQuery.jsonParse is freezing FireFox and Chrome when parsing non-breaking whitespace (0xA0)) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/6576/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/6578/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#6577</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(fixed)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened May 17, 2010 12:58PM UTC</p>
      
        <p>Closed November 21, 2010 10:34PM UTC</p>
      
      
        <p>Last modified January 21, 2011 02:55PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">jQuery.jsonParse is freezing FireFox and Chrome when parsing non-breaking whitespace (0xA0)</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        maggrave
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        high
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.4.4">1.4.4</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ajax</td>
      
        <th>Version:</th>
      
      <td>1.4.2</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>parse, json, parseJSON, whitespace, 160, a0, nbsp</td>
      
        <th>Cc:</th>
      
      <td>maggrave@nox.pl</td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>It seems that recently added jQuery.parseJSON() have problems with parsing strings which contains multiple non-breaking whitespaces. </p><p>See example below, between BEG[ and ]END i've placed set of 0xA0 characters. </p><blockquote>   &lt;script src='http://code.jquery.com/jquery-1.4.2.js' type="text/javascript"&gt;&lt;/script&gt; &lt;script&gt; var d = '{"a":"BEG[                              ]END"}'; var jso =  jQuery.parseJSON( d ); &lt;/script&gt;</blockquote><p>Note: make sure that while testing you are testing this is with real 0xA0 characers, copying code from this ticket may replace 0xA0 chars with normal space 0x20 in this case you won't be able to replicate an issue.</p><p>It works fine when there is only few of such spaces, when string of whitespaces is longer (let's say 20+) than browsers behave funky (freezes and/or crashes)</p><p>OS: Windows Server 2003 R2 SE SP2</p><p>Issue found in:</p><ul><li><a href="/wiki/FireFox">FireFox</a> 3.6.3</li><li>Chrome 4.1.249.1064</li></ul><p>Works fine in:</p><ul><li>Opera 10.54</li><li>IE8</li><li>Safari 4.0.5</li></ul></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (1)</summary>

  <ul class="ticket-attachments">
    
      <li>
        <a href="/attachment/ticket/6577/test.rar/index.html">test.rar</a> (0.3 KB) - added by maggrave
        <strong>June 15, 2010 08:47AM UTC</strong>.<br>
        
      </li>
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (11)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 12, 2010 03:21AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ worksforme</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I tried your example in Firefox 3.6.3 using both A0 characters and \\u00A0 escape sequences in the string and it worked for me.</p><p>The actual charset of the file containing the script snippet above could make a big difference. A literal A0 character in the script file would only be valid if the charset of the script was ISO-8859-1. If the file containing this script was UTF-8 then the browser might well see them as invalid characters. I tried adding a meta utf-8 tag but still didn't get any error. </p><p>If you can consistently reproduce the problem, reopen the ticket and attach your test case.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 15, 2010 08:50AM UTC by <span class="author">maggrave</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">worksforme</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Reopening per suggestion above, please retest with attached file. Just open this html file in </p><ul><li><a href="/wiki/FireFox">FireFox</a> 3.6.3</li><li>Chrome 4-5</li></ul>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 11, 2010 11:48PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">ajax</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 14, 2010 09:13PM UTC by <span class="author">ernestohs@gmail.com</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><strong>Workaround</strong></p><p>This works for me (fix problem on Firefox & Google Chrome):</p><p><a href="http://jsfiddle.net/Z5dPY/1/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/Z5dPY/1/</a></p><pre class="wiki">
patch:
501,504c501,502
&lt;         if ($.browser.msie) {
&lt;             // Make sure leading/trailing whitespace is removed (IE can't handle it)
&lt;             data = jQuery.trim(data);
&lt;         }
---
&gt; 		// Make sure leading/trailing whitespace is removed (IE can't handle it)
&gt; 		data = jQuery.trim( data );

</pre><p></p><hr><p></p><p>Ernesto.</p><p><a href="http://www.twitter.com/ernestohs" class="ext-link"><span class="icon"></span>http://www.twitter.com/ernestohs</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 21, 2010 10:34PM UTC by <span class="author">jitter</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">I tried the test case provied by maggrave and it does freeze FF 3.6.12 with jQuery 1.4.2. Switching to jQuery 1.4.4 fixes the problem and the test case completes with no problems.&#92;
&#92;
If you feel closing this ticket was incorrect or the bug still persists for you, feel free to report back with a reproducible test case and to reopen the ticket. </span> → <span class="change-field-new">1290379230272809</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.4.2</span> → <span class="change-field-new">1.4.4</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-new">→ high</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>I tried the test case provied by maggrave and it does freeze FF 3.6.12 with jQuery 1.4.2. Switching to jQuery 1.4.4 fixes the problem and the test case completes with no problems and parsing the data correctly.</p><p>If you feel closing this ticket was incorrect or the bug still persists for you, feel free to report back with a reproducible test case and to reopen the ticket. </p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 20, 2011 10:45PM UTC by <span class="author">Joseph</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I am having the same problem with jquery 1.4.2 and tried with the new version of jquery, and can confirm that it is fixed. However, as I am unable to upgrade the my current version of jquery because it is used with lots of plugins etc.. and it will take long time to do all the updates and tests, I would like to know how can I fix the problem without upgrading my jquery 1.4.2?</p><p>Tried many many things, but unable to fix it for Firefox. I fixed it for IE7 but firefox just wont take it and it freezes for around 3-4 mins before it responds again.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 20, 2011 11:45PM UTC by <span class="author">danheberden</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Joseph, just use json2.js - here&#39;s how to shove it into parseJSON for ajax callbacks &#39;n what not...   http://jsfiddle.net/danheberden/E444c/&#92;
&#92;
https://github.com/douglascrockford/JSON-js</span> → <span class="change-field-new">1295567325430217</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Joseph, just use json2.js - here's how to shove it into parseJSON for ajax callbacks 'n what not...   <a href="http://jsfiddle.net/danheberden/8rUgd/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/danheberden/8rUgd/</a></p><p><a href="https://github.com/douglascrockford/JSON-js" class="ext-link"><span class="icon"></span>https://github.com/douglascrockford/JSON-js</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 21, 2011 10:09AM UTC by <span class="author">Joseph</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I tried with JSON2 but still have the same problem. I tried though with latest version of jquery and no problem there. </p><p>However, it could be my json has many none-breaking whitespaces.</p><p>Tried with native built-in browser and eval, same thing in firefox but IE7 no problem.</p><p>Do you have an idea how JQuery parse JSON in the new version?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 21, 2011 10:14AM UTC by <span class="author">Joseph</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Tried to remove all multiple whitespaces with the following regex and it worked. So it has something to do with whitespaces still in firefox parsing.</p><p>myString.replace(/\\s+/g, ' ');</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 21, 2011 10:16AM UTC by <span class="author">Joseph</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Tried to remove all multiple whitespaces with the following regex and it worked. So it has something to do with whitespaces still in firefox parsing.</p><pre class="wiki">

myString.replace(/\\s+/g, ' ');
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 21, 2011 02:55PM UTC by <span class="author">jitter</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Replying to [comment:10 Joseph]:&#92;
&gt; Tried to remove all multiple whitespaces with the following regex and it worked. So it has something to do with whitespaces still in firefox parsing.&#92;
&gt; &#92;
&gt; {{{&#92;
&gt; &#92;
&gt; myString.replace(/&#92;&#92;s+/g, &#39; &#39;);&#92;
&gt; }}}&#92;
&#92;
In the future, instead of posting on an old closed/fixed ticket on the bug tracker, please try the [http://webchat.freenode.net/?channels=#jquery #jquery irc channel on freenode] or the [http://forum.jquery.com jQuery Forum] for such support requests. There you will be able to gain help much quicker.&#92;
&#92;
-----&#92;
&#92;
This was a regex bug in FF check #7477 for more information.&#92;
&#92;
To workaround this in 1.4.2 try including this [http://pastebin.com/SE42Bkk5 snippet] right after you load jQuery.</span> → <span class="change-field-new">1295621808699123</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:10 Joseph]:</p><blockquote> Tried to remove all multiple whitespaces with the following regex and it worked. So it has something to do with whitespaces still in firefox parsing.  <pre class="wiki">
&gt; 
&gt; myString.replace(/\\s+/g, ' ');
&gt; </pre></blockquote><p>In the future, instead of posting on an old closed/fixed ticket on the bug tracker, please try the <a href="http://webchat.freenode.net/?channels=#jquery" class="ext-link"><span class="icon"></span>#jquery irc channel on freenode</a> or the <a href="http://forum.jquery.com" class="ext-link"><span class="icon"></span>jQuery Forum</a> for such support requests. There you will be able to gain help much quicker.</p><p></p><hr><p></p><p>This was a regex bug in FF check <a href="/ticket/7477">#7477</a> for more information.</p><p>To workaround this in 1.4.2 try including this <a href="http://pastebin.com/GTwKMKdL" class="ext-link"><span class="icon"></span>snippet</a> right after you load jQuery.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
