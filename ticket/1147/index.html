<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#1147 (Interface - Array broken on IE6/Safari/Konqueror (indexof)) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/1146/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/1148/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#1147</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened April 27, 2007 06:07PM UTC</p>
      
        <p>Closed March 31, 2008 01:36AM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">Interface - Array broken on IE6/Safari/Konqueror (indexof)</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        wccrawford
      </td>
      <th>Owned by:</th>
      <td>stefan</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        major
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.1.3">1.1.3</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>interface</td>
      
        <th>Version:</th>
      
      <td>1.1.2</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>array indexof</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>The 'older browser helper' function in iutil.js causes arrays to exhibit odd behavior in IE6, Konqueror, and Safari.  (I don't have Safari, but a co-worker showed me it's failure in it.)  Firefox works fine.</p><p>The following code will exhibit the bug.</p><pre class="wiki">
&lt;script type="text/javascript"&gt;
// Helper function to support older browsers!
var arr = new Array();
if (!new Array().indexOf)
{
	Array.prototype.indexOf = function(v, n){
		n = (n == null) ? 0 : n;
		var m = this.length;
		for (var i=n; i&lt;m; i++)
		{
			if ((i &gt;= 0) && (this[i] == v))
			{
				return i;
			}
		}
		return -1;
	}
}

var arr = new Array();
arr['a'] = 'A';
arr['b'] = 'B';
arr['c'] = 'C';
arr['d'] = 'D';
for(i in arr)
{
	document.write(i);
	document.write(arr[i]);
}
&lt;/script&gt;
</pre><p>Firefox outputs 'aAbBcCdD' as expected, but the other browsers output 'indexOffunction (v, n) { n = n == null ? 0 : n; var m = this.length; for (i = n; i &lt; m; i++) { if (i &gt;= 0 && this[i] == v) { return i; } } return -1; }aAbBcCdD'.  </p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (5)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 30, 2007 10:27AM UTC by <span class="author">wccrawford</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I just realized I had changed the javascript attempting to find the problem.  The original javascript is:</p><pre class="wiki">
// Helper function to support older browsers!
[].indexOf || (Array.prototype.indexOf = function(v, n){
	n = (n == null) ? 0 : n;
	var m = this.length;
	for (var i=n; i&lt;m; i++)
		if (this[i] == v)
			return i;
	return -1;
});
</pre><p>It does, of course, exhibit the same problem.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 30, 2007 02:35AM UTC by <span class="author">khmer42</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This doesn't break all arrays, only associative arrays. Remember arrays in <a href="/wiki/JavaScript">JavaScript</a> aren't really arrays, they are just objects presented in an array like way. Doing a for/in loop will return all properties of the array including prototype methods, which is what's happening here. There are only three ways this can be solved, none of which are particularly practical or helpful:</p><ul><li>Stop using IE until they one day implement indexOf for arrays.</li><li>Tell all users that if they use associative arrays in their code interface will break their apps. </li><li>Re-write any interface modules that use indexOf on an array, to use a separate method which can be passed an array and perform the same task, rather than adding a new method to all arrays which fixes one problem but creates a multitude of others.</li></ul><p>I personally think the last option would be the best and most practical, interface won't go far if it breaks existing <a href="/wiki/JavaScript">JavaScript</a> functionality. We all know that using associative arrays in <a href="/wiki/JavaScript">JavaScript</a> isn't 'best practice', but it is still common place, so must be addressed.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 31, 2007 02:46PM UTC by <span class="author">wccrawford</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Well, the conclusion that I came to was that this should -not- be included for IE6/Safari/Konqueror as they do -not- need it.  It's only older browsers that need it.  Without this code, they all work fine.</p><p>To be sure, I just tested it in IE6 and IE7.  They both exhibit the same behavior.  Without the overridden indexOf, they both work fine.  With it, they both produce the problem.</p><p>So add IE7 to the list of affected browsers as well.</p><p>Again, the real fix here should be to make sure that the code is only included on browsers that actually need it.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 07, 2008 04:52PM UTC by <span class="author">shula</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>A quick workaround: either add browser specific validation (for IE and other broken browsers), or comment out the whole block below: "// Helper function to support older browsers".</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 31, 2008 01:36AM UTC by <span class="author">scott.gonzal</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">The &#39;older browser helper&#39; function in iutil.js causes arrays to exhibit odd behavior in IE6, Konqueror, and Safari.  (I don&#39;t have Safari, but a co-worker showed me it&#39;s failure in it.)  Firefox works fine.&#92;
&#92;
The following code will exhibit the bug.&#92;
{{{&#92;
&lt;script type=&quot;text/javascript&quot;&gt;&#92;
// Helper function to support older browsers!&#92;
var arr = new Array();&#92;
if (!new Array().indexOf)&#92;
{&#92;
	Array.prototype.indexOf = function(v, n){&#92;
		n = (n == null) ? 0 : n;&#92;
		var m = this.length;&#92;
		for (var i=n; i&lt;m; i++)&#92;
		{&#92;
			if ((i &gt;= 0) &amp;&amp; (this[i] == v))&#92;
			{&#92;
				return i;&#92;
			}&#92;
		}&#92;
		return -1;&#92;
	}&#92;
}&#92;
&#92;
var arr = new Array();&#92;
arr[&#39;a&#39;] = &#39;A&#39;;&#92;
arr[&#39;b&#39;] = &#39;B&#39;;&#92;
arr[&#39;c&#39;] = &#39;C&#39;;&#92;
arr[&#39;d&#39;] = &#39;D&#39;;&#92;
for(i in arr)&#92;
{&#92;
	document.write(i);&#92;
	document.write(arr[i]);&#92;
}&#92;
&lt;/script&gt;&#92;
}}}&#92;
Firefox outputs &#39;aAbBcCdD&#39; as expected, but the other browsers output &#39;indexOffunction (v, n) { n = n == null ? 0 : n; var m = this.length; for (i = n; i &lt; m; i++) { if (i &gt;= 0 &amp;&amp; this[i] == v) { return i; } } return -1; }aAbBcCdD&#39;.  </span> → <span class="change-field-new">The &#39;older browser helper&#39; function in iutil.js causes arrays to exhibit odd behavior in IE6, Konqueror, and Safari.  (I don&#39;t have Safari, but a co-worker showed me it&#39;s failure in it.)  Firefox works fine.&#92;
&#92;
The following code will exhibit the bug.&#92;
{{{&#92;
&lt;script type=&quot;text/javascript&quot;&gt;&#92;
// Helper function to support older browsers!&#92;
var arr = new Array();&#92;
if (!new Array().indexOf)&#92;
{&#92;
	Array.prototype.indexOf = function(v, n){&#92;
		n = (n == null) ? 0 : n;&#92;
		var m = this.length;&#92;
		for (var i=n; i&lt;m; i++)&#92;
		{&#92;
			if ((i &gt;= 0) &amp;&amp; (this[i] == v))&#92;
			{&#92;
				return i;&#92;
			}&#92;
		}&#92;
		return -1;&#92;
	}&#92;
}&#92;
&#92;
var arr = new Array();&#92;
arr[&#39;a&#39;] = &#39;A&#39;;&#92;
arr[&#39;b&#39;] = &#39;B&#39;;&#92;
arr[&#39;c&#39;] = &#39;C&#39;;&#92;
arr[&#39;d&#39;] = &#39;D&#39;;&#92;
for(i in arr)&#92;
{&#92;
	document.write(i);&#92;
	document.write(arr[i]);&#92;
}&#92;
&lt;/script&gt;&#92;
}}}&#92;
Firefox outputs &#39;aAbBcCdD&#39; as expected, but the other browsers output &#39;indexOffunction (v, n) { n = n == null ? 0 : n; var m = this.length; for (i = n; i &lt; m; i++) { if (i &gt;= 0 &amp;&amp; this[i] == v) { return i; } } return -1; }aAbBcCdD&#39;.  </span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Interface is no longer supported; consider switching to <a href="http://ui.jquery.com/" class="ext-link"><span class="icon"></span>jQuery UI</a>.</p>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
