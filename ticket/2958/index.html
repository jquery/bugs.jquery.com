<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#2958 (jquery.ui.sortables Fails to sort to last position with &amp;lt;div&amp;gt; tags) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/2957/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/2959/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#2958</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened May 29, 2008 06:21PM UTC</p>
      
        <p>Closed May 30, 2008 12:06AM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">jquery.ui.sortables Fails to sort to last position with &lt;div&gt; tags</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        malfist
      </td>
      <th>Owned by:</th>
      <td>joern</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        major
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.3">1.3</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>web</td>
      
        <th>Version:</th>
      
      <td>1.2.5</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>ui, jquery.ui, sortables</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>When applying sortable to the following list, the element with text in the second div tag ("blah") can not be dragged to the last position. It can be dragged to the next to last then others move above it.</p><pre class="wiki">
&lt;ul style="position: relative;" class="ui-sortable" id="sortable_left"&gt;


&lt;li style="visibility: visible;"&gt;&lt;div class="pane"&gt;	&lt;div class="bar"&gt;
							&lt;div class="title"&gt;intramail_info_pane&lt;/div&gt;
							&lt;div class="controls"&gt;&lt;div id="31506349dc1205e2af91cc7e882c640cdeb05a01" style="float: left;"&gt;&lt;a onclick='toggelView("intramail_info_pane", "31506349dc1205e2af91cc7e882c640cdeb05a01", "http://127.0.0.1/images")'&gt;&lt;img id="img" src="http://127.0.0.1/images/icons/up.png" alt="minimize" height="18"&gt;&lt;/a&gt;&lt;/div&gt;&lt;a id="9b24475e58a6ac083e0e4485f9139332f8b9e2a0" onclick='removePane("intramail_info_pane")'&gt;&lt;img src="http://127.0.0.1/images/icons/remove.png" alt="close" height="18"&gt;&lt;/a&gt;&lt;/div&gt;
	
						&lt;/div&gt;	&lt;div id="intramail_info_pane"&gt;
						
	&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;&lt;li style="visibility: visible;"&gt;&lt;div class="pane"&gt;	&lt;div class="bar"&gt;
							&lt;div class="title"&gt;avatar_pane&lt;/div&gt;
							&lt;div class="controls"&gt;&lt;div id="b3aa0ecd94a2fda0aa1b3a81449c1d47ff82f7e2" style="float: left;"&gt;&lt;a onclick='toggelView("avatar_pane", "b3aa0ecd94a2fda0aa1b3a81449c1d47ff82f7e2", "http://127.0.0.1/images")'&gt;&lt;img id="img" src="http://127.0.0.1/images/icons/up.png" alt="minimize" height="18"&gt;&lt;/a&gt;&lt;/div&gt;&lt;a id="55c1943f65c7c105ae98e6703cd64127b6585656" onclick='removePane("avatar_pane")'&gt;&lt;img src="http://127.0.0.1/images/icons/remove.png" alt="close" height="18"&gt;&lt;/a&gt;&lt;/div&gt;
	
						&lt;/div&gt;	&lt;div id="avatar_pane"&gt;
						&lt;p&gt;blah&lt;/p&gt;
	&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;&lt;li style="visibility: visible;"&gt;&lt;div class="pane"&gt;	&lt;div class="bar"&gt;
							&lt;div class="title"&gt;admin_link_pane&lt;/div&gt;
							&lt;div class="controls"&gt;&lt;div id="094aa7a391d13c934835ad107ee606d23bbac47b" style="float: left;"&gt;&lt;a onclick='toggelView("admin_link_pane", "094aa7a391d13c934835ad107ee606d23bbac47b", "http://127.0.0.1/images")'&gt;&lt;img id="img" src="http://127.0.0.1/images/icons/down.png" alt="maximize" height="18"&gt;&lt;/a&gt;&lt;/div&gt;&lt;a id="0d3851411c3a681fadd058efe2d95ecef336cf7a" onclick='removePane("admin_link_pane")'&gt;&lt;img src="http://127.0.0.1/images/icons/remove.png" alt="close" height="18"&gt;&lt;/a&gt;&lt;/div&gt;
	
						&lt;/div&gt;	&lt;div style="display: none;" id="admin_link_pane"&gt;
						
	&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;
</pre></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (6)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 29, 2008 06:23PM UTC by <span class="author">malfist</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Update:</p><p>This only happens with some have content and some do not. When all have content in the second div, it moves freely. Although they sometime disappear.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 29, 2008 06:26PM UTC by <span class="author">malfist</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>An additional test. Those id's have no css linked to it. You cannot drag the first list item below the last.</p><pre class="wiki">
&lt;ul id='sort'&gt;
		&lt;li&gt;&lt;div&gt;1&lt;div&gt;&lt;br /&gt;&nbsp;2&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;

		&lt;li&gt;&lt;div&gt;2&lt;/div&gt;&lt;/li&gt;
		&lt;li&gt;&lt;div&gt;3&lt;/div&gt;&lt;/li&gt;
		&lt;li&gt;&lt;div&gt;4&lt;/div&gt;&lt;/li&gt;
	&lt;/ul&gt;
&lt;/div&gt;
&lt;script type='text/javascript'&gt;
	$("#sort").sortable({ items: "li", revert: true, tree: true });
&lt;/script&gt;
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 29, 2008 06:48PM UTC by <span class="author">malfist</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Attaching my version (grabbed from ui.jquery, personalized (contains everything). I have modified it where I think the error is occurring. drag: function(e) acts funny when the nested (or multipule does not have to be nested) is dragged, reporting the item number and the max items differently than the rest of the items.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 29, 2008 06:49PM UTC by <span class="author">malfist</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Nevermind I cannot do that. I'll see if I can copy and paste here.</p><p>{{{</p><p>/*</p> <ul><li>jQuery UI @VERSION</li></ul><p> *</p> <ul><li>Copyright (c) 2008 Paul Bakaus (ui.jquery.com)</li> <li>Dual licensed under the MIT (MIT-LICENSE.txt)</li> <li>and GPL (GPL-LICENSE.txt) licenses.</li></ul><p> *</p> <ul><li><a href="http://docs.jquery.com/UI" class="ext-link"><span class="icon"></span>http://docs.jquery.com/UI</a></li></ul><p> *</p> <ul><li>$Date: 2008-05-04 16:52:15 +0200 (So, 04 Mai 2008) $</li> <li>$Rev: 5419 $</li></ul><p> */</p><p>;(function($) {</p><p>	$.ui = $.ui || {};</p><p>	<em> Add methods that are vital for all mouse interaction stuff</em></p><p>	 (plugin registering)</p><p>	$.extend($.ui, {</p><p>		plugin: {</p><p>			add: function(module, option, set) {</p><p>				var proto = $.ui[module].prototype;</p><p>				for(var i in set) {</p><p>					proto.plugins[i] = proto.plugins[i] || [];</p><p>					proto.plugins[i].push([option, set[i]]);</p><p>				}</p><p>			},</p><p>			call: function(instance, name, args) {</p><p>				var set = instance.plugins[name];</p><p>				if(!set) { return; }</p><p>				for (var i = 0; i &lt; set.length; i++) {</p><p>					if (instance.options[set[i][0]]) {</p><p>						set[i][1].apply(instance.element, args);</p><p>					}</p><p>				}</p><p>			}	</p><p>		},</p><p>		cssCache: {},</p><p>		css: function(name) {</p><p>			if ($.ui.cssCache[name]) { return $.ui.cssCache[name]; }</p><p>			var tmp = $('&lt;div class="ui-resizable-gen"&gt;').addClass(name).css({position:'absolute', top:'-5000px', left:'-5000px', display:'block'}).appendTo('body');</p><p>			<em>if (!$.browser.safari)</em></p><p>				tmp.appendTo('body'); </p><p>			<em>Opera and Safari set width and height to 0px instead of auto</em></p><p>			Safari returns rgba(0,0,0,0) when bgcolor is not set</p><p>			$.ui.cssCache[name] = !!(</p><p>				(!(/auto|default/).test(tmp.css('cursor')) || (/^[1-9]/).test(tmp.css('height')) || (/^[1-9]/).test(tmp.css('width')) || </p><p>				!(/none/).test(tmp.css('backgroundImage')) || !(/transparent|rgba\\(0, 0, 0, 0\\)/).test(tmp.css('backgroundColor')))</p><p>			);</p><p>			try { $('body').get(0).removeChild(tmp.get(0));	} catch(e){}</p><p>			return $.ui.cssCache[name];</p><p>		},</p><p>		disableSelection: function(e) {</p><p>			e.unselectable = "on";</p><p>			e.onselectstart = function() { return false; };</p><p>			if (e.style) { e.style.MozUserSelect = "none"; }</p><p>		},</p><p>		enableSelection: function(e) {</p><p>			e.unselectable = "off";</p><p>			e.onselectstart = function() { return true; };</p><p>			if (e.style) { e.style.MozUserSelect = ""; }</p><p>		},</p><p>		hasScroll: function(e, a) {</p><p>			var scroll = /top/.test(a||"top") ? 'scrollTop' : 'scrollLeft', has = false;</p><p>			if (e[scroll] &gt; 0) return true; e[scroll] = 1;</p><p>			has = e[scroll] &gt; 0 ? true : false; e[scroll] = 0;</p><p>			return has;</p><p>		}</p><p>	});</p><p>	/** jQuery core modifications and additions **/</p><p>	var _remove = $.fn.remove;</p><p>	$.fn.remove = function() {</p><p>		$("*", this).add(this).trigger("remove");</p><p>		return _remove.apply(this, arguments );</p><p>	};</p><p>	<em> $.widget is a factory to create jQuery plugins</em></p><p>	 taking some boilerplate code out of the plugin code</p><p>	// created by Scott González and Jörn Zaefferer</p><p>	function getter(namespace, plugin, method) {</p><p>		var methods = $[namespace][plugin].getter || [];</p><p>		methods = (typeof methods == "string" ? methods.split(/,?\\s+/) : methods);</p><p>		return ($.inArray(method, methods) != -1);</p><p>	};</p><p>	var widgetPrototype = {</p><p>		init: function() {},</p><p>		destroy: function() {},</p><p>		getData: function(e, key) {</p><p>			return this.options[key];</p><p>		},</p><p>		setData: function(e, key, value) {</p><p>			this.options[key] = value;</p><p>		},</p><p>		enable: function() {</p><p>			this.setData(null, 'disabled', false);</p><p>		},</p><p>		disable: function() {</p><p>			this.setData(null, 'disabled', true);</p><p>		}</p><p>	};</p><p>	$.widget = function(name, prototype) {</p><p>		var namespace = name.split(".")[0];</p><p>		name = name.split(".")[1];</p><p>		<em> create plugin method</em></p><p>		$.fn[name] = function(options, data) {</p><p>			var isMethodCall = (typeof options == 'string'),</p><p>				args = arguments;</p><p>			if (isMethodCall && getter(namespace, name, options)) {</p><p>				var instance = $.data(this[0], name);</p><p>				return (instance ? instance[options](data) : undefined); </p><p>			}</p><p>			return this.each(function() {</p><p>				var instance = $.data(this, name);</p><p>				if (!instance) {</p><p>					$.data(this, name, new $[namespace][name](this, options));</p><p>				} else if (isMethodCall) {</p><p>					instance[options].apply(instance, $.makeArray(args).slice(1));</p><p>				}</p><p>			});</p><p>		};</p><p>		 create widget constructor</p><p>		$[namespace][name] = function(element, options) {</p><p>			var self = this;</p><p>			this.options = $.extend({}, $[namespace][name].defaults, options);</p><p>			this.element = $(element)</p><p>				.bind('setData.' + name, function(e, key, value) {</p><p>					return self.setData(e, key, value);</p><p>				})</p><p>				.bind('getData.' + name, function(e, key) {</p><p>					return self.getData(e, key);</p><p>				})</p><p>				.bind('remove', function() {</p><p>					return self.destroy();</p><p>				});</p><p>			this.init();</p><p>		};</p><p>		// add widget prototype</p><p>		$[namespace][name].prototype = $.extend({}, widgetPrototype, prototype);</p><p>	};</p><p>	/** Mouse Interaction Plugin **/</p><p>	$.widget("ui.mouse", {</p><p>		init: function() {</p><p>			var self = this;</p><p>			this.element</p><p>				.bind('mousedown.mouse', function() { return self.click.apply(self, arguments); })</p><p>				.bind('mouseup.mouse', function() { (self.timer && clearInterval(self.timer)); })</p><p>				.bind('click.mouse', function() { if(self.initialized) { self.initialized = false; return false; } });</p><p>			<em>Prevent text selection in IE</em></p><p>			if ($.browser.msie) {</p><p>				this.unselectable = this.element.attr('unselectable');</p><p>				this.element.attr('unselectable', 'on');</p><p>			}</p><p>		},</p><p>		destroy: function() {</p><p>			this.element.unbind('.mouse').removeData("mouse");</p><p>			($.browser.msie && this.element.attr('unselectable', this.unselectable));</p><p>		},</p><p>		trigger: function() { return this.click.apply(this, arguments); },</p><p>		click: function(e) {</p><p>			if(    e.which != 1 only left click starts dragging</p><p>				|| $.inArray(e.target.nodeName.toLowerCase(), this.options.dragPrevention || []) != -1 <em> Prevent execution on defined elements</em></p><p>				|| (this.options.condition && !this.options.condition.apply(this.options.executor || this, [e, this.element])) Prevent execution on condition</p><p>			) { return true; }</p><p>			var self = this;</p><p>			this.initialized = false;</p><p>			var initialize = function() {</p><p>				self._MP = { left: e.pageX, top: e.pageY }; <em> Store the click mouse position</em></p><p>				$(document).bind('mouseup.mouse', function() { return self.stop.apply(self, arguments); });</p><p>				$(document).bind('mousemove.mouse', function() { return self.drag.apply(self, arguments); });</p><p>				if(!self.initalized && Math.abs(self._MP.left-e.pageX) &gt;= self.options.distance || Math.abs(self._MP.top-e.pageY) &gt;= self.options.distance) {</p><p>					(self.options.start && self.options.start.call(self.options.executor || self, e, self.element));</p><p>					(self.options.drag && self.options.drag.call(self.options.executor || self, e, this.element)); This is actually not correct, but expected</p><p>					self.initialized = true;</p><p>				}</p><p>			};</p><p>			if(this.options.delay) {</p><p>				if(this.timer) { clearInterval(this.timer); }</p><p>				this.timer = setTimeout(initialize, this.options.delay);</p><p>			} else {</p><p>				initialize();</p><p>			}</p><p>			return false;</p><p>		},</p><p>		stop: function(e) {</p><p>			if(!this.initialized) {</p><p>				return $(document).unbind('mouseup.mouse').unbind('mousemove.mouse');</p><p>			}</p><p>			(this.options.stop && this.options.stop.call(this.options.executor || this, e, this.element));</p><p>			$(document).unbind('mouseup.mouse').unbind('mousemove.mouse');</p><p>			return false;</p><p>		},</p><p>		drag: function(e) {</p><p>			var o = this.options;</p><p>			if ($.browser.msie && !e.button) {</p><p>				return this.stop.call(this, e); // IE mouseup check</p><p>			}</p><p>			if(!this.initialized && (Math.abs(this._MP.left-e.pageX) &gt;= o.distance || Math.abs(this._MP.top-e.pageY) &gt;= o.distance)) {</p><p>				(o.start && o.start.call(o.executor || this, e, this.element));</p><p>				this.initialized = true;</p><p>			} else {</p><p>				if(!this.initialized) { return false; }</p><p>			}</p><p>			(o.drag && o.drag.call(this.options.executor || this, e, this.element));</p><p>			return false;</p><p>		}</p><p>	});</p><p>})(jQuery);</p><p>/*</p> <ul><li>jQuery UI Draggable</li></ul><p> *</p> <ul><li>Copyright (c) 2008 Paul Bakaus</li> <li>Dual licensed under the MIT (MIT-LICENSE.txt)</li> <li>and GPL (GPL-LICENSE.txt) licenses.</li> *  <li><a href="http://docs.jquery.com/UI/Draggables" class="ext-link"><span class="icon"></span>http://docs.jquery.com/UI/Draggables</a></li></ul><p> *</p> <ul><li>Depends:</li></ul><p> *	ui.core.js</p><p> *</p> <ul><li>Revision: $Id: ui.draggable.js 5433 2008-05-04 20:07:17Z joern.zaefferer $</li></ul><p> */</p><p>;(function($) {</p><p>	$.widget("ui.draggable", {</p><p>		init: function() {</p><p>			<em>Initialize needed constants</em></p><p>			var o = this.options;</p><p>			Initialize mouse events for interaction</p><p>			this.element.mouse({</p><p>				executor: this,</p><p>				delay: o.delay,</p><p>				distance: o.distance,</p><p>				dragPrevention: o.cancel,</p><p>				start: this.start,</p><p>				stop: this.stop,</p><p>				drag: this.drag,</p><p>				condition: function(e) {</p><p>					var handle = !this.options.handle || !$(this.options.handle, this.element).length ? true : false;</p><p>					if(!handle) $(this.options.handle, this.element).each(function() { if(this == e.target) handle = true; });</p><p>					return !(e.target.className.indexOf("ui-resizable-handle") != -1 || this.options.disabled) && handle;</p><p>				}</p><p>			});</p><p>			//Position the node</p><p>			if(o.helper == 'original' && !(/(relative|absolute|fixed)/).test(this.element.css('position')))</p><p>				this.element.css('position', 'relative');</p><p>		},</p><p>		start: function(e) {</p><p>			var o = this.options;</p><p>			if($.ui.ddmanager) $.ui.ddmanager.current = this;</p><p>			//Create and append the visible helper</p><p>			this.helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [e])) : (o.helper == 'clone' ? this.element.clone() : this.element);</p><p>			if(!this.helper.parents('body').length) this.helper.appendTo((o.appendTo == 'parent' ? this.element[0].parentNode : o.appendTo));</p><p>			if(!this.helper.css("position") || this.helper.css("position") == "static") this.helper.css("position", "absolute");</p><p>			/*</p>			 <ul><li>- Position generation -</li>			 <li>This block generates everything position related - it's the core of draggables.</li></ul><p>			 */</p><p>			this.margins = {																				<em>Cache the margins</em></p><p>				left: (parseInt(this.element.css("marginLeft"),10) || 0),</p><p>				top: (parseInt(this.element.css("marginTop"),10) || 0)</p><p>			};		</p><p>			this.cssPosition = this.helper.css("position");													Store the helper's css position</p><p>			this.offset = this.element.offset();															<em>The element's absolute position on the page</em></p><p>			this.offset = {																					Substract the margins from the element's absolute offset</p><p>				top: this.offset.top - this.margins.top,</p><p>				left: this.offset.left - this.margins.left</p><p>			};</p><p>			this.offset.click = {																			<em>Where the click happened, relative to the element</em></p><p>				left: e.pageX - this.offset.left,</p><p>				top: e.pageY - this.offset.top</p><p>			};</p><p>			this.offsetParent = this.helper.offsetParent(); var po = this.offsetParent.offset();			Get the offsetParent and cache its position</p><p>			this.offset.parent = {																			<em>Store its position plus border</em></p><p>				top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"),10) || 0),</p><p>				left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"),10) || 0)</p><p>			};</p><p>			var p = this.element.position();																This is a relative to absolute position minus the actual position calculation - only used for relative positioned helpers</p><p>			this.offset.relative = this.cssPosition == "relative" ? {</p><p>				top: p.top - (parseInt(this.helper.css("top"),10) || 0) + this.offsetParent[0].scrollTop,</p><p>				left: p.left - (parseInt(this.helper.css("left"),10) || 0) + this.offsetParent[0].scrollLeft</p><p>			} : { top: 0, left: 0 };</p><p>			this.originalPosition = this.generatePosition(e);												<em>Generate the original position</em></p><p>			this.helperProportions = { width: this.helper.outerWidth(), height: this.helper.outerHeight() };Cache the helper size</p><p>			if(o.cursorAt) {</p><p>				if(o.cursorAt.left != undefined) this.offset.click.left = o.cursorAt.left;</p><p>				if(o.cursorAt.right != undefined) this.offset.click.left = this.helperProportions.width - o.cursorAt.right;</p><p>				if(o.cursorAt.top != undefined) this.offset.click.top = o.cursorAt.top;</p><p>				if(o.cursorAt.bottom != undefined) this.offset.click.top = this.helperProportions.height - o.cursorAt.bottom;</p><p>			}</p><p>			/*</p>			 <ul><li>- Position constraining -</li>			 <li>Here we prepare position constraining like grid and containment.</li></ul><p>			 */	</p><p>			if(o.containment) {</p><p>				if(o.containment == 'parent') o.containment = this.helper[0].parentNode;</p><p>				if(o.containment == 'document') this.containment = [0,0,$(document).width(), ($(document).height() || document.body.parentNode.scrollHeight)];</p><p>				if(!(/^(document|window|parent)$/).test(o.containment)) {</p><p>					var ce = $(o.containment)[0];</p><p>					var co = $(o.containment).offset();</p><p>					this.containment = [</p><p>						co.left + (parseInt($(ce).css("borderLeftWidth"),10) || 0) - this.offset.relative.left - this.offset.parent.left,</p><p>						co.top + (parseInt($(ce).css("borderTopWidth"),10) || 0) - this.offset.relative.top - this.offset.parent.top,</p><p>						co.left+Math.max(ce.scrollWidth,ce.offsetWidth) - (parseInt($(ce).css("borderLeftWidth"),10) || 0) - this.offset.relative.left - this.offset.parent.left - this.helperProportions.width - this.margins.left - (parseInt(this.element.css("marginRight"),10) || 0),</p><p>						co.top+Math.max(ce.scrollHeight,ce.offsetHeight) - (parseInt($(ce).css("borderTopWidth"),10) || 0) - this.offset.relative.top - this.offset.parent.top - this.helperProportions.height - this.margins.top - (parseInt(this.element.css("marginBottom"),10) || 0)</p><p>					];</p><p>				}</p><p>			}</p><p>			<em>Call plugins and callbacks</em></p><p>			this.propagate("start", e);</p><p>			this.helperProportions = { width: this.helper.outerWidth(), height: this.helper.outerHeight() };Recache the helper size</p><p>			if ($.ui.ddmanager && !o.dropBehaviour) $.ui.ddmanager.prepareOffsets(this, e);</p><p>			return false;</p><p>		},</p><p>		convertPositionTo: function(d, pos) {</p><p>			if(!pos) pos = this.position;</p><p>			var mod = d == "absolute" ? 1 : -1;</p><p>			return {</p><p>				top: (</p><p>					pos.top																	<em> the calculated relative position</em></p><p>					+ this.offset.relative.top	* mod										 Only for relative positioned nodes: Relative offset from element to offset parent</p><p>					+ this.offset.parent.top * mod											<em> The offsetParent's offset without borders (offset + border)</em></p>					<ul><li>(this.cssPosition == "fixed" ? 0 : this.offsetParent[0].scrollTop) * mod	 The offsetParent's scroll position, not if the element is fixed</li></ul><p>					+ this.margins.top * mod												<em>Add the margin (you don't want the margin counting in intersection methods)</em></p><p>				),</p><p>				left: (</p><p>					pos.left																 the calculated relative position</p><p>					+ this.offset.relative.left	* mod										<em> Only for relative positioned nodes: Relative offset from element to offset parent</em></p><p>					+ this.offset.parent.left * mod											 The offsetParent's offset without borders (offset + border)</p>					<ul><li>(this.cssPosition == "fixed" ? 0 : this.offsetParent[0].scrollLeft) * mod	<em> The offsetParent's scroll position, not if the element is fixed</em></li></ul><p>					+ this.margins.left * mod												Add the margin (you don't want the margin counting in intersection methods)</p><p>				)</p><p>			};</p><p>		},</p><p>		generatePosition: function(e) {</p><p>			var o = this.options;</p><p>			var position = {</p><p>				top: (</p><p>					e.pageY																	<em> The absolute mouse position</em></p>					<ul><li>this.offset.click.top													 Click offset (relative to the element)</li>					<li>this.offset.relative.top												<em> Only for relative positioned nodes: Relative offset from element to offset parent</em></li>					<li>this.offset.parent.top												 The offsetParent's offset without borders (offset + border)</li></ul><p>					+ (this.cssPosition == "fixed" ? 0 : this.offsetParent[0].scrollTop)	<em> The offsetParent's scroll position, not if the element is fixed</em></p><p>				),</p><p>				left: (</p><p>					e.pageX																	 The absolute mouse position</p>					<ul><li>this.offset.click.left												<em> Click offset (relative to the element)</em></li>					<li>this.offset.relative.left												 Only for relative positioned nodes: Relative offset from element to offset parent</li>					<li>this.offset.parent.left												<em> The offsetParent's offset without borders (offset + border)</em></li></ul><p>					+ (this.cssPosition == "fixed" ? 0 : this.offsetParent[0].scrollLeft)	 The offsetParent's scroll position, not if the element is fixed</p><p>				)</p><p>			};</p><p>			if(!this.originalPosition) return position;										//If we are not dragging yet, we won't check for options</p><p>			/*</p>			 <ul><li>- Position constraining -</li>			 <li>Constrain the position to a mix of grid, containment.</li></ul><p>			 */</p><p>			if(this.containment) {</p><p>				if(position.left &lt; this.containment[0]) position.left = this.containment[0];</p><p>				if(position.top &lt; this.containment[1]) position.top = this.containment[1];</p><p>				if(position.left &gt; this.containment[2]) position.left = this.containment[2];</p><p>				if(position.top &gt; this.containment[3]) position.top = this.containment[3];</p><p>			}</p><p>			if(o.grid) {</p><p>				var top = this.originalPosition.top + Math.round((position.top - this.originalPosition.top) / o.grid[1]) * o.grid[1];</p><p>				position.top = this.containment ? (!(top &lt; this.containment[1] || top &gt; this.containment[3]) ? top : (!(top &lt; this.containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;</p><p>				var left = this.originalPosition.left + Math.round((position.left - this.originalPosition.left) / o.grid[0]) * o.grid[0];</p><p>				position.left = this.containment ? (!(left &lt; this.containment[0] || left &gt; this.containment[2]) ? left : (!(left &lt; this.containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;</p><p>			}</p><p>			return position;</p><p>		},</p><p>		drag: function(e) {</p><p>			<em>Compute the helpers position</em></p><p>			this.position = this.generatePosition(e);</p><p>			this.positionAbs = this.convertPositionTo("absolute");</p><p>			Call plugins and callbacks and use the resulting position if something is returned		</p><p>			this.position = this.propagate("drag", e) || this.position;</p><p>			if(!this.options.axis || this.options.axis == "x") this.helper[0].style.left = this.position.left+'px';</p><p>			if(!this.options.axis || this.options.axis == "y") this.helper[0].style.top = this.position.top+'px';</p><p>			if($.ui.ddmanager) $.ui.ddmanager.drag(this, e);</p><p>			return false;</p><p>		},</p><p>		stop: function(e) {</p><p>			<em>If we are using droppables, inform the manager about the drop</em></p><p>			if ($.ui.ddmanager && !this.options.dropBehaviour)</p><p>				$.ui.ddmanager.drop(this, e);</p><p>			if(this.options.revert) {</p><p>				var self = this;</p><p>				$(this.helper).animate(this.originalPosition, parseInt(this.options.revert, 10) || 500, function() {</p><p>					self.propagate("stop", e);</p><p>					self.clear();</p><p>				});</p><p>			} else {</p><p>				this.propagate("stop", e);</p><p>				this.clear();</p><p>			}</p><p>			return false;</p><p>		},</p><p>		clear: function() {</p><p>			if(this.options.helper != 'original' && !this.cancelHelperRemoval) this.helper.remove();</p><p>			if($.ui.ddmanager) $.ui.ddmanager.current = null;</p><p>			this.helper = null;</p><p>			this.cancelHelperRemoval = false;</p><p>		},</p><p>		 From now on bulk stuff - mainly helpers</p><p>		plugins: {},</p><p>		ui: function(e) {</p><p>			return {</p><p>				helper: this.helper,</p><p>				position: this.position,</p><p>				absolutePosition: this.positionAbs,</p><p>				options: this.options			</p><p>			};</p><p>		},</p><p>		propagate: function(n,e) {</p><p>			$.ui.plugin.call(this, n, [e, this.ui()]);</p><p>			return this.element.triggerHandler(n == "drag" ? n : "drag"+n, [e, this.ui()], this.options[n]);</p><p>		},</p><p>		destroy: function() {</p><p>			if(!this.element.data('draggable')) return;</p><p>			this.element.removeData("draggable").unbind(".draggable").mouse("destroy");</p><p>		},</p><p>		enable: function() {</p><p>			this.options.disabled = false;</p><p>		},</p><p>		disable: function() {</p><p>			this.options.disabled = true;</p><p>		}</p><p>	});</p><p>	$.ui.draggable.defaults = {</p><p>		helper: "original",</p><p>		appendTo: "parent",</p><p>		cancel: ['input','textarea','button','select','option'],</p><p>		distance: 1,</p><p>		delay: 0</p><p>	};</p><p>	$.ui.plugin.add("draggable", "cursor", {</p><p>		start: function(e, ui) {</p><p>			var t = $('body');</p><p>			if (t.css("cursor")) ui.options._cursor = t.css("cursor");</p><p>			t.css("cursor", ui.options.cursor);</p><p>		},</p><p>		stop: function(e, ui) {</p><p>			if (ui.options._cursor) $('body').css("cursor", ui.options._cursor);</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("draggable", "zIndex", {</p><p>		start: function(e, ui) {</p><p>			var t = $(ui.helper);</p><p>			if(t.css("zIndex")) ui.options._zIndex = t.css("zIndex");</p><p>			t.css('zIndex', ui.options.zIndex);</p><p>		},</p><p>		stop: function(e, ui) {</p><p>			if(ui.options._zIndex) $(ui.helper).css('zIndex', ui.options._zIndex);</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("draggable", "opacity", {</p><p>		start: function(e, ui) {</p><p>			var t = $(ui.helper);</p><p>			if(t.css("opacity")) ui.options._opacity = t.css("opacity");</p><p>			t.css('opacity', ui.options.opacity);</p><p>		},</p><p>		stop: function(e, ui) {</p><p>			if(ui.options._opacity) $(ui.helper).css('opacity', ui.options._opacity);</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("draggable", "iframeFix", {</p><p>		start: function(e, ui) {</p><p>			$(ui.options.iframeFix === true ? "iframe" : ui.options.iframeFix).each(function() {					</p><p>				$('&lt;div class="ui-draggable-iframeFix" style="background: #fff;"&gt;&lt;/div&gt;')</p><p>				.css({</p><p>					width: this.offsetWidth+"px", height: this.offsetHeight+"px",</p><p>					position: "absolute", opacity: "0.001", zIndex: 1000</p><p>				})</p><p>				.css($(this).offset())</p><p>				.appendTo("body");</p><p>			});</p><p>		},</p><p>		stop: function(e, ui) {</p><p>			$("div.DragDropIframeFix").each(function() { this.parentNode.removeChild(this); }); //Remove frame helpers	</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("draggable", "scroll", {</p><p>		start: function(e, ui) {</p><p>			var o = ui.options;</p><p>			var i = $(this).data("draggable");</p><p>			o.scrollSensitivity	= o.scrollSensitivity || 20;</p><p>			o.scrollSpeed		= o.scrollSpeed || 20;</p><p>			i.overflowY = function(el) {</p><p>				do { if(/auto|scroll/.test(el.css('overflow')) || (/auto|scroll/).test(el.css('overflow-y'))) return el; el = el.parent(); } while (el[0].parentNode);</p><p>				return $(document);</p><p>			}(this);</p><p>			i.overflowX = function(el) {</p><p>				do { if(/auto|scroll/.test(el.css('overflow')) || (/auto|scroll/).test(el.css('overflow-x'))) return el; el = el.parent(); } while (el[0].parentNode);</p><p>				return $(document);</p><p>			}(this);</p><p>			if(i.overflowY[0] != document && i.overflowY[0].tagName != 'HTML') i.overflowYOffset = i.overflowY.offset();</p><p>			if(i.overflowX[0] != document && i.overflowX[0].tagName != 'HTML') i.overflowXOffset = i.overflowX.offset();</p><p>		},</p><p>		drag: function(e, ui) {</p><p>			var o = ui.options;</p><p>			var i = $(this).data("draggable");</p><p>			if(i.overflowY[0] != document && i.overflowY[0].tagName != 'HTML') {</p><p>				if((i.overflowYOffset.top + i.overflowY[0].offsetHeight) - e.pageY &lt; o.scrollSensitivity)</p><p>					i.overflowY[0].scrollTop = i.overflowY[0].scrollTop + o.scrollSpeed;</p><p>				if(e.pageY - i.overflowYOffset.top &lt; o.scrollSensitivity)</p><p>					i.overflowY[0].scrollTop = i.overflowY[0].scrollTop - o.scrollSpeed;</p><p>			} else {</p><p>				if(e.pageY - $(document).scrollTop() &lt; o.scrollSensitivity)</p><p>					$(document).scrollTop($(document).scrollTop() - o.scrollSpeed);</p><p>				if($(window).height() - (e.pageY - $(document).scrollTop()) &lt; o.scrollSensitivity)</p><p>					$(document).scrollTop($(document).scrollTop() + o.scrollSpeed);</p><p>			}</p><p>			if(i.overflowX[0] != document && i.overflowX[0].tagName != 'HTML') {</p><p>				if((i.overflowXOffset.left + i.overflowX[0].offsetWidth) - e.pageX &lt; o.scrollSensitivity)</p><p>					i.overflowX[0].scrollLeft = i.overflowX[0].scrollLeft + o.scrollSpeed;</p><p>				if(e.pageX - i.overflowXOffset.left &lt; o.scrollSensitivity)</p><p>					i.overflowX[0].scrollLeft = i.overflowX[0].scrollLeft - o.scrollSpeed;</p><p>			} else {</p><p>				if(e.pageX - $(document).scrollLeft() &lt; o.scrollSensitivity)</p><p>					$(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed);</p><p>				if($(window).width() - (e.pageX - $(document).scrollLeft()) &lt; o.scrollSensitivity)</p><p>					$(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed);</p><p>			}</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("draggable", "snap", {</p><p>		start: function(e, ui) {</p><p>			var inst = $(this).data("draggable");</p><p>			inst.snapElements = [];</p><p>			$(ui.options.snap === true ? '.ui-draggable' : ui.options.snap).each(function() {</p><p>				var $t = $(this); var $o = $t.offset();</p><p>				if(this != inst.element[0]) inst.snapElements.push({</p><p>					item: this,</p><p>					width: $t.outerWidth(), height: $t.outerHeight(),</p><p>					top: $o.top, left: $o.left</p><p>				});</p><p>			});</p><p>		},</p><p>		drag: function(e, ui) {</p><p>			var inst = $(this).data("draggable");</p><p>			var d = ui.options.snapTolerance || 20;</p><p>			var x1 = ui.absolutePosition.left, x2 = x1 + inst.helperProportions.width,</p><p>				y1 = ui.absolutePosition.top, y2 = y1 + inst.helperProportions.height;</p><p>			for (var i = inst.snapElements.length - 1; i &gt;= 0; i--){</p><p>				var l = inst.snapElements[i].left, r = l + inst.snapElements[i].width, </p><p>					t = inst.snapElements[i].top, b = t + inst.snapElements[i].height;</p><p>				<em>Yes, I know, this is insane ;)</em></p><p>				if(!((l-d &lt; x1 && x1 &lt; r+d && t-d &lt; y1 && y1 &lt; b+d) || (l-d &lt; x1 && x1 &lt; r+d && t-d &lt; y2 && y2 &lt; b+d) || (l-d &lt; x2 && x2 &lt; r+d && t-d &lt; y1 && y1 &lt; b+d) || (l-d &lt; x2 && x2 &lt; r+d && t-d &lt; y2 && y2 &lt; b+d))) continue;</p><p>				if(ui.options.snapMode != 'inner') {</p><p>					var ts = Math.abs(t - y2) &lt;= 20;</p><p>					var bs = Math.abs(b - y1) &lt;= 20;</p><p>					var ls = Math.abs(l - x2) &lt;= 20;</p><p>					var rs = Math.abs(r - x1) &lt;= 20;</p><p>					if(ts) ui.position.top = inst.convertPositionTo("relative", { top: t - inst.helperProportions.height, left: 0 }).top;</p><p>					if(bs) ui.position.top = inst.convertPositionTo("relative", { top: b, left: 0 }).top;</p><p>					if(ls) ui.position.left = inst.convertPositionTo("relative", { top: 0, left: l - inst.helperProportions.width }).left;</p><p>					if(rs) ui.position.left = inst.convertPositionTo("relative", { top: 0, left: r }).left;</p><p>				}</p><p>				if(ui.options.snapMode != 'outer') {</p><p>					var ts = Math.abs(t - y1) &lt;= 20;</p><p>					var bs = Math.abs(b - y2) &lt;= 20;</p><p>					var ls = Math.abs(l - x1) &lt;= 20;</p><p>					var rs = Math.abs(r - x2) &lt;= 20;</p><p>					if(ts) ui.position.top = inst.convertPositionTo("relative", { top: t, left: 0 }).top;</p><p>					if(bs) ui.position.top = inst.convertPositionTo("relative", { top: b - inst.helperProportions.height, left: 0 }).top;</p><p>					if(ls) ui.position.left = inst.convertPositionTo("relative", { top: 0, left: l }).left;</p><p>					if(rs) ui.position.left = inst.convertPositionTo("relative", { top: 0, left: r - inst.helperProportions.width }).left;</p><p>				}</p><p>			};</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("draggable", "connectToSortable", {</p><p>		start: function(e,ui) {</p><p>			var inst = $(this).data("draggable");</p><p>			inst.sortable = $.data($(ui.options.connectToSortable)[0], 'sortable');</p><p>			inst.sortableOffset = inst.sortable.element.offset();</p><p>			inst.sortableOuterWidth = inst.sortable.element.outerWidth();</p><p>			inst.sortableOuterHeight = inst.sortable.element.outerHeight();</p><p>			if(inst.sortable.options.revert) inst.sortable.shouldRevert = true;</p><p>		},</p><p>		stop: function(e,ui) {</p><p>			If we are still over the sortable, we fake the stop event of the sortable, but also remove helper</p><p>			var instDraggable = $(this).data("draggable");</p><p>			var inst = instDraggable.sortable;</p><p>			if(inst.isOver) {</p><p>				inst.isOver = 0;</p><p>				instDraggable.cancelHelperRemoval = true; <em>Don't remove the helper in the draggable instance</em></p><p>				inst.cancelHelperRemoval = false; Remove it in the sortable instance (so sortable plugins like revert still work)</p><p>				if(inst.shouldRevert) inst.options.revert = true; <em>revert here</em></p><p>				inst.stop(e);</p><p>				inst.options.helper = "original";</p><p>			}</p><p>		},</p><p>		drag: function(e,ui) {</p><p>			This is handy: We reuse the intersectsWith method for checking if the current draggable helper</p><p>			<em>intersects with the sortable container</em></p><p>			var instDraggable = $(this).data("draggable");</p><p>			var inst = instDraggable.sortable;</p><p>			instDraggable.position.absolute = ui.absolutePosition; Sorry, this is an ugly API fix</p><p>			if(inst.intersectsWith.call(instDraggable, {</p><p>				left: instDraggable.sortableOffset.left, top: instDraggable.sortableOffset.top,</p><p>				width: instDraggable.sortableOuterWidth, height: instDraggable.sortableOuterHeight</p><p>			})) {</p><p>				<em>If it intersects, we use a little isOver variable and set it once, so our move-in stuff gets fired only once</em></p><p>				if(!inst.isOver) {</p><p>					inst.isOver = 1;</p><p>					Cache the width/height of the new helper</p><p>					var height = inst.options.placeholderElement ? $(inst.options.placeholderElement, $(inst.options.items, inst.element)).innerHeight() : $(inst.options.items, inst.element).innerHeight();</p><p>					var width = inst.options.placeholderElement ? $(inst.options.placeholderElement, $(inst.options.items, inst.element)).innerWidth() : $(inst.options.items, inst.element).innerWidth();</p><p>					<em>Now we fake the start of dragging for the sortable instance,</em></p><p>					by cloning the list group item, appending it to the sortable and using it as inst.currentItem</p><p>					<em>We can then fire the start event of the sortable with our passed browser event, and our own helper (so it doesn't create a new one)</em></p><p>					inst.currentItem = $(this).clone().appendTo(inst.element);</p><p>					inst.options.helper = function() { return ui.helper[0]; };</p><p>					inst.start(e);</p><p>					Because the browser event is way off the new appended portlet, we modify a couple of variables to reflect the changes</p><p>					inst.clickOffset.top = instDraggable.offset.click.top;</p><p>					inst.clickOffset.left = instDraggable.offset.click.left;</p><p>					inst.offset.left -= ui.absolutePosition.left - inst.position.absolute.left;</p><p>					inst.offset.top -= ui.absolutePosition.top - inst.position.absolute.top;</p><p>					<em>Do a nifty little helper animation: Animate it to the portlet's size (just takes the first 'li' element in the sortable now)</em></p><p>					inst.helperProportions = {width: width, height: height}; We have to reset the helper proportions, because we are doing our animation there</p><p>					ui.helper.animate({height: height, width: width}, 500);</p><p>					instDraggable.propagate("toSortable", e);</p><p>				}</p><p>				<em>Provided we did all the previous steps, we can fire the drag event of the sortable on every draggable drag, when it intersects with the sortable</em></p><p>				if(inst.currentItem) inst.drag(e);</p><p>			} else {</p><p>				If it doesn't intersect with the sortable, and it intersected before,</p><p>				<em>we fake the drag stop of the sortable, but make sure it doesn't remove the helper by using cancelHelperRemoval</em></p><p>				if(inst.isOver) {</p><p>					inst.isOver = 0;</p><p>					inst.cancelHelperRemoval = true;</p><p>					inst.options.revert = false; No revert here</p><p>					inst.stop(e);</p><p>					inst.options.helper = "original";</p><p>					//Now we remove our currentItem, the list group clone again, and the placeholder, and animate the helper back to it's original size</p><p>					inst.currentItem.remove();</p><p>					inst.placeholder.remove();</p><p>					ui.helper.animate({ height: this.innerHeight(), width: this.innerWidth() }, 500);</p><p>					instDraggable.propagate("fromSortable", e);</p><p>				}</p><p>			};</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("draggable", "stack", {</p><p>		start: function(e,ui) {</p><p>			var group = $.makeArray($(ui.options.stack.group)).sort(function(a,b) {</p><p>				return (parseInt($(a).css("zIndex")) || ui.options.stack.min) - (parseInt($(b).css("zIndex")) || ui.options.stack.min);</p><p>			});</p><p>			$(group).each(function(i) {</p><p>				this.style.zIndex = ui.options.stack.min + i;</p><p>			});</p><p>			this[0].style.zIndex = ui.options.stack.min + group.length;</p><p>		}</p><p>	});</p><p>})(jQuery);/*</p> <ul><li>jQuery UI Droppable</li></ul><p> *</p> <ul><li>Copyright (c) 2008 Paul Bakaus</li> <li>Dual licensed under the MIT (MIT-LICENSE.txt)</li> <li>and GPL (GPL-LICENSE.txt) licenses.</li> *  <li><a href="http://docs.jquery.com/UI/Droppables" class="ext-link"><span class="icon"></span>http://docs.jquery.com/UI/Droppables</a></li></ul><p> *</p> <ul><li>Depends:</li></ul><p> *	ui.core.js</p><p> *	ui.draggable.js</p><p> *</p> <ul><li>Revision: $Id: ui.droppable.js 5433 2008-05-04 20:07:17Z joern.zaefferer $</li></ul><p> */</p><p>;(function($) {</p><p>	$.widget("ui.droppable", {</p><p>		init: function() {</p><p>			this.element.addClass("ui-droppable");</p><p>			this.isover = 0; this.isout = 1;</p><p>			<em>Prepare the passed options</em></p><p>			var o = this.options, accept = o.accept;</p><p>			o = $.extend(o, {</p><p>				accept: o.accept && o.accept.constructor == Function ? o.accept : function(d) {</p><p>					return $(d).is(accept);</p><p>				}</p><p>			});</p><p>			Store the droppable's proportions</p><p>			this.proportions = { width: this.element.outerWidth(), height: this.element.outerHeight() };</p><p>			<em> Add the reference and positions to the manager</em></p><p>			$.ui.ddmanager.droppables.push(this);</p><p>		},</p><p>		plugins: {},</p><p>		ui: function(c) {</p><p>			return {</p><p>				instance: this,</p><p>				draggable: (c.currentItem || c.element),</p><p>				helper: c.helper,</p><p>				position: c.position,</p><p>				absolutePosition: c.positionAbs,</p><p>				options: this.options,</p><p>				element: this.element</p><p>			};</p><p>		},</p><p>		destroy: function() {</p><p>			var drop = $.ui.ddmanager.droppables;</p><p>			for ( var i = 0; i &lt; drop.length; i++ )</p><p>				if ( drop[i] == this )</p><p>					drop.splice(i, 1);</p><p>			this.element</p><p>				.removeClass("ui-droppable ui-droppable-disabled")</p><p>				.removeData("droppable")</p><p>				.unbind(".droppable");</p><p>		},</p><p>		enable: function() {</p><p>			this.element.removeClass("ui-droppable-disabled");</p><p>			this.options.disabled = false;</p><p>		},</p><p>		disable: function() {</p><p>			this.element.addClass("ui-droppable-disabled");</p><p>			this.options.disabled = true;</p><p>		},</p><p>		over: function(e) {</p><p>			var draggable = $.ui.ddmanager.current;</p><p>			if (!draggable || (draggable.currentItem || draggable.element)[0] == this.element[0]) return;  Bail if draggable and droppable are same element</p><p>			if (this.options.accept.call(this.element,(draggable.currentItem || draggable.element))) {</p><p>				$.ui.plugin.call(this, 'over', [e, this.ui(draggable)]);</p><p>				this.element.triggerHandler("dropover", [e, this.ui(draggable)], this.options.over);</p><p>			}</p><p>		},</p><p>		out: function(e) {</p><p>			var draggable = $.ui.ddmanager.current;</p><p>			if (!draggable || (draggable.currentItem || draggable.element)[0] == this.element[0]) return; <em> Bail if draggable and droppable are same element</em></p><p>			if (this.options.accept.call(this.element,(draggable.currentItem || draggable.element))) {</p><p>				$.ui.plugin.call(this, 'out', [e, this.ui(draggable)]);</p><p>				this.element.triggerHandler("dropout", [e, this.ui(draggable)], this.options.out);</p><p>			}</p><p>		},</p><p>		drop: function(e,custom) {</p><p>			var draggable = custom || $.ui.ddmanager.current;</p><p>			if (!draggable || (draggable.currentItem || draggable.element)[0] == this.element[0]) return false;  Bail if draggable and droppable are same element</p><p>			var childrenIntersection = false;</p><p>			this.element.find(".ui-droppable").each(function() {</p><p>				var inst = $.data(this, 'droppable');</p><p>				if(inst.options.greedy && $.ui.intersect(draggable, $.extend(inst, { offset: inst.element.offset() }), inst.options.tolerance)) {</p><p>					childrenIntersection = true; return false;</p><p>				}</p><p>			});</p><p>			if(childrenIntersection) return false;</p><p>			if(this.options.accept.call(this.element,(draggable.currentItem || draggable.element))) {</p><p>				$.ui.plugin.call(this, 'drop', [e, this.ui(draggable)]);</p><p>				this.element.triggerHandler("drop", [e, this.ui(draggable)], this.options.drop);</p><p>				return true;</p><p>			}</p><p>			return false;</p><p>		},</p><p>		activate: function(e) {</p><p>			var draggable = $.ui.ddmanager.current;</p><p>			$.ui.plugin.call(this, 'activate', [e, this.ui(draggable)]);</p><p>			if(draggable) this.element.triggerHandler("dropactivate", [e, this.ui(draggable)], this.options.activate);</p><p>		},</p><p>		deactivate: function(e) {</p><p>			var draggable = $.ui.ddmanager.current;</p><p>			$.ui.plugin.call(this, 'deactivate', [e, this.ui(draggable)]);</p><p>			if(draggable) this.element.triggerHandler("dropdeactivate", [e, this.ui(draggable)], this.options.deactivate);</p><p>		}</p><p>	});</p><p>	$.extend($.ui.droppable, {</p><p>		defaults: {</p><p>			disabled: false,</p><p>			tolerance: 'intersect'</p><p>		}</p><p>	});</p><p>	$.ui.intersect = function(draggable, droppable, toleranceMode) {</p><p>		if (!droppable.offset) return false;</p><p>		var x1 = (draggable.positionAbs || draggable.position.absolute).left, x2 = x1 + draggable.helperProportions.width,</p><p>			y1 = (draggable.positionAbs || draggable.position.absolute).top, y2 = y1 + draggable.helperProportions.height;</p><p>		var l = droppable.offset.left, r = l + droppable.proportions.width,</p><p>			t = droppable.offset.top, b = t + droppable.proportions.height;</p><p>		switch (toleranceMode) {</p><p>			case 'fit':</p><p>				if(!((y2-(draggable.helperProportions.height/2) &gt; t && y1 &lt; t) || (y1 &lt; b && y2 &gt; b) || (x2 &gt; l && x1 &lt; l) || (x1 &lt; r && x2 &gt; r))) return false;</p><p>				if(y2-(draggable.helperProportions.height/2) &gt; t && y1 &lt; t) return 1; <em>Crosses top edge</em></p><p>				if(y1 &lt; b && y2 &gt; b) return 2; Crosses bottom edge</p><p>				if(x2 &gt; l && x1 &lt; l) return 1; <em>Crosses left edge</em></p><p>				if(x1 &lt; r && x2 &gt; r) return 2; Crosses right edge</p><p>				<em>return (l &lt; x1 && x2 &lt; r</em></p><p>					&& t &lt; y1 && y2 &lt; b);</p><p>				break;</p><p>			case 'intersect':</p><p>				return (l &lt; x1 + (draggable.helperProportions.width / 2) // Right Half</p><p>					&& x2 - (draggable.helperProportions.width / 2) &lt; r // Left Half</p><p>					&& t &lt; y1 + (draggable.helperProportions.height / 2) // Bottom Half</p><p>					&& y2 - (draggable.helperProportions.height / 2) &lt; b ); <em> Top Half</em></p><p>				break;</p><p>			case 'pointer':</p><p>				return (l &lt; ((draggable.positionAbs || draggable.position.absolute).left + (draggable.clickOffset || draggable.offset.click).left) && ((draggable.positionAbs || draggable.position.absolute).left + (draggable.clickOffset || draggable.offset.click).left) &lt; r</p><p>					&& t &lt; ((draggable.positionAbs || draggable.position.absolute).top + (draggable.clickOffset || draggable.offset.click).top) && ((draggable.positionAbs || draggable.position.absolute).top + (draggable.clickOffset || draggable.offset.click).top) &lt; b);</p><p>				break;</p><p>			case 'touch':</p><p>				return (</p><p>						(y1 &gt;= t && y1 &lt;= b) ||	 Top edge touching</p><p>						(y2 &gt;= t && y2 &lt;= b) ||	<em> Bottom edge touching</em></p><p>						(y1 &lt; t && y2 &gt; b)		 Surrounded vertically</p><p>					) && (</p><p>						(x1 &gt;= l && x1 &lt;= r) ||	<em> Left edge touching</em></p><p>						(x2 &gt;= l && x2 &lt;= r) ||	 Right edge touching</p><p>						(x1 &lt; l && x2 &gt; r)		// Surrounded horizontally</p><p>					);</p><p>				break;</p><p>			default:</p><p>				return false;</p><p>				break;</p><p>			}</p><p>	};</p><p>	/*</p><p>		This manager tracks offsets of draggables and droppables</p><p>	*/</p><p>	$.ui.ddmanager = {</p><p>		current: null,</p><p>		droppables: [],</p><p>		prepareOffsets: function(t, e) {</p><p>			var m = $.ui.ddmanager.droppables;</p><p>			var type = e ? e.type : null; <em> workaround for <a href="/ticket/2317">#2317</a></em></p><p>			for (var i = 0; i &lt; m.length; i++) {</p><p>				if(m[i].options.disabled || (t && !m[i].options.accept.call(m[i].element,(t.currentItem || t.element)))) continue;</p><p>				m[i].visible = m[i].element.is(":visible"); if(!m[i].visible) continue; If the element is not visible, continue</p><p>				m[i].offset = m[i].element.offset();</p><p>				m[i].proportions = { width: m[i].element.outerWidth(), height: m[i].element.outerHeight() };</p><p>				if(type == "dragstart" || type == "sortactivate") m[i].activate.call(m[i], e); <em>Activate the droppable if used directly from draggables</em></p><p>			}</p><p>		},</p><p>		drop: function(draggable, e) {</p><p>			var dropped = false;</p><p>			$.each($.ui.ddmanager.droppables, function() {</p><p>				if(!this.options) return;</p><p>				if (!this.options.disabled && this.visible && $.ui.intersect(draggable, this, this.options.tolerance))</p><p>					dropped = this.drop.call(this, e);</p><p>				if (!this.options.disabled && this.visible && this.options.accept.call(this.element,(draggable.currentItem || draggable.element))) {</p><p>					this.isout = 1; this.isover = 0;</p><p>					this.deactivate.call(this, e);</p><p>				}</p><p>			});</p><p>			return dropped;</p><p>		},</p><p>		drag: function(draggable, e) {</p><p>			If you have a highly dynamic page, you might try this option. It renders positions every time you move the mouse.</p><p>			if(draggable.options.refreshPositions) $.ui.ddmanager.prepareOffsets(draggable, e);</p><p>			<em>Run through all droppables and check their positions based on specific tolerance options</em></p><p>			$.each($.ui.ddmanager.droppables, function() {</p><p>				if(this.disabled || this.greedyChild || !this.visible) return;</p><p>				var intersects = $.ui.intersect(draggable, this, this.options.tolerance);</p><p>				var c = !intersects && this.isover == 1 ? 'isout' : (intersects && this.isover == 0 ? 'isover' : null);</p><p>				if(!c) return;</p><p>				var parentInstance;</p><p>				if (this.options.greedy) {</p><p>					var parent = this.element.parents('.ui-droppable:eq(0)');</p><p>					if (parent.length) {</p><p>						parentInstance = $.data(parent[0], 'droppable');</p><p>						parentInstance.greedyChild = (c == 'isover' ? 1 : 0);</p><p>					}</p><p>				}</p><p>				 we just moved into a greedy child</p><p>				if (parentInstance && c == 'isover') {</p><p>					parentInstance['isover'] = 0;</p><p>					parentInstance['isout'] = 1;</p><p>					parentInstance.out.call(parentInstance, e);</p><p>				}</p><p>				this[c] = 1; this[c == 'isout' ? 'isover' : 'isout'] = 0;</p><p>				this[c == "isover" ? "over" : "out"].call(this, e);</p><p>				// we just moved out of a greedy child</p><p>				if (parentInstance && c == 'isout') {</p><p>					parentInstance['isout'] = 0;</p><p>					parentInstance['isover'] = 1;</p><p>					parentInstance.over.call(parentInstance, e);</p><p>				}</p><p>			});</p><p>		}</p><p>	};</p><p>/*</p> <ul><li>Droppable Extensions</li></ul><p> */</p><p>	$.ui.plugin.add("droppable", "activeClass", {</p><p>		activate: function(e, ui) {</p><p>			$(this).addClass(ui.options.activeClass);</p><p>		},</p><p>		deactivate: function(e, ui) {</p><p>			$(this).removeClass(ui.options.activeClass);</p><p>		},</p><p>		drop: function(e, ui) {</p><p>			$(this).removeClass(ui.options.activeClass);</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("droppable", "hoverClass", {</p><p>		over: function(e, ui) {</p><p>			$(this).addClass(ui.options.hoverClass);</p><p>		},</p><p>		out: function(e, ui) {</p><p>			$(this).removeClass(ui.options.hoverClass);</p><p>		},</p><p>		drop: function(e, ui) {</p><p>			$(this).removeClass(ui.options.hoverClass);</p><p>		}</p><p>	});</p><p>})(jQuery);</p><p>/*</p> <ul><li>jQuery UI Resizable</li></ul><p> *</p> <ul><li>Copyright (c) 2008 Paul Bakaus</li> <li>Dual licensed under the MIT (MIT-LICENSE.txt)</li> <li>and GPL (GPL-LICENSE.txt) licenses.</li> *  <li><a href="http://docs.jquery.com/UI/Resizables" class="ext-link"><span class="icon"></span>http://docs.jquery.com/UI/Resizables</a></li></ul><p> *</p> <ul><li>Depends:</li></ul><p> *	ui.core.js</p><p> *</p> <ul><li>Revision: $Id: ui.resizable.js 5649 2008-05-21 03:06:36Z braeker $</li></ul><p> */</p><p>;(function($) {</p><p>	$.widget("ui.resizable", {</p><p>		init: function() {</p><p>			var self = this, o = this.options;</p><p>			var elpos = this.element.css('position');</p><p>			// simulate .ui-resizable { position: relative; }</p><p>			this.element.addClass("ui-resizable").css({ position: /static/.test(elpos) ? 'relative' : elpos });</p><p>			$.extend(o, {</p><p>				_aspectRatio: !!(o.aspectRatio),</p><p>				proxy: o.proxy || o.ghost || o.animate ? 'proxy' : null,</p><p>				knobHandles: o.knobHandles === true ? 'ui-resizable-knob-handle' : o.knobHandles</p><p>			});</p><p>			<em>Default Theme</em></p><p>			var aBorder = '1px solid #DEDEDE';</p><p>			o.defaultTheme = {</p><p>				'ui-resizable': { display: 'block' },</p><p>				'ui-resizable-handle': { position: 'absolute', background: '#F2F2F2', fontSize: '0.1px' },</p><p>				'ui-resizable-n': { cursor: 'n-resize', height: '4px', left: '0px', right: '0px', borderTop: aBorder },</p><p>				'ui-resizable-s': { cursor: 's-resize', height: '4px', left: '0px', right: '0px', borderBottom: aBorder },</p><p>				'ui-resizable-e': { cursor: 'e-resize', width: '4px', top: '0px', bottom: '0px', borderRight: aBorder },</p><p>				'ui-resizable-w': { cursor: 'w-resize', width: '4px', top: '0px', bottom: '0px', borderLeft: aBorder },</p><p>				'ui-resizable-se': { cursor: 'se-resize', width: '4px', height: '4px', borderRight: aBorder, borderBottom: aBorder },</p><p>				'ui-resizable-sw': { cursor: 'sw-resize', width: '4px', height: '4px', borderBottom: aBorder, borderLeft: aBorder },</p><p>				'ui-resizable-ne': { cursor: 'ne-resize', width: '4px', height: '4px', borderRight: aBorder, borderTop: aBorder },</p><p>				'ui-resizable-nw': { cursor: 'nw-resize', width: '4px', height: '4px', borderLeft: aBorder, borderTop: aBorder }</p><p>			};</p><p>			o.knobTheme = {</p><p>				'ui-resizable-handle': { background: '#F2F2F2', border: '1px solid <a href="/ticket/808080">#808080</a>', height: '8px', width: '8px' },</p><p>				'ui-resizable-n': { cursor: 'n-resize', top: '0px', left: '45%' },</p><p>				'ui-resizable-s': { cursor: 's-resize', bottom: '0px', left: '45%' },</p><p>				'ui-resizable-e': { cursor: 'e-resize', right: '0px', top: '45%' },</p><p>				'ui-resizable-w': { cursor: 'w-resize', left: '0px', top: '45%' },</p><p>				'ui-resizable-se': { cursor: 'se-resize', right: '0px', bottom: '0px' },</p><p>				'ui-resizable-sw': { cursor: 'sw-resize', left: '0px', bottom: '0px' },</p><p>				'ui-resizable-nw': { cursor: 'nw-resize', left: '0px', top: '0px' },</p><p>				'ui-resizable-ne': { cursor: 'ne-resize', right: '0px', top: '0px' }</p><p>			};</p><p>			o._nodeName = this.element[0].nodeName;</p><p>			Wrap the element if it cannot hold child nodes</p><p>			if(o._nodeName.match(/canvas|textarea|input|select|button|img/i)) {</p><p>				var el = this.element;</p><p>				//Opera fixing relative position</p><p>				if (/relative/.test(el.css('position')) && $.browser.opera)</p><p>					el.css({ position: 'relative', top: 'auto', left: 'auto' });</p><p>				//Create a wrapper element and set the wrapper to the new current internal element</p><p>				el.wrap(</p><p>					$('&lt;div class="ui-wrapper"	style="overflow: hidden;"&gt;&lt;/div&gt;').css( {</p><p>						position: el.css('position'),</p><p>						width: el.outerWidth(),</p><p>						height: el.outerHeight(),</p><p>						top: el.css('top'),</p><p>						left: el.css('left')</p><p>					})</p><p>				);</p><p>				var oel = this.element; this.element = this.element.parent();</p><p>				<em>Move margins to the wrapper</em></p><p>				this.element.css({ marginLeft: oel.css("marginLeft"), marginTop: oel.css("marginTop"),</p><p>					marginRight: oel.css("marginRight"), marginBottom: oel.css("marginBottom")</p><p>				});</p><p>				oel.css({ marginLeft: 0, marginTop: 0, marginRight: 0, marginBottom: 0});</p><p>				Prevent Safari textarea resize</p><p>				if ($.browser.safari && o.preventDefault) oel.css('resize', 'none');</p><p>				o.proportionallyResize = oel.css({ position: 'static', zoom: 1, display: 'block' });</p><p>				<em> avoid IE jump</em></p><p>				this.element.css({ margin: oel.css('margin') });</p><p>				 fix handlers offset</p><p>				this._proportionallyResize();</p><p>			}</p><p>			if(!o.handles) o.handles = !$('.ui-resizable-handle', this.element).length ? "e,s,se" : { n: '.ui-resizable-n', e: '.ui-resizable-e', s: '.ui-resizable-s', w: '.ui-resizable-w', se: '.ui-resizable-se', sw: '.ui-resizable-sw', ne: '.ui-resizable-ne', nw: '.ui-resizable-nw' };</p><p>			if(o.handles.constructor == String) {</p><p>				o.zIndex = o.zIndex || 1000;</p><p>				if(o.handles == 'all') o.handles = 'n,e,s,w,se,sw,ne,nw';</p><p>				var n = o.handles.split(","); o.handles = {};</p><p>				<em> insertions are applied when don't have theme loaded</em></p><p>				var insertionsDefault = {</p><p>					handle: 'position: absolute; display: none; overflow:hidden;',</p><p>					n: 'top: 0pt; width:100%;',</p><p>					e: 'right: 0pt; height:100%;',</p><p>					s: 'bottom: 0pt; width:100%;',</p><p>					w: 'left: 0pt; height:100%;',</p><p>					se: 'bottom: 0pt; right: 0px;',</p><p>					sw: 'bottom: 0pt; left: 0px;',</p><p>					ne: 'top: 0pt; right: 0px;',</p><p>					nw: 'top: 0pt; left: 0px;'</p><p>				};</p><p>				for(var i = 0; i &lt; n.length; i++) {</p><p>					var handle = $.trim(n[i]), dt = o.defaultTheme, hname = 'ui-resizable-'+handle, loadDefault = !$.ui.css(hname) && !o.knobHandles, userKnobClass = $.ui.css('ui-resizable-knob-handle'), </p><p>								allDefTheme = $.extend(dt[hname], dt['ui-resizable-handle']), allKnobTheme = $.extend(o.knobTheme[hname], !userKnobClass ? o.knobTheme['ui-resizable-handle'] : {});</p><p>					 increase zIndex of sw, se, ne, nw axis</p><p>					var applyZIndex = /sw|se|ne|nw/.test(handle) ? { zIndex: ++o.zIndex } : {};</p><p>					var defCss = (loadDefault ? insertionsDefault[handle] : ''), </p><p>						axis = $(['&lt;div class="ui-resizable-handle ', hname, '" style="', defCss, insertionsDefault.handle, '"&gt;&lt;/div&gt;'].join('')).css( applyZIndex );</p><p>					o.handles[handle] = '.ui-resizable-'+handle;</p><p>					this.element.append(</p><p>						<em>Theme detection, if not loaded, load o.defaultTheme</em></p><p>						axis.css( loadDefault ? allDefTheme : {} )</p><p>							 Load the knobHandle css, fix width, height, top, left...</p><p>							.css( o.knobHandles ? allKnobTheme : {} ).addClass(o.knobHandles ? 'ui-resizable-knob-handle' : '').addClass(o.knobHandles)</p><p>					);</p><p>				}</p><p>				if (o.knobHandles) this.element.addClass('ui-resizable-knob').css( !$.ui.css('ui-resizable-knob') ? { /*border: '1px #fff dashed'*/ } : {} );</p><p>			}</p><p>			this._renderAxis = function(target) {</p><p>				target = target || this.element;</p><p>				for(var i in o.handles) {</p><p>					if(o.handles[i].constructor == String) </p><p>						o.handles[i] = $(o.handles[i], this.element).show();</p><p>					if (o.transparent)</p><p>						o.handles[i].css({opacity:0});</p><p>					//Apply pad to wrapper element, needed to fix axis position (textarea, inputs, scrolls)</p><p>					if (this.element.is('.ui-wrapper') && </p><p>						o._nodeName.match(/textarea|input|select|button/i)) {</p><p>						var axis = $(o.handles[i], this.element), padWrapper = 0;</p><p>						//Checking the correct pad and border</p><p>						padWrapper = /sw|ne|nw|se|n|s/.test(i) ? axis.outerHeight() : axis.outerWidth();</p><p>						//The padding type i have to apply...</p><p>						var padPos = [ 'padding', </p><p>							/ne|nw|n/.test(i) ? 'Top' :</p><p>							/se|sw|s/.test(i) ? 'Bottom' : </p><p>							/^e$/.test(i) ? 'Right' : 'Left' ].join(""); </p><p>						if (!o.transparent)</p><p>							target.css(padPos, padWrapper);</p><p>						this._proportionallyResize();</p><p>					}</p><p>					if(!$(o.handles[i]).length) continue;</p><p>				}</p><p>			};</p><p>			this._renderAxis(this.element);</p><p>			o._handles = $('.ui-resizable-handle', self.element);</p><p>			if (o.disableSelection)</p><p>				o._handles.each(function(i, e) { $.ui.disableSelection(e); });</p><p>			//Matching axis name</p><p>			o._handles.mouseover(function() {</p><p>				if (!o.resizing) {</p><p>					if (this.className) </p><p>						var axis = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);</p><p>					<em>Axis, default = se</em></p><p>					self.axis = o.axis = axis && axis[1] ? axis[1] : 'se';</p><p>				}</p><p>			});</p><p>			If we want to auto hide the elements</p><p>			if (o.autohide) {</p><p>				o._handles.hide();</p><p>				$(self.element).addClass("ui-resizable-autohide").hover(function() {</p><p>					$(this).removeClass("ui-resizable-autohide");</p><p>					o._handles.show();</p><p>				},</p><p>				function(){</p><p>					if (!o.resizing) {</p><p>						$(this).addClass("ui-resizable-autohide");</p><p>						o._handles.hide();</p><p>					}</p><p>				});</p><p>			}</p><p>			<em>Initialize mouse events for interaction</em></p><p>			this.element.mouse({</p><p>				executor: this,</p><p>				delay: 0,</p><p>				distance: 0,</p><p>				dragPrevention: ['input','textarea','button','select','option'],</p><p>				start: this.start,</p><p>				stop: this.stop,</p><p>				drag: this.drag,</p><p>				condition: function(e) {</p><p>					if(this.disabled) return false;</p><p>					for(var i in this.options.handles) {</p><p>						if($(this.options.handles[i])[0] == e.target) return true;</p><p>					}</p><p>					return false;</p><p>				}</p><p>			});</p><p>		},</p><p>		plugins: {},</p><p>		ui: function() {</p><p>			return {</p><p>				instance: this,</p><p>				axis: this.options.axis,</p><p>				options: this.options</p><p>			};</p><p>		},</p><p>		propagate: function(n,e) {</p><p>			$.ui.plugin.call(this, n, [e, this.ui()]);</p><p>			this.element.triggerHandler(n == "resize" ? n : ["resize", n].join(""), [e, this.ui()], this.options[n]);</p><p>		},</p><p>		destroy: function() {</p><p>			var el = this.element, wrapped = el.children(".ui-resizable").get(0),</p><p>			_destroy = function(exp) {</p><p>				$(exp).removeClass("ui-resizable ui-resizable-disabled")</p><p>					.mouse("destroy").removeData("resizable").unbind(".resizable").find('.ui-resizable-handle').remove();</p><p>			};</p><p>			_destroy(el);</p><p>			if (el.is('.ui-wrapper') && wrapped) {</p><p>				el.parent().append(</p><p>					$(wrapped).css({</p><p>						position: el.css('position'),</p><p>						width: el.outerWidth(),</p><p>						height: el.outerHeight(),</p><p>						top: el.css('top'),</p><p>						left: el.css('left')</p><p>					})</p><p>				).end().remove();</p><p>				_destroy(wrapped);</p><p>			}</p><p>		},</p><p>		enable: function() {</p><p>			this.element.removeClass("ui-resizable-disabled");</p><p>			this.disabled = false;</p><p>		},</p><p>		disable: function() {</p><p>			this.element.addClass("ui-resizable-disabled");</p><p>			this.disabled = true;</p><p>		},</p><p>		start: function(e) {</p><p>			var o = this.options, iniPos = this.element.position(), el = this.element, </p><p>				num = function(v) { return parseInt(v, 10) || 0; }, ie6 = $.browser.msie && $.browser.version &lt; 7;</p><p>			o.resizing = true;</p><p>			o.documentScroll = { top: $(document).scrollTop(), left: $(document).scrollLeft() };</p><p>			 bugfix <a href="/ticket/1749">#1749</a></p><p>			if (el.is('.ui-draggable') || (/absolute/).test(el.css('position'))) {</p><p>				// sOffset decides if document scrollOffset will be added to the top/left of the resizable element</p><p>				var sOffset = $.browser.msie && !o.containment && (/absolute/).test(el.css('position')) && !(/relative/).test(el.parent().css('position'));</p><p>				var dscrollt = sOffset ? o.documentScroll.top : 0, dscrolll = sOffset ? o.documentScroll.left : 0;</p><p>				el.css({ position: 'absolute', top: (iniPos.top + dscrollt), left: (iniPos.left + dscrolll) });</p><p>			}</p><p>			//Opera fixing relative position</p><p>			if (/relative/.test(el.css('position')) && $.browser.opera)</p><p>				el.css({ position: 'relative', top: 'auto', left: 'auto' });</p><p>			this._renderProxy();</p><p>			var curleft = num(this.helper.css('left')), curtop = num(this.helper.css('top'));</p><p>			<em>Store needed variables</em></p><p>			this.offset = this.helper.offset();</p><p>			this.position = { left: curleft, top: curtop };</p><p>			this.size = o.proxy || ie6 ? { width: el.outerWidth(), height: el.outerHeight() } : { width: el.width(), height: el.height() };</p><p>			this.originalSize = o.proxy || ie6 ? { width: el.outerWidth(), height: el.outerHeight() } : { width: el.width(), height: el.height() };</p><p>			this.originalPosition = { left: curleft, top: curtop };</p><p>			this.sizeDiff = { width: el.outerWidth() - el.width(), height: el.outerHeight() - el.height() };</p><p>			this.originalMousePosition = { left: e.pageX, top: e.pageY };</p><p>			Aspect Ratio</p><p>			o.aspectRatio = (typeof o.aspectRatio == 'number') ? o.aspectRatio : ((this.originalSize.height / this.originalSize.width)||1);</p><p>			if (o.preserveCursor)</p><p>				$('body').css('cursor', this.axis + '-resize');</p><p>			this.propagate("start", e);</p><p>			return false;</p><p>		},</p><p>		stop: function(e) {</p><p>			this.options.resizing = false;</p><p>			var o = this.options, num = function(v) { return parseInt(v, 10) || 0; }, self = this;</p><p>			if(o.proxy) {</p><p>				var pr = o.proportionallyResize, ista = pr && (/textarea/i).test(pr.get(0).nodeName), </p><p>							soffseth = ista && $.ui.hasScroll(pr.get(0), 'left') /* TODO - jump height */ ? 0 : self.sizeDiff.height,</p><p>								soffsetw = ista ? 0 : self.sizeDiff.width;</p><p>				var s = { width: (self.size.width - soffsetw), height: (self.size.height - soffseth) },</p><p>					left = (parseInt(self.element.css('left'), 10) + (self.position.left - self.originalPosition.left)) || null, </p><p>					top = (parseInt(self.element.css('top'), 10) + (self.position.top - self.originalPosition.top)) || null;</p><p>				if (!o.animate)</p><p>					this.element.css($.extend(s, { top: top, left: left }));</p><p>				if (o.proxy && !o.animate) this._proportionallyResize();</p><p>				this.helper.remove();</p><p>			}</p><p>			if (o.preserveCursor)</p><p>			$('body').css('cursor', 'auto');</p><p>			this.propagate("stop", e);	</p><p>			return false;</p><p>		},</p><p>		drag: function(e) {</p><p>			<em>Increase performance, avoid regex</em></p><p>			var el = this.helper, o = this.options, props = {},</p><p>				self = this, smp = this.originalMousePosition, a = this.axis;</p><p>			var dx = (e.pageX-smp.left)||0, dy = (e.pageY-smp.top)||0;</p><p>			var trigger = this._change[a];</p><p>			if (!trigger) return false;</p><p>			 Calculate the attrs that will be change</p><p>			var data = trigger.apply(this, [e, dx, dy]), ie6 = $.browser.msie && $.browser.version &lt; 7, csdif = this.sizeDiff;</p><p>			if (o._aspectRatio || e.shiftKey)</p><p>				data = this._updateRatio(data, e);</p><p>			data = this._respectSize(data, e);</p><p>			this.propagate("resize", e);</p><p>			el.css({</p><p>				top: this.position.top + "px", left: this.position.left + "px", </p><p>				width: this.size.width + "px", height: this.size.height + "px"</p><p>			});</p><p>			if (!o.proxy && o.proportionallyResize)</p><p>				this._proportionallyResize();</p><p>			this._updateCache(data);</p><p>			return false;</p><p>		},</p><p>		_updateCache: function(data) {</p><p>			var o = this.options;</p><p>			this.offset = this.helper.offset();</p><p>			if (data.left) this.position.left = data.left;</p><p>			if (data.top) this.position.top = data.top;</p><p>			if (data.height) this.size.height = data.height;</p><p>			if (data.width) this.size.width = data.width;</p><p>		},</p><p>		_updateRatio: function(data, e) {</p><p>			var o = this.options, cpos = this.position, csize = this.size, a = this.axis;</p><p>			if (data.height) data.width = (csize.height / o.aspectRatio);</p><p>			else if (data.width) data.height = (csize.width * o.aspectRatio);</p><p>			if (a == 'sw') {</p><p>				data.left = cpos.left + (csize.width - data.width);</p><p>				data.top = null;</p><p>			}</p><p>			if (a == 'nw') { </p><p>				data.top = cpos.top + (csize.height - data.height);</p><p>				data.left = cpos.left + (csize.width - data.width);</p><p>			}</p><p>			return data;</p><p>		},</p><p>		_respectSize: function(data, e) {</p><p>			var el = this.helper, o = this.options, pRatio = o._aspectRatio || e.shiftKey, a = this.axis, </p><p>					ismaxw = data.width && o.maxWidth && o.maxWidth &lt; data.width, ismaxh = data.height && o.maxHeight && o.maxHeight &lt; data.height,</p><p>						isminw = data.width && o.minWidth && o.minWidth &gt; data.width, isminh = data.height && o.minHeight && o.minHeight &gt; data.height;</p><p>			if (isminw) data.width = o.minWidth;</p><p>			if (isminh) data.height = o.minHeight;</p><p>			if (ismaxw) data.width = o.maxWidth;</p><p>			if (ismaxh) data.height = o.maxHeight;</p><p>			var dw = this.originalPosition.left + this.originalSize.width, dh = this.position.top + this.size.height;</p><p>			var cw = /sw|nw|w/.test(a), ch = /nw|ne|n/.test(a);</p><p>			if (isminw && cw) data.left = dw - o.minWidth;</p><p>			if (ismaxw && cw) data.left = dw - o.maxWidth;</p><p>			if (isminh && ch)	data.top = dh - o.minHeight;</p><p>			if (ismaxh && ch)	data.top = dh - o.maxHeight;</p><p>			// fixing jump error on top/left - bug <a href="/ticket/2330">#2330</a></p><p>			var isNotwh = !data.width && !data.height;</p><p>			if (isNotwh && !data.left && data.top) data.top = null;</p><p>			else if (isNotwh && !data.top && data.left) data.left = null;</p><p>			return data;</p><p>		},</p><p>		_proportionallyResize: function() {</p><p>			var o = this.options;</p><p>			if (!o.proportionallyResize) return;</p><p>			var prel = o.proportionallyResize, el = this.helper || this.element;</p><p>			if (!o.borderDif) {</p><p>				var b = [prel.css('borderTopWidth'), prel.css('borderRightWidth'), prel.css('borderBottomWidth'), prel.css('borderLeftWidth')],</p><p>					p = [prel.css('paddingTop'), prel.css('paddingRight'), prel.css('paddingBottom'), prel.css('paddingLeft')];</p><p>				o.borderDif = $.map(b, function(v, i) {</p><p>					var border = parseInt(v,10)||0, padding = parseInt(p[i],10)||0;</p><p>					return border + padding; </p><p>				});</p><p>			}</p><p>			prel.css({</p><p>				height: (el.height() - o.borderDif[0] - o.borderDif[2]) + "px",</p><p>				width: (el.width() - o.borderDif[1] - o.borderDif[3]) + "px"</p><p>			});</p><p>		},</p><p>		_renderProxy: function() {</p><p>			var el = this.element, o = this.options;</p><p>			this.elementOffset = el.offset();</p><p>			if(o.proxy) {</p><p>				this.helper = this.helper || $('&lt;div style="overflow:hidden;"&gt;&lt;/div&gt;');</p><p>				// fix ie6 offset</p><p>				var ie6 = $.browser.msie && $.browser.version &lt; 7, ie6offset = (ie6 ? 1 : 0),</p><p>				pxyoffset = ( ie6 ? 2 : -1 );</p><p>				this.helper.addClass(o.proxy).css({</p><p>					width: el.outerWidth() + pxyoffset,</p><p>					height: el.outerHeight() + pxyoffset,</p><p>					position: 'absolute',</p><p>					left: this.elementOffset.left - ie6offset +'px',</p><p>					top: this.elementOffset.top - ie6offset +'px',</p><p>					zIndex: ++o.zIndex</p><p>				});</p><p>				this.helper.appendTo("body");</p><p>				if (o.disableSelection)</p><p>					$.ui.disableSelection(this.helper.get(0));</p><p>			} else {</p><p>				this.helper = el; </p><p>			}</p><p>		},</p><p>		_change: {</p><p>			e: function(e, dx, dy) {</p><p>				return { width: this.originalSize.width + dx };</p><p>			},</p><p>			w: function(e, dx, dy) {</p><p>				var o = this.options, cs = this.originalSize, sp = this.originalPosition;</p><p>				return { left: sp.left + dx, width: cs.width - dx };</p><p>			},</p><p>			n: function(e, dx, dy) {</p><p>				var o = this.options, cs = this.originalSize, sp = this.originalPosition;</p><p>				return { top: sp.top + dy, height: cs.height - dy };</p><p>			},</p><p>			s: function(e, dx, dy) {</p><p>				return { height: this.originalSize.height + dy };</p><p>			},</p><p>			se: function(e, dx, dy) {</p><p>				return $.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [e, dx, dy]));</p><p>			},</p><p>			sw: function(e, dx, dy) {</p><p>				return $.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [e, dx, dy]));</p><p>			},</p><p>			ne: function(e, dx, dy) {</p><p>				return $.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [e, dx, dy]));</p><p>			},</p><p>			nw: function(e, dx, dy) {</p><p>				return $.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [e, dx, dy]));</p><p>			}</p><p>		}</p><p>	});</p><p>	$.extend($.ui.resizable, {</p><p>		defaults: {</p><p>			preventDefault: true,</p><p>			transparent: false,</p><p>			minWidth: 10,</p><p>			minHeight: 10,</p><p>			aspectRatio: false,</p><p>			disableSelection: true,</p><p>			preserveCursor: true,</p><p>			autohide: false,</p><p>			knobHandles: false</p><p>		}</p><p>	});</p><p>/*</p> <ul><li>Resizable Extensions</li></ul><p> */</p><p>	$.ui.plugin.add("resizable", "containment", {</p><p>		start: function(e, ui) {</p><p>			var o = ui.options, self = ui.instance, el = self.element;</p><p>			var oc = o.containment,	ce = (oc instanceof $) ? oc.get(0) : (/parent/.test(oc)) ? el.parent().get(0) : oc;</p><p>			if (!ce) return;</p><p>			if (/document/.test(oc) || oc == document) {</p><p>				self.containerOffset = { left: 0, top: 0 };</p><p>				self.parentData = { </p><p>					element: $(document), left: 0, top: 0, width: $(document).width(),</p><p>					height: $(document).height() || document.body.parentNode.scrollHeight</p><p>				};</p><p>			}</p><p>			// i'm a node, so compute top, left, right, bottom</p><p>			else{</p><p>				self.containerOffset = $(ce).offset();</p><p>				self.containerSize = { height: $(ce).innerHeight(), width: $(ce).innerWidth() };</p><p>				var co = self.containerOffset, ch = self.containerSize.height,	cw = self.containerSize.width, </p><p>							width = ($.ui.hasScroll(ce, "left") ? ce.scrollWidth : cw ), height = ($.ui.hasScroll(ce) ? ce.scrollHeight : ch);</p><p>				self.parentData = { </p><p>					element: ce, left: co.left, top: co.top, width: width, height: height</p><p>				};</p><p>			}</p><p>		},</p><p>		resize: function(e, ui) {</p><p>			var o = ui.options, self = ui.instance, ps = self.containerSize, </p><p>						co = self.containerOffset, cs = self.size, cp = self.position,</p><p>							pRatio = o._aspectRatio || e.shiftKey;</p><p>			if (cp.left &lt; (o.proxy ? co.left : 0)) {</p><p>				self.size.width = self.size.width + (o.proxy ? (self.position.left - co.left) : self.position.left);</p><p>				if (pRatio) self.size.height = self.size.width * o.aspectRatio;</p><p>				self.position.left = o.proxy ? co.left : 0;</p><p>			}</p><p>			if (cp.top &lt; (o.proxy ? co.top : 0)) {</p><p>				self.size.height = self.size.height + (o.proxy ? (self.position.top - co.top) : self.position.top);</p><p>				if (pRatio) self.size.width = self.size.height / o.aspectRatio;</p><p>				self.position.top = o.proxy ? co.top : 0;</p><p>			}</p><p>			var woset = (o.proxy ? self.offset.left - co.left : self.position.left) + self.sizeDiff.width, </p><p>						hoset = (o.proxy ? self.offset.top - co.top : self.position.top) + self.sizeDiff.height;</p><p>			if (woset + self.size.width &gt;= self.parentData.width) {</p><p>				self.size.width = self.parentData.width - woset;</p><p>				if (pRatio) self.size.height = self.size.width * o.aspectRatio;</p><p>			}</p><p>			if (hoset + self.size.height &gt;= self.parentData.height) {</p><p>				self.size.height = self.parentData.height - hoset;</p><p>				if (pRatio) self.size.width = self.size.height / o.aspectRatio;</p><p>			}</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("resizable", "grid", {</p><p>		resize: function(e, ui) {</p><p>			var o = ui.options, self = ui.instance, cs = self.size, os = self.originalSize, op = self.originalPosition, a = self.axis, ratio = o._aspectRatio || e.shiftKey;</p><p>			o.grid = typeof o.grid == "number" ? [o.grid, o.grid] : o.grid;</p><p>			var ox = Math.round((cs.width - os.width) / o.grid[0]) * o.grid[0], oy = Math.round((cs.height - os.height) / o.grid[1]) * o.grid[1];</p><p>			if (/^(se|s|e)$/.test(a)) {</p><p>				self.size.width = os.width + ox;</p><p>				self.size.height = os.height + oy;</p><p>			}</p><p>			else if (/^(ne)$/.test(a)) {</p><p>				self.size.width = os.width + ox;</p><p>				self.size.height = os.height + oy;</p><p>				self.position.top = op.top - oy;</p><p>			}</p><p>			else if (/^(sw)$/.test(a)) {</p><p>				self.size.width = os.width + ox;</p><p>				self.size.height = os.height + oy;</p><p>				self.position.left = op.left - ox;</p><p>			}</p><p>			else {</p><p>				self.size.width = os.width + ox;</p><p>				self.size.height = os.height + oy;</p><p>				self.position.top = op.top - oy;</p><p>				self.position.left = op.left - ox;</p><p>			}</p><p>		}</p><p>	});</p><p>	$.ui.plugin.add("resizable", "animate", {</p><p>		stop: function(e, ui) {</p><p>			var o = ui.options, self = ui.instance;</p><p>			var pr = o.proportionallyResize, ista = pr && (/textarea/i).test(pr.get(0).nodeName), </p><p>							soffseth = ista && $.ui.hasScroll(pr.get(0), 'left') /* TODO - jump height */ ? 0 : self.sizeDiff.height,</p><p>								soffsetw = ista ? 0 : self.sizeDiff.width;</p><p>			var style = { width: (self.size.width - soffsetw), height: (self.size.height - soffseth) },</p><p>						left = (parseInt(self.element.css('left'), 10) + (self.position.left - self.originalPosition.left)) || null, </p><p>							top = (parseInt(self.element.css('top'), 10)</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 29, 2008 07:03PM UTC by <span class="author">malfist</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>That didn't work either.</p><p>The drag function starts at line 2519, where I think the error is, is in the if inside the for loop (lines 2529-2533), 10 lines down.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 30, 2008 12:06AM UTC by <span class="author">scott.gonzal</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Please create a new ticket in the <a href="http://ui.jquery.com/bugs/" class="ext-link"><span class="icon"></span>UI bug tracker</a>.  Thanks.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
