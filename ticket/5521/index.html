<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#5521 ($(document).ready() firing too early probably in WebKit, and messing up the page) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/5520/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/5522/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#5521</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened November 17, 2009 10:24AM UTC</p>
      
        <p>Closed September 30, 2010 08:53PM UTC</p>
      
      
        <p>Last modified May 20, 2013 10:47AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">$(document).ready() firing too early probably in WebKit, and messing up the page</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        kipras
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        major
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.4">1.4</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>core</td>
      
        <th>Version:</th>
      
      <td>1.3.2</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>document ready webkit</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I have attached a website design, where adding the jQuery script breaks the website on <a href="/wiki/WebKit">WebKit</a> based browsers (i have tried Google Chrome 3.0.195.27 and Safari 4 Public Beta 528.16 on Windows XP).</p><p>The page is displayed correctly in all browsers (Firefox, IE 6+, Opera), except the <a href="/wiki/WebKit">WebKit</a> based browsers. When you load the page in Chrome or Safari, about 50% of the time you will see the three buttons where it says "Rezervavimas online", "Užsakymas" and "Stiklių apartamentai" get displayed one below each other, even though they are supposed to float left (note, that the other 50% of the time, everything gets displayed fine).</p><p>These buttons are actually &lt;a href=""&gt; tags that each have a div inside them and display:block attached to them. Now i know that this is not the best solution, but it works in every browser, and jQuery shouldn't mess that up.</p><p>Mind, that i mean adding the jQuery script just to be loaded - the website gets messed up, without any additional coding, just by loading the jQuery script. Without loading the jQuery script, everything is displayed fine in <a href="/wiki/WebKit">WebKit</a> browsers. Comment it out and you will see.</p><p>I also found a fix to this situation. Add these lines between lines 3054 and 3055 in jquery-1.3.2.js (right after the line</p><p>document.addEventListener( "DOMContentLoaded", function(){ </p><p>if (jQuery.browser.safari && document.readyState != "complete") {</p><p>	setTimeout( arguments.callee, 100 );</p><p>	return;</p><p>}</p><p>With this check, everything works fine.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (2)</summary>

  <ul class="ticket-attachments">
    
      <li>
        <a href="/attachment/ticket/5521/html.zip/index.html">html.zip</a> (254.5 KB) - added by kipras
        <strong>November 17, 2009 10:28AM UTC</strong>.<br>
        <p>Here are the sources to the website design which shows the problem (use a <a href="/wiki/WebKit">WebKit</a> based browser to see what i'm talking about)</p>
      </li>
    
      <li>
        <a href="/attachment/ticket/5521/jquery-1.3.2.fixed.js/index.html">jquery-1.3.2.fixed.js</a> (118.1 KB) - added by kipras
        <strong>November 17, 2009 10:31AM UTC</strong>.<br>
        <p>This is the fixed version of jQuery 1.3.2, replace the original jquery-1.3.2.min.js with this one to see the problem go away.</p>
      </li>
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (16)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 19, 2009 07:18AM UTC by <span class="author">caii</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>GOOD!</p><p>I download and test your "html.zip", and the result is that the problem really as what you described.</p><p>between lines 3200 and 3207 in jquery-1.3.2.js, In order to achieve "jQuery.support.boxModel" .</p><p>There executed the first "ready" function . then maybe too early and messing up the page as you find.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 26, 2009 10:15PM UTC by <span class="author">yves.wdxperience</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks,</p><p>Your fix works in my website.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 16, 2009 02:22AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This is basically the patch. We'll need a better way to detect webkit though because </p><pre class="wiki">jQuery.browser.safari</pre> will return false in 1.4 in Chrome for example. <p></p><pre class="wiki">
		// Mozilla, Opera and webkit nightlies currently support this event
		if ( document.addEventListener ) {
			// Use the handy event callback
			document.addEventListener( "DOMContentLoaded", function DOMContentLoaded() {
+				if (jQuery.browser.safari && document.readyState != "complete") {
+					setTimeout( arguments.callee, 100 );
+					return;
+				}
				document.removeEventListener( "DOMContentLoaded", DOMContentLoaded, false );
				jQuery.ready();
			}, false );

</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 04, 2010 01:46PM UTC by <span class="author">36Flavours</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Has there been any progress regarding this ticket?</p><p>I tried the nightly build but found that no solution (neither this or an alternative) had been included.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 18, 2010 10:49AM UTC by <span class="author">kipras</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This bug is still present in jQuery 1.4 !</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 03, 2010 01:30PM UTC by <span class="author">kipras</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I've recently encountered a similar situation in IE6, where loading jQuery also does some undesired changes to the page layout (tried versions 1.3.X and 1.4.X, and that happens on both).</p><p>I've played around with it a bit and tracked down, that the cause of this is indeed the jQuery.support.boxModel test as pointed out by caii, that screwes up the page layout. I've commented it out, and everything is fine then.</p><p>Anyway, i'm curious as to why this has not been fixed? Come on people, you've managed to add so many big changes to jQuery 1.4, and you can't fix one small problem? :))</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 13, 2010 10:37AM UTC by <span class="author">nathanhammond</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/wiki/WebKit">WebKit</a>-based browsers do not calculate in the size of any images without width and height attributes on events triggered by DOMContentLoaded.</p><p>A quick review of the HTML provided shows that there aren't dimensions on the img tags, and thus the behavior seen in <a href="/wiki/WebKit">WebKit</a>-based browsers.</p><p>I would say that this is expected behavior and that this ticket can be closed.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 26, 2010 05:14PM UTC by <span class="author">rasamassen</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <blockquote> <a href="/wiki/WebKit">WebKit</a>-based browsers do not calculate in the size of any images without width and height attributes on events triggered by DOMContentLoaded.</blockquote><p>But IE,FF,and O do.  I would say this is unexpected behavior in <a href="/wiki/WebKit">WebKit</a> vs. any other standard browser.  Make a simple page with a div containing an image of unspecified height and test height()/outerHeight().  IE,FF,and O will return a height that accounts for the image.  Webkit-based browsers will not.  But JQuery should return the same value no matter what browser it is run in.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 30, 2010 08:53PM UTC by <span class="author">addyosmani</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I agree with @nathanhammond that this is an issue with <a href="/wiki/WebKit">WebKit</a> itself and that adhering to the image attribute requirements <a href="/wiki/WebKit">WebKit</a> has will solve the issue.</p><p>When it comes down to individual rendering engines, I think that we need to leave it up to the engines themselves to manage how they output attributes such as image dimensions and that it's not the responsibility of the jQuery core to provide fixes for this type of behavior.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 23, 2010 09:57AM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I've reproduced this in Chrome5 with 1.4.2 even when the element in question DID have specified dimensions. For anyone else who experiences this I managed to work around it  by putting the ready function at the bottom of the body, after the element in question. </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 08, 2011 03:07AM UTC by <span class="author">my name is piano</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><strong>Bumping bug because browser buffoonery boggles brain.</strong></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 30, 2012 04:37PM UTC by <span class="author">mykolenas@yahoo.co.uk</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>bump because the bug is still present in 1.7.2 :(</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 30, 2012 04:44PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This isn't an AOL message board, bugs don't need a "bump". They need verifiable test cases.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 31, 2012 10:51AM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:13 dmethvin]:</p><blockquote> This isn't an AOL message board, bugs don't need a "bump". They need verifiable test cases.</blockquote><p>want a testcase?</p><p>here's one:</p><p>$(document).ready(function() {</p><p>     alert("I bet you can't see me after a refresh if you are using Chrome");</p><p>});</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:15">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 31, 2012 11:04AM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:15">comment:15</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:14 anonymous]:</p><blockquote> Replying to [comment:13 dmethvin]: &gt; This isn't an AOL message board, bugs don't need a "bump". They need verifiable test cases.  want a testcase? here's one:  $(document).ready(function() {      alert("I bet you can't see me after a refresh if you are using Chrome"); });</blockquote><p><a href="http://fiddle.jshell.net/S4avC/1/show/light/" class="ext-link"><span class="icon"></span>http://fiddle.jshell.net/S4avC/1/show/light/</a></p><p>Oh, look, I refresh and get the alert all right.</p><p>Please, provide a usable and verifiable test case. If you can't, ask for support on a forum of your choice and/or IRC. Thank you.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:16">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 20, 2013 10:47AM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:16">comment:16</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Still present on jquery 1.9.1, well done, I am not using jquery since is not reliable at all !</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
