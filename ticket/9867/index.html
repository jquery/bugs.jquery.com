<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#9867 (built-in improvements to responsive-ness of Deferred Promises) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/9866/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/9868/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#9867</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">enhancement</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened July 20, 2011 03:04AM UTC</p>
      
        <p>Closed July 20, 2011 09:33AM UTC</p>
      
      
        <p>Last modified July 21, 2011 11:52PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">built-in improvements to responsive-ness of Deferred Promises</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        jokeyrhyme
      </td>
      <th>Owned by:</th>
      <td>jokeyrhyme</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        undecided
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>deferred</td>
      
        <th>Version:</th>
      
      <td>1.6.2</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>It's a well-known technique in <a href="/wiki/JavaScript">JavaScript</a> to break computationally intensive tasks into asynchronous blocks using setTimeout(fn, 0). My understanding is that it prevents the UI thread from being starved of execution time, so the UI is still responsive.</p><p>My suggestion is for Deferred.resolveWith (and therefore, Deferred.resolve) to implement this setTimeout(fn, 0) technique somehow. That way we can use Deferreds to manage our asynchronous blocks, and automatically benefit from a silky-smooth user experience. This does mean additional anonymous functions would be created, and I suppose there could be issues with animation timings.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (7)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 20, 2011 06:36AM UTC by <span class="author">ajpiano</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Thanks for your time and interest in helping out the jQuery project! Unfortunately, this proposal is unsuitably vague.   While it is certainly within the realm of possibility to somehow leverage Deferreds when doing the setTimeout(fn, 0) technique you describe above, the idea that we can &quot;somehow implement it&quot; into Deferreds and that will autmagically translate into a more responsive UI is not something we can use as a basis for a feature.  &#92;
&#92;
Is there a real world use case or implementation of this that you can point to, or can you describe in more detail what you imagine the repercussions on the jQuery API would look like?&#92;
&#92;
For what it&#39;s worth, I can&#39;t see how adding a timeout into Deffered.resolveWith is a particularly wise idea.</span> → <span class="change-field-new">1311143882429116</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ jokeyrhyme</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Thanks for your time and interest in helping out the jQuery project! Unfortunately, this proposal is unsuitably vague.   While it is certainly within the realm of possibility to somehow leverage Deferreds when doing the setTimeout(fn, 0) technique you describe above, the idea that we can "somehow implement it" into Deferreds and that will autmagically translate into a more responsive UI is not something we can use as a basis for a feature.  </p><p>Is there a real world use case or implementation of this that you can point to, or can you describe in more detail what you imagine the repercussions on the jQuery API would look like?</p><p>For what it's worth, I can't see how adding a timeout into Deffered.resolveWith is a particularly wise idea.  You should use Deferreds to manage the asynchronous behaviour of the timeouts, not expect the creation of Deferreds to create the timeouts for you.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 20, 2011 07:45AM UTC by <span class="author">jokeyrhyme</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Sorry about the vagueness.&#92;
&#92;
The application I am working on performs various computationally-intensive tasks, at it also performs fairly intensive DOM manipulations (large insertions, etc). Some of these tasks are asynchronous (like AJAX, or HTML5 File API, Web Workers) and some of these are synchronous (performing XSLT, element searches, math, etc).&#92;
&#92;
I am currently using Deferreds to break these tasks into smaller chunks. I use then when-then mechanism to force serial execution upon otherwise potentially-parallel tasks.&#92;
&#92;
Something I have noticed is that if I don&#39;t throw setTimeout(fn, 0)&#39;s in myself, then the UI for the application will lock-up at times. Looking at the source code for jQuery Deferred Promises, it seems resolves/rejects lead directly into then/fail/done/always, with no room given for the UI to catch up in-between.&#92;
&#92;
To me, it seems that Deferreds really seem to be all about keeping JavaScript responsive (besides providing greater control over asynchronous tasks). My suggestion / question is whether it would be feasible to transparently insert the setTimeout(fn, 0) technique into the current sequence of resolve-&gt;then, so that UIs are automatically more responsive.&#92;
&#92;
I am targeting mobile WebKit and mobile Gecko so far. In testing, I have noticed that without the setTimeout technique, my application locks up the UI for 30-60 seconds at times. I guess I am trying to be lazy and avoid having to manually insert setTimeouts into my own code, but to have it done transparently by jQuery Deferreds.&#92;
&#92;
I would not expect the jQuery API to visibly change for developers. However, some control over the timeout interval itself (defaulting to 0) might be appropriate via a jQuery constant, similar to the jQuery.fx.interval constant.</span> → <span class="change-field-new">1311147968034978</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment1:</th>
                  <td>
                    
                      <span class="change-field-old">Sorry about the vagueness.&#92;
&#92;
The application I am working on performs various computationally-intensive tasks, at it also performs fairly intensive DOM manipulations (large insertions, etc). Some of these tasks are asynchronous (like AJAX, or HTML5 File API, Web Workers) and some of these are synchronous (performing XSLT, element searches, math, etc).&#92;
&#92;
I am currently using Deferreds to break these tasks into smaller chunks. I then use the when-then mechanism to force serial execution upon otherwise potentially-parallel tasks.&#92;
&#92;
Something I have noticed is that if I don&#39;t throw setTimeout(fn, 0)&#39;s in myself, then the UI for the application will lock-up at times. Looking at the source code for jQuery Deferred Promises, it seems resolves/rejects lead directly into then/fail/done/always, with no room given for the UI to catch up in-between.&#92;
&#92;
To me, it seems that Deferreds really seem to be all about keeping JavaScript responsive (besides providing greater control over asynchronous tasks). My suggestion / question is whether it would be feasible to transparently insert the setTimeout(fn, 0) technique into the current sequence of resolve-&gt;then, so that UIs are automatically more responsive.&#92;
&#92;
I am targeting mobile WebKit and mobile Gecko so far. In testing, I have noticed that without the setTimeout technique, my application locks up the UI for 30-60 seconds at times. I guess I am trying to be lazy and avoid having to manually insert setTimeouts into my own code, but to have it done transparently by jQuery Deferreds.&#92;
&#92;
I would not expect the jQuery API to visibly change for developers. However, some control over the timeout interval itself (defaulting to 0) might be appropriate via a jQuery constant, similar to the jQuery.fx.interval constant.</span> → <span class="change-field-new">1311148002025880</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
        
          
            <div class="ticket-comment-body">
              <p>Sorry about the vagueness.</p><p>The application I am working on performs various computationally-intensive tasks, at it also performs fairly intensive DOM manipulations (large insertions, etc). Some of these tasks are asynchronous (like AJAX, or HTML5 File API, Web Workers) and some of these are synchronous (performing XSLT, element searches, math, etc).</p><p>I am currently using Deferreds to break these tasks into smaller chunks. I then use the when-then mechanism to force serial execution upon otherwise potentially-parallel tasks (only where sequence must be preserved).</p><p>Something I have noticed is that if I don't throw setTimeout(fn, 0)'s in myself, then the UI for the application will lock-up at times. Looking at the source code for jQuery Deferred Promises, it seems resolves/rejects lead directly into then/fail/done/always, with no room given for the UI to catch up in-between.</p><p>To me, it seems that Deferreds really seem to be all about keeping <a href="/wiki/JavaScript">JavaScript</a> responsive (besides providing greater control over asynchronous tasks). My suggestion / question is whether it would be feasible to transparently insert the setTimeout(fn, 0) technique into the current sequence of resolve-&gt;then, so that UIs are automatically more responsive.</p><p>I am targeting mobile <a href="/wiki/WebKit">WebKit</a> and mobile Gecko so far. In testing, I have noticed that without the setTimeout technique, my application locks up the UI for 30-60 seconds at times. I guess I am trying to be lazy and avoid having to manually insert setTimeouts into my own code, but to have it done transparently by jQuery Deferreds.</p><p>I would not expect the jQuery API to visibly change for developers. However, some control over the timeout interval itself (defaulting to 0) might be appropriate via a jQuery constant, similar to the jQuery.fx.interval constant.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 20, 2011 08:05AM UTC by <span class="author">jokeyrhyme</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Here's an example of what I'm talking about:</p><p><a href="http://jsfiddle.net/fQLum/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/fQLum/</a></p><p>The first function is how everyone would be using Deferreds right now.</p><p>The second function is how I am currently using Deferreds, to improve my UI responsiveness. It would be terrific if I didn't have to do the setTimeout myself, but if were done automatically inside the Deferred.</p><p>I understand perfectly if this suggestion is rejected. I am just throwing it out there in case this idea is something others will find useful. It might be that this technique can be married with Deferreds in someway that does not effect the core Deferred implementation but is still transparent enough to be terrific short-hand.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 20, 2011 09:25AM UTC by <span class="author">gnarf</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <pre class="wiki">setTimeout( fn, 0 )</pre> is not "immediate". Take a look at <a href="http://dbaron.org/log/20100309-faster-timeouts" class="ext-link"><span class="icon"></span>this article</a>.<p>I see why in your use case you would like for the processing to happen inside of its own event loop, but this is a situation where you could easily write your own wrapper for $.Deferred that injects the logic you need to the specific deferreds you want to "enhance".</p><p>I think adding any </p><pre class="wiki">setTimeout</pre> inbetween resolve and done is unnecessary for &gt;90% of its uses and much better to be solved by your own wrapper, something like <a href="http://jsfiddle.net/7hc5y/" class="ext-link"><span class="icon"></span>this fiddle</a>.<p></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 20, 2011 09:33AM UTC by <span class="author">ajpiano</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">{{{&#92;
I think adding any setTimeout inbetween resolve and done is unnecessary for &gt;90% of its uses and much better to be solved by your own wrapper, something like  this fiddle.&#92;
}}}&#92;
+1</span> → <span class="change-field-new">1311154500960994</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">deferred</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>"I think adding any setTimeout inbetween resolve and done is unnecessary for &gt;90% of its uses and much better to be solved by your own wrapper, something like this fiddle."</p><p>+1</p>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 20, 2011 02:02PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This really does seem like a job for web workers and postMessage, although you'll need a shim for older browsers like IE if you need to support them.</p><blockquote> I would not expect the jQuery API to visibly change for developers. </blockquote><p>Those are the _worst_ kind of changes, when the semantics are altered in a new version but the syntax stays the same. Adding <code>setTimeout</code> changes a synchronous operation to an asynchronous one.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 21, 2011 11:52PM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>To be honest, I would have loved to be able to implement resolveWith that way, it would have solved all our try/finally and dead-locking in IE problems.</p><p>Sadly, since ajax can be ran synchronously, it just wasn't an option :/</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
