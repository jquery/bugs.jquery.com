<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#8067 (If $.when() receives an object that has a method named &amp;quot;promise&amp;quot;, it assumes the object is observable) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/8066/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/8068/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#8067</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened January 26, 2011 08:56PM UTC</p>
      
        <p>Closed January 27, 2011 09:02PM UTC</p>
      
      
        <p>Last modified February 01, 2011 11:21AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">If $.when() receives an object that has a method named &quot;promise&quot;, it assumes the object is observable</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        rmurphey
      </td>
      <th>Owned by:</th>
      <td>rmurphey</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.next">1.next</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>core</td>
      
        <th>Version:</th>
      
      <td>1.5rc1</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>See example at <a href="http://jsfiddle.net/rmurphey/VJrPt/." class="ext-link"><span class="icon"></span>http://jsfiddle.net/rmurphey/VJrPt/.</a> </p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (9)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 26, 2011 08:57PM UTC by <span class="author">rmurphey</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Instead of just testing that the value passed to $.when has a promise method, we should probably check that the promise method returns an object with then and fail methods?</span> → <span class="change-field-new">1296075554676301</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>If the object has a promise method, that doesn't mean that what it returns is a promise (having, at least, a then method). </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 26, 2011 09:37PM UTC by <span class="author">jitter</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">core</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 26, 2011 10:21PM UTC by <span class="author">jitter</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ jaubourg</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">assigned</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 26, 2011 11:37PM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Testing for then on the returned object doesn&#39;t ensure it is a promise either.&#92;
&#92;
http://jsfiddle.net/9fuHZ/&#92;
&#92;
Design by convention has its limits and no matter how complicated the test becomes, you always ways around it.</span> → <span class="change-field-new">1296085077575061</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Testing for then on the returned object doesn't ensure it is a promise either.</p><p><a href="http://jsfiddle.net/9fuHZ/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/9fuHZ/</a></p><p>Design by convention has its limits and no matter how complicated the test becomes, you always have ways around it.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2011 12:09AM UTC by <span class="author">jitter</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-old">jaubourg</span> → <span class="change-field-new">rmurphey</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">assigned</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2011 12:43AM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>And I'm not gifted with jsfiddle: <a href="http://jsfiddle.net/9fuHZ/7/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/9fuHZ/7/</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2011 03:35PM UTC by <span class="author">rmurphey</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:4 jaubourg]:</p><blockquote> Testing for then on the returned object doesn't ensure it is a promise either.  <a href="http://jsfiddle.net/9fuHZ/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/9fuHZ/</a>  Design by convention has its limits and no matter how complicated the test becomes, you always have ways around it.</blockquote><p>As Dave Methvin pointed out to me in the IRC channel, if we don't know what the promise method on the object passed to $.when does, then we probably don't want to run it to see what it returns :)</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2011 09:02PM UTC by <span class="author">jitter</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>If I read this right this issue is settled. There is no foolproof way to check if a <code>promise()</code> function really returns a promise or something which looks like it.</p><p>Feel free to yell at me and to request this ticket to get reopened. </p><pre class="wiki">
#!html
&lt;h1 style="color:#fafafa"&gt;But it's not going to happen. No matter what you say&lt;/h1&gt;
</pre>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 01, 2011 11:21AM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Replying to [comment:7 rmurphey]:&#92;
&gt; Replying to [comment:4 jaubourg]:&#92;
&gt; &gt; Testing for then on the returned object doesn&#39;t ensure it is a promise either.&#92;
&gt; &gt; &#92;
&gt; &gt; http://jsfiddle.net/9fuHZ/&#92;
&gt; &gt; &#92;
&gt; &gt; Design by convention has its limits and no matter how complicated the test becomes, you always have ways around it.&#92;
&gt; &#92;
&gt; As Dave Methvin pointed out to me in the IRC channel, if we don&#39;t know what the promise method on the object passed to $.when does, then we probably don&#39;t want to run it to see what it returns :)&#92;
&#92;
What about an object that is observable but doesn&#39;t implement the promise interface? Just like a jQuery collection could end up being if something like http://bugs.jquery.com/ticket/7934 was to be implemented (and it makes no sense for a jQuery collection to implement the promise interface since it would only clobber jQuery.fn and be unnecessarily confusing).&#92;
&#92;
Remember that Deferreds implement the promise interface as a convenience and I&#39;m beginning to believe it was a mistake seeing as it turns out to be a bit confusing and hinders the fact that promise() returns an immutable object while deferreds are, obviously, mutable.&#92;
&#92;
At any rate, I don&#39;t see this as any different from testing for the presence of a nodeType attribute to determine if an object is a DOM node. Something jQuery does everywhere in the code and that works perfectly as long as the convention is known and no-one attempts to break it.&#92;
&#92;
An earlier version had a specific object attached onto the promise method to &quot;mark&quot; it. But, not only can you work around it, but it would also make using a third-party promise very difficult (ie not a jQuery.Deferred promise, just some other code from another library that implements Promise/A).&#92;
&#92;
As it is today, all it takes to make a third party promise observable is this:&#92;
&#92;
// Make third-party promise observable&#92;
thirdPartyPromise.promise = function() {&#92;
   return this;&#92;
}&#92;
&#92;
// Or if the implementation is prototype base&#92;
// Add to the prototype so that all promises are now&#92;
// observable by jQuery&#92;
ThirdPartyPromise.prototype.promise = function() {&#92;
    return this;&#92;
}&#92;
&#92;
Another advantage is that, if the third-party is not Promise/A compliant, it&#39;s pretty easy to return a Promise/A compliant object by doing some more work in the newly created promise method.&#92;
&#92;
This is incidently why jQuery uses a promise method as opposed to a promise property (like dojo and some others do).&#92;
&#92;
Another advantage is that there are far less risks of false positive by using a method rather than a property.</span> → <span class="change-field-new">1296559589003690</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:7 rmurphey]:</p><blockquote> Replying to [comment:4 jaubourg]: &gt; Testing for then on the returned object doesn't ensure it is a promise either. &gt;  &gt; <a href="http://jsfiddle.net/9fuHZ/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/9fuHZ/</a> &gt;  &gt; Design by convention has its limits and no matter how complicated the test becomes, you always have ways around it.  As Dave Methvin pointed out to me in the IRC channel, if we don't know what the promise method on the object passed to $.when does, then we probably don't want to run it to see what it returns :)</blockquote><p>What about an object that is observable but doesn't implement the promise interface? Just like a jQuery collection could end up being if something like <a href="http://bugs.jquery.com/ticket/7934" class="ext-link"><span class="icon"></span>http://bugs.jquery.com/ticket/7934</a> was to be implemented (and it makes no sense for a jQuery collection to implement the promise interface since it would only clobber jQuery.fn and be unnecessarily confusing).</p><p>Remember that Deferreds implement the promise interface as a convenience and I'm beginning to believe it was a mistake seeing as it turns out to be a bit confusing and hinders the fact that promise() returns an immutable object while deferreds are, obviously, mutable.</p><p>At any rate, I don't see this as any different from testing for the presence of a nodeType attribute to determine if an object is a DOM node. Something jQuery does everywhere in the code and that works perfectly as long as the convention is known and no-one attempts to break it.</p><p>An earlier version had a specific object attached onto the promise method to "mark" it. But, not only can you work around it, but it would also make using a third-party promise very difficult (ie not a jQuery.Deferred promise, just some other code from another library that implements Promise/A).</p><p>As it is today, all it takes to make a third party promise observable is this:</p><pre class="wiki">
    // Make third-party promise observable
    thirdPartyPromise.promise = function() {
        return this;
    }

    // Or if the implementation is prototype base
    // Add to the prototype so that all promises are now
    // observable by jQuery
    ThirdPartyPromise.prototype.promise = function() {
        return this;
    }
</pre><p>Another advantage is that, if the third-party is not Promise/A compliant, it's pretty easy to return a Promise/A compliant object by doing some more work in the newly created promise method.</p><p>This is incidently why jQuery uses a promise method as opposed to a promise property (like dojo and some others do).</p><p>Another advantage is that there are far less risks of false positive by using a method rather than a property.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
