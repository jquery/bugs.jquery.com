<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#14880 (event.which not consistent across browsers for keydown event) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/14879/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/14882/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#14880</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened March 11, 2014 08:58PM UTC</p>
      
        <p>Closed March 26, 2014 08:57AM UTC</p>
      
      
        <p>Last modified September 02, 2014 10:37AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">event.which not consistent across browsers for keydown event</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        matteosistisette@gmail.com
      </td>
      <th>Owned by:</th>
      <td>matteosistisette@gmail.com</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        undecided
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>unfiled</td>
      
        <th>Version:</th>
      
      <td>2.1.0</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Try the example at <a href="http://api.jquery.com/keydown/" class="ext-link"><span class="icon"></span>http://api.jquery.com/keydown/</a></p><p>Try it with Google Chrome (Linux)</p><p>press the keys "+" and "-" (NOT on numerik keypad)</p><p>Now try it with Mozilla Firefox (linux)</p><p>press the keys "+" and "-" (NOT on numerik keypad)</p><p>Watch the event's "which" property</p><p>Expected: the value of .which should be the same on both browsers for the same key.</p><p>Observed:</p><p>On Chrome, for the + key: which=187</p><p>           for the - key: which=189</p><p>On Firefox:for the + key: which=171</p><p>           for the - key: which=173</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (5)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 12, 2014 01:04AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ matteosistisette@gmail.com</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I don't have access to that OS+Browser combination.</p><p>What is the expected value?</p><p>Is that value present in any of the standard properties of the DOM event object?</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 26, 2014 08:57AM UTC by <span class="author">trac-o-bot</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Because we get so many tickets, we often need to return them to the initial reporter for more information. If that person does not reply within 14 days, the ticket will automatically be closed, and that has happened in this case. If you still are interested in pursuing this issue, feel free to add a comment with the requested information and we will be happy to reopen the ticket if it is still valid. Thanks!</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 14, 2014 12:04PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">I have no idea which is the expected value, but it should be consistent across browsers, that&#39;s what the jQuery API claims:&#92;
&quot;While browsers use differing properties to store this information, jQuery normalizes the .which property so you can reliably use it to retrieve the key code.&quot;&#92;
&#92;
&#92;
------ Output from Chrome (&quot;+&quot; key) ------&#92;
&#92;
Handler for .keydown() called 1 time(s).&#92;
{&#92;
originalEvent: [object KeyboardEvent],&#92;
type: keydown,&#92;
isDefaultPrevented: function returnFalse() {&#92;
	return false;&#92;
},&#92;
timeStamp: 1397476836189,&#92;
jQuery110208109870944172144: true,&#92;
keyCode: 187,&#92;
key: undefined,&#92;
charCode: 0,&#92;
char: undefined,&#92;
which: 187,&#92;
view: [object Window],&#92;
target: &lt;input id=&quot;target&quot;&gt;,&#92;
shiftKey: false,&#92;
relatedTarget: undefined,&#92;
metaKey: false,&#92;
eventPhase: 2,&#92;
currentTarget: &lt;input id=&quot;target&quot;&gt;,&#92;
ctrlKey: false,&#92;
cancelable: true,&#92;
bubbles: true,&#92;
altKey: false,&#92;
delegateTarget: &lt;input id=&quot;target&quot;&gt;,&#92;
handleObj: [object Object],&#92;
data: null,&#92;
isPropagationStopped: function returnFalse() {&#92;
	return false;&#92;
},&#92;
isImmediatePropagationStopped: function returnFalse() {&#92;
	return false;&#92;
},&#92;
preventDefault: function () {&#92;
		var e = this.originalEvent;&#92;
&#92;
		this.isDefaultPrevented = returnTrue;&#92;
		if ( !e ) {&#92;
			return;&#92;
		}&#92;
&#92;
		// If preventDefault exists, run it on the original event&#92;
		if ( e.preventDefault ) {&#92;
			e.preventDefault();&#92;
&#92;
		// Support: IE&#92;
		// Otherwise set the returnValue property of the original event to false&#92;
		} else {&#92;
			e.returnValue = false;&#92;
		}&#92;
	},&#92;
stopPropagation: function () {&#92;
		var e = this.originalEvent;&#92;
&#92;
		this.isPropagationStopped = returnTrue;&#92;
		if ( !e ) {&#92;
			return;&#92;
		}&#92;
		// If stopPropagation exists, run it on the original event&#92;
		if ( e.stopPropagation ) {&#92;
			e.stopPropagation();&#92;
		}&#92;
&#92;
		// Support: IE&#92;
		// Set the cancelBubble property of the original event to true&#92;
		e.cancelBubble = true;&#92;
	},&#92;
stopImmediatePropagation: function () {&#92;
		this.isImmediatePropagationStopped = returnTrue;&#92;
		this.stopPropagation();&#92;
	}&#92;
}&#92;
&#92;
&#92;
----- Output from Firefox (&quot;+&quot; key)-----&#92;
Handler for .keydown() called 1 time(s).&#92;
{&#92;
originalEvent: [object KeyboardEvent],&#92;
type: keydown,&#92;
isDefaultPrevented: function returnFalse() { return false; },&#92;
timeStamp: 153805815,&#92;
jQuery110206712352453989763: true,&#92;
keyCode: 171,&#92;
key: MozPrintableKey,&#92;
charCode: 0,&#92;
char: undefined,&#92;
which: 171,&#92;
view: [object Window],&#92;
target: &lt;input id=&quot;target&quot;&gt;,&#92;
shiftKey: false,&#92;
relatedTarget: undefined,&#92;
metaKey: false,&#92;
eventPhase: 2,&#92;
currentTarget: &lt;input id=&quot;target&quot;&gt;,&#92;
ctrlKey: false,&#92;
cancelable: true,&#92;
bubbles: true,&#92;
altKey: false,&#92;
delegateTarget: &lt;input id=&quot;target&quot;&gt;,&#92;
handleObj: [object Object],&#92;
data: null,&#92;
isPropagationStopped: function returnFalse() { return false; },&#92;
isImmediatePropagationStopped: function returnFalse() { return false; },&#92;
preventDefault: function () { var e = this.originalEvent; this.isDefaultPrevented = returnTrue; if ( !e ) { return; } // If preventDefault exists, run it on the original event if ( e.preventDefault ) { e.preventDefault(); // Support: IE // Otherwise set the returnValue property of the original event to false } else { e.returnValue = false; } },&#92;
stopPropagation: function () { var e = this.originalEvent; this.isPropagationStopped = returnTrue; if ( !e ) { return; } // If stopPropagation exists, run it on the original event if ( e.stopPropagation ) { e.stopPropagation(); } // Support: IE // Set the cancelBubble property of the original event to true e.cancelBubble = true; },&#92;
stopImmediatePropagation: function () { this.isImmediatePropagationStopped = returnTrue; this.stopPropagation(); }&#92;
}&#92;
&#92;
&#92;
---&#92;
PLEASE REOPEN&#92;
this is a huge issue</span> → <span class="change-field-new">1397479669444852</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>I have no idea which is the expected value, but it should be consistent across browsers, that's what the jQuery API claims:</p><p>"While browsers use differing properties to store this information, jQuery normalizes the .which property so you can reliably use it to retrieve the key code."</p><pre class="wiki">
------ Output from Chrome ("+" key) ------

Handler for .keydown() called 1 time(s).
{
originalEvent: [object KeyboardEvent],
type: keydown,
timeStamp: 1397476836189,
jQuery110208109870944172144: true,
keyCode: 187,
key: undefined,
charCode: 0,
char: undefined,
which: 187,
view: [object Window],
target: &lt;input id="target"&gt;,
shiftKey: false,
relatedTarget: undefined,
metaKey: false,
eventPhase: 2,
currentTarget: &lt;input id="target"&gt;,
ctrlKey: false,
cancelable: true,
bubbles: true,
altKey: false,
delegateTarget: &lt;input id="target"&gt;,
handleObj: [object Object],
data: null,

----- Output from Firefox ("+" key)-----
Handler for .keydown() called 1 time(s).
{
originalEvent: [object KeyboardEvent],
type: keydown,
timeStamp: 153805815,
jQuery110206712352453989763: true,
keyCode: 171,
key: MozPrintableKey,
charCode: 0,
char: undefined,
which: 171,
view: [object Window],
target: &lt;input id="target"&gt;,
shiftKey: false,
relatedTarget: undefined,
metaKey: false,
eventPhase: 2,
currentTarget: &lt;input id="target"&gt;,
ctrlKey: false,
cancelable: true,
bubbles: true,
altKey: false,
delegateTarget: &lt;input id="target"&gt;,
handleObj: [object Object],
data: null,
</pre><p></p><hr><p></p><p>PLEASE REOPEN</p><p>this is a huge issue</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 14, 2014 12:51PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Your output shows that the two browsers disagree on <code>keyCode</code>. There's nothing jQuery can do about that, we can only normalize the information they provide. Or do you have some suggestion about how to do this?</p><p>If this SO thread is correct it sounds like you should report a bug to Firefox: <a href="http://stackoverflow.com/questions/10822100/determine-if-plus-key-in-keydown-is-from-the-numpad" class="ext-link"><span class="icon"></span>http://stackoverflow.com/questions/10822100/determine-if-plus-key-in-keydown-is-from-the-numpad</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 02, 2014 10:37AM UTC by <span class="author">teo1978</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>OMG I hadn't realized you have closed this.</p><blockquote> Your output shows that the two browsers disagree on keyCode. There's nothing jQuery can do about that, we can only normalize the information they provide. Or do you have some suggestion about how to do this?</blockquote><p>Yes, OBVIOUSLY.</p><p>Maintain handmade per-browser keycode maps to convert from wrong browser-specific codes to standard key codes consistent across browsers.</p><p>From:</p><p><a href="http://api.jquery.com/keydown/" class="ext-link"><span class="icon"></span>http://api.jquery.com/keydown/</a></p><p>"While browsers use differing properties to store this information, jQuery normalizes the .which property so you can reliably use it to retrieve the key code."</p><p>From that, I expect jQuery to take the responsibility to guarantee consistent cross-browser key codes. Otherwise why am I using .which in the first place? If I wanted raw low-level browser-provided nonstandard garbage, I would use the browser's low level properties, or I wouldn't even use jQuery in the first place.</p><p>Just as jQuery simulates mouseover and mouseout (or some of those, don't remember exactly) that are not present on all browsers, for the sake of cross-browserness, why shouldn't it also correct key code inconsistencies?</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
