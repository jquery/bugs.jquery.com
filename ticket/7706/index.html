<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#7706 (jquery.tmpl appears to execute ${} content tag 4 times) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/7705/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/7707/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#7706</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened December 06, 2010 05:35AM UTC</p>
      
        <p>Closed December 06, 2010 06:34AM UTC</p>
      
      
        <p>Last modified December 16, 2010 07:40PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">jquery.tmpl appears to execute ${} content tag 4 times</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        corydodt
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        undecided
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.6">1.6</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>templates</td>
      
        <th>Version:</th>
      
      <td>1.4.4</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Try adding this to a template:</p><pre class="wiki">
${console.log("hello")?"":""}
</pre><p>(This logs to the console and discards the undefined return value.)</p><p>"hello" appears 4 times in the js console.</p><p>Observed in: Chromium 7 and Firefox 3.6 (firebug)</p><p>Observed in: Windows7 and Linux</p><p>Observed in: jquery.tmpl beta1 </p><p>I will attach a test document that demonstrates this behavior.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (8)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 06, 2010 05:42AM UTC by <span class="author">corydodt</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Please note that ''any'' expression there will be executed 4 times.  This is not limited to console.log().  You could use a global counter and x++ instead.  The value of x will be 4 times as high as you expected.</p><p>Learning how to use jsfiddle now so I can post this attachment...</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 06, 2010 05:58AM UTC by <span class="author">corydodt</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Here we go: jsfiddle <a href="http://jsfiddle.net/corydodt/LkFd6/2/" class="ext-link"><span class="icon"></span>bug 7706 quadruple execution</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 06, 2010 06:07AM UTC by <span class="author">danheberden</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">&#92;
Try adding this to a template:&#92;
&#92;
&#92;
{{{&#92;
${console.log(&quot;hello&quot;)?&quot;&quot;:&quot;&quot;}&#92;
}}}&#92;
&#92;
&#92;
(This logs to the console and discards the undefined return value.)&#92;
&#92;
&quot;hello&quot; appears 4 times in the js console.&#92;
&#92;
Observed in: Chromium 7 and Firefox 3.6 (firebug)&#92;
Observed in: Windows7 and Linux&#92;
Observed in: jquery.tmpl beta1 &#92;
&#92;
I will attach a test document that demonstrates this behavior.</span> → <span class="change-field-new">Try adding this to a template:&#92;
&#92;
&#92;
{{{&#92;
${console.log(&quot;hello&quot;)?&quot;&quot;:&quot;&quot;}&#92;
}}}&#92;
&#92;
&#92;
(This logs to the console and discards the undefined return value.)&#92;
&#92;
&quot;hello&quot; appears 4 times in the js console.&#92;
&#92;
Observed in: Chromium 7 and Firefox 3.6 (firebug)&#92;
Observed in: Windows7 and Linux&#92;
Observed in: jquery.tmpl beta1 &#92;
&#92;
I will attach a test document that demonstrates this behavior.</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Another template example that shows the variable not incrementing <a href="http://jsfiddle.net/danheberden/UpkCV/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/danheberden/UpkCV/</a></p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 06, 2010 06:24AM UTC by <span class="author">corydodt</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Cool.  What do you make of the difference?</p><p>I have made another fiddle that combines the two.  Function calls are treated one way, naked expressions are treated another: <a href="http://jsfiddle.net/corydodt/McA5L/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/corydodt/McA5L/</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 06, 2010 06:34AM UTC by <span class="author">danheberden</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The issue is because the expression in your template are evaluated when the template is created. It, essentially, creates a new function that gets ran to build the html with provided vars. It would make sense, then, that expressions such as if/ternary statements, increment/decrement, etc would get executed along the way. </p><p>In the mindset of a template, and therefore, application architecture, things like ternaries and increment operators have no place in the template. There are provisions for conditionals and iteration ( {{if}}, {{each}} ), but past that:that kind of logic should be done outside of your template. (such as with the function i provided in my jsfiddle).</p><p>I hope this makes sense. I'm going to close this bug report as working around this would, in effect, not let the tmpl functions operate properly. If you dig in a find a bug/problem in the actual code that's causing this behavior then of course open it back up. </p><p>Thanks for digging into this - this kind of stuff helps us gather the necessary points to go over in the documentation as we build it :D</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 06, 2010 10:57AM UTC by <span class="author">jitter</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">templates</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 06, 2010 05:36PM UTC by <span class="author">corydodt</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>You make a legitimate argument that this shouldn't be in template syntax, and in the future I'll use something like &lt;script&gt;x++&lt;/script&gt; for those rare cases where this is cleaner.</p><p>I don't entirely understand your explanation.  I found this unexpected because the documentation says expression.  It also seems like, from your explanation, it should be executing 2 times instead of 4.  Also, it begs the question "Why is the naked expression run 4 times but the function expression runs once?"  Is there a special case for function calls?  AFAIK expressions are expressions.</p><p>There should be a bug open for the documentation, though:  It currently says this:</p><pre class="wiki">
${fieldNameOrExpression}
fieldNameOrExpression  The name of a field on the current data item,
or a JavaScript function or expression to be evaluated.
</pre><p>I would prefer to see that written as ${fieldNameOrFunctionCall} and eliminate the word "expression" entirely.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 16, 2010 07:40PM UTC by <span class="author">BorisMoore</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>There was an issue that functions were getting evaluated more than once, which has now been fixed. (Use the latest builds to check this). </p><p>That said, Dan is correct that functions used in the template rendering should be limited to functions without side-effects. Calling the function twice should be the same as calling it once. (Idempotent). It is not appropriate to depend on the template engine rendering semantics calling the function only once. For example if you call tmplItem.update() then you functions will get called again for just that template item, so iterators etc. will break...</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
