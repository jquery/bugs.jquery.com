<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#5968 (AJAX failures don&amp;#39;t call error but rather success) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/5967/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/5969/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#5968</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(duplicate)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened January 28, 2010 06:07PM UTC</p>
      
        <p>Closed June 14, 2010 12:20AM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">AJAX failures don&#39;t call error but rather success</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        bbirnbau
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        major
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.4.2">1.4.2</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ajax</td>
      
        <th>Version:</th>
      
      <td>1.4.1</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>ajax, error, success, callback</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I have observed that a failed ajax request does not properly call error upon failure.  I have turned off my server and watch in firebug to see my successful requests turn to failures however the wrong events are called.  Success does get called while error does not</p><p>I have confirmed that the code below works properly in jQuery 1.3.2 and is broken in 1.4.0 and 1.4.1</p><p>&lt;script type="text/javascript"&gt;</p><p>//&lt;![CDATA[</p><p>setInterval(function() {if (ready_to_poll == true && init_tickets_to_load == 0 && polling_failures &lt; 5) { d = new Date();ready_to_poll=false;; jQuery.ajax({complete:function(request){last_que_id=current_que_id;last_twitter_search_id=current_twitter_search_id;ready_to_poll=true; if (polling_failures == 5) { tb_show('error title','#TB_inline?height=300&width=600&inlineId=screen_pop_window&modal=true');$('#TB_ajaxContent').html('&lt;div style="text-align:center;color:red;margin-top:80px;font-size:1.5em;padding:20px;"&gt;We are sorry but something went wrong.  Please close your browser and try again...&lt;/div&gt;');}}, data:'cqid='+current_que_id+'&lqid='+last_que_id+'&cqiids='+current_queue_items+ '&cqsoid='+current_queue_sort_order_id+'&cqpnum='+current_queue_page_num+'&cbt='+d.getTime()+'&ctsid='+current_twitter_search_id+'&ltsid='+last_twitter_search_id+'&ctsmaxid='+current_twitter_search_max_id + '&cvtsids='+current_viewed_tweet_search_ids + '&authenticity_token=' + encodeURIComponent(AUTH_TOKEN), dataType:'script', error:function(request){console.log('error poll');polling_failures++;}, success:function(request){console.log('success poll');polling_failures=0;}, type:'get', url:'/agent/poll'}); }}, 5 * 1000)</p><p>//]]&gt;</p><p>&lt;/script&gt;</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (1)</summary>

  <ul class="ticket-attachments">
    
      <li>
        <a href="/attachment/ticket/5968/0001-Fix-jQuery.ajax-success-function-being-called-when-H.patch/index.html">0001-Fix-jQuery.ajax-success-function-being-called-when-H.patch</a> (1.8 KB) - added by nic_bellamy
        <strong>June 09, 2010 01:10AM UTC</strong>.<br>
        <p>[PATCH] Fix jQuery.ajax() success function being called when HTTP connection refused.</p>
      </li>
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (14)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 28, 2010 09:17PM UTC by <span class="author">bbirnbau</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I would like to add more information that may be helpful.  I've learned that on 1.4.1 when there is a 500 that comes back from the server it does fire the error callback.   Where it doesn't fire the error is when it can't connect to the server</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 29, 2010 02:48AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The error callback is called if the request times out, or if the request returns with an http error code (such as 500). The request hasn't returned (it can't reach the site apparently) so you should set a timeout.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 29, 2010 03:46PM UTC by <span class="author">bbirnbau</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'm not sure that we are saying the same thing here.  In jQuery 1.3.2 when the server was not available error was called correctly.  In jQuery 1.4.0 and 1.4.1 when an Ajax request can't reach the server it returns very quickly (no timeout is required) however the error callback is not fired and the success one is.   This is not something that I can solve via a timeout and I honestly believe that when there is an error on an request (server not available) that jQuery should not ever return success.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 29, 2010 03:56PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Do you have more information about what error codes the server is returning? Can you give us a dump of the XHR so that we can investigate further?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 29, 2010 05:52PM UTC by <span class="author">bbirnbau</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Please see the link to a screenshot of Firebug.  The first 2 requests were fine then I turned off the server and you'll see that the next 3 have a status of TIMEOUT.  </p><p><a href="http://grab.by/23Ka" class="ext-link"><span class="icon"></span>http://grab.by/23Ka</a></p><p>Thanks so much for looking into this as we love using jQuery and have found 1.4.1 to be much faster than 1.3.2 and don't want to have to go back to it.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 01, 2010 01:46AM UTC by <span class="author">bbirnbau</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Is it possible that this is related to this issue?</p><p><a href="http://github.com/jquery/jquery/commit/fe6c86d53046b0f4d648f61c0b8e75387af65152" class="ext-link"><span class="icon"></span>http://github.com/jquery/jquery/commit/fe6c86d53046b0f4d648f61c0b8e75387af65152</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 04, 2010 04:31AM UTC by <span class="author">Joseph Crotty</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Today I set up a totally stripped down test web page with one link to call .ajax(). The POST url was my localhost and I had turned the webserver off.  Firebug net panel XHR shows the request Status as Timeout just like bbirnbau screen shot above. In other words the webserver will never issue anything.  FF will try to use it and issue an immediate Timeout as it is unavailable.</p><p>IE6-8 call the error: callback function with the textStatus value of 'error' and an XHR object.  Chrome, FF, and Safari call the success: callback function with the textStatus value of 'success' and an empty XHR object.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 21, 2010 12:11AM UTC by <span class="author">ris</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'm getting the same results as Joseph Crotty in jQuery 1.4.1 and 1.4.2 on Iceweasel (Firefox) 3.0.6</p><p>Everything causes a 'success', even calling abort() on the xhr.</p><p>Is this perhaps related to ticket <a href="/ticket/6060">#6060</a> ?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 05, 2010 12:09PM UTC by <span class="author">peterl</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I have the same problems, using firefox 3.6 and safari 4.0.</p><p>I've created the following test case:</p><pre class="wiki">
&lt;script type="text/javascript" src="jquery-1.4.2.js"&gt;&lt;/script&gt;
&lt;button id="test"&gt;Click here to test&lt;/button&gt;
&lt;script&gt;
$("#test").click(function() {
    var p = {};
    p.error = function() {
	alert("Error message");
    };
    p.success = function(rdata, status){
	alert("DATA: " + rdata + " -- " + status);
    }
    p.cache = false;
    p.type = "GET";
    p.url = "data.txt";
    $.ajax(p);
});

</pre><p>Create a file data.txt with a text in it. Start the webserver, click the button; it will give you the text with DATA: in front of it.  Stop the webserver, so there is an connection refused, then click the button: it will still say DATA: which is proof the success callback is called, while it should not.</p><p>Change the script to use jquery 1.3.2 instead of 1.4.2 to get the expected results: with jquery 1.3.2 the error callback is called when your http server is shut down....</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 07, 2010 02:46PM UTC by <span class="author">ris</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Having done a bit more work with this, I would have to say this error is rather erratic. On some of my $.ajax requests this problem occurs, and the success function is called with a null data value. On other requests, everything works as it should.</p><p>I haven't yet managed to narrow down the problem cases.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 09, 2010 07:46PM UTC by <span class="author">maqdev</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>There is many duplicate tickets with this problem, here is the one that contains a fix that should help I guess:</p><p><a href="http://dev.jquery.com/ticket/6060" class="ext-link"><span class="icon"></span>http://dev.jquery.com/ticket/6060</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 09, 2010 10:09PM UTC by <span class="author">peterl</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I've tried the patch from ticket:6060 but it did not work.  I assume that this particular problem is not related to that ticket...</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 09, 2010 01:09AM UTC by <span class="author">nic_bellamy</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This all appears to be related to changeset c3c94823f27ee1e935586d46fd86f055f3a3d97d that added handling for an Opera bug with 304 "Not Modified" responses.</p><p>Uploading a "works for me" patch that uses browser sniffing to only apply the 304 workaround when using Opera, so it doesn't break all the other browsers handling of refused connections.</p><p>See 0001-Fix-jQuery.ajax-success-function-being-called-when-H.patch attachment</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 14, 2010 12:20AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ duplicate</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Merging all to dup <a href="/ticket/6060">#6060</a>.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
