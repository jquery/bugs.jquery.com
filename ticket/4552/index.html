<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#4552 (jQuery error running selenium with 1.3.2 in IE6) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/4551/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/4553/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#4552</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened April 17, 2009 06:20AM UTC</p>
      
        <p>Closed November 18, 2010 02:47AM UTC</p>
      
      
        <p>Last modified March 13, 2012 05:16PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">jQuery error running selenium with 1.3.2 in IE6</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        jaiew
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        major
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.4">1.4</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>core</td>
      
        <th>Version:</th>
      
      <td>1.3.2</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>support.js, bindReady, selenium, IE6</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>When running selenium for IE6 a javscript error is produced when jQuery-1.3.2 is included into the html page.</p><p>Details below:</p><p>In revision 6081 of support.js</p><p>the following code was added:</p><pre class="wiki">
87      // Figure out if the W3C box model works as expected
88      // document.body must exist before we can do this
89      jQuery(function(){
90              var div = document.createElement("div");
91              div.style.width = "1px";
92              div.style.paddingLeft = "1px";
93
94              document.body.appendChild( div );
95              jQuery.boxModel = jQuery.support.boxModel = div.offsetWidth === 2;
96              document.body.removeChild( div );
97      });
</pre><p>This causes an error as the bindReady function breaks for IE6 in selenium.</p><p>When jquery executes the check to see if the document is ready:</p><pre class="wiki">
// If IE and not an iframe
// continually check to see if the document is ready
if ( document.documentElement.doScroll && window == window.top ) (function(){
	if ( jQuery.isReady ) return;

		try {
			// If IE is used, use the trick by Diego Perini
			// http://javascript.nwbox.com/IEContentLoaded/
			document.documentElement.doScroll("left");
		} catch( error ) {
			setTimeout( arguments.callee, 0 );
			return;
		}

		// and execute any waiting functions
		jQuery.ready();
	})();
}
</pre><p>The call to document.documentElement.doScroll("left") doesn't raise an error. This might have something to do with selenium running the page in an iframe, and because there is no error raised, jQuery.ready() is called.</p><p>I added the following code on my local copy to the try statement and it now works.</p><pre class="wiki">
try {
   document.documentElement.doScroll("left");
   var div = document.createElement("div");
   document.body.appendChild( div );
   document.body.removeChild( div ).style.display = 'none';
}
</pre><p>The selenium version information is:</p><p>running Selenium RC and Selenium Core 1.0 beta 2, the latest release on the Selenium download page. </p><p>However, it also occurred in the latest release before 1.0 which was Selenium RC 0.9.2 and Selenium Core 0.8.3 I believe.</p><p>The thing of note is obviously that it's running in Selenium's "single window" mode (the default has changed in the latest version (1.0 beta 2) to be "multi window" mode), where it's injecting the html into the iframe then.</p><p>Other possibly secondary things of ntoe:</p><ul><li>It's using the Java client driver</li></ul><ul><li>It runs on Selenium Grid (ver 1.0.3)</li></ul><ul><li>We're using <a href="/wiki/LoggingSelenium">LoggingSelenium</a> which is a wrapper for the actual underlying Selenium libs to log screenshots and stats.</li></ul><p>To replicate it was just a simple html page that includes the latest jquery-1.3.2.js and then run selenium in single window mode for IE6 and open the page.</p><p>The javascript error that pops up pinpoints this line: </p><p>3205  document.body.appendChild( div );</p><p>and the error says "document.body is null or not an object"</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (3)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 08, 2009 07:17AM UTC by <span class="author">othree</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I have this problem too.</p><p>Sometings IE will some this error message.</p><p>It occurs frequently on a never visit site(maybe sistes without local cache).</p><p>If I use 1.2.6, This error will not show.</p><p>So I compare the ready function in this two version.</p><p>I found the following code in 1.3.2 might be the problem source.</p><p>3061                 <em> ensure firing before onload,</em></p><p>3062                  maybe late but safe also for iframes</p><p>3063                 document.attachEvent("onreadystatechange", function(){</p><p>3064                         if ( document.readyState === "complete" ) {</p><p>3065                                 document.detachEvent( "onreadystatechange", arguments.callee );</p><p>3066                                 jQuery.ready();</p><p>3067                         }</p><p>3068                 });</p><p>After I remove these lines of code. And the problem is gone.</p><p>I think execute this codes after confirm the document is in iframe will solve this problem.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 08, 2009 07:20AM UTC by <span class="author">othree</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Sorry about the formate.</p><p>listing the code again.</p><pre class="wiki">
3061                 // ensure firing before onload,
3062                 // maybe late but safe also for iframes
3063                 //document.attachEvent("onreadystatechange", function(){
3064                         //if ( document.readyState === "complete" ) {
3065                                 //document.detachEvent( "onreadystatechange", arguments.callee );
3066                                 //jQuery.ready();
3067                         //}
3068                 //});
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 18, 2010 02:47AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I know nothing of Selenium but it appears that people are using it successfully with jQuery:</p><p><a href="http://seleniumforum.forumotion.net/selenium-rc-discussion-f4/how-to-use-jquery-in-selenium-t256.htm" class="ext-link"><span class="icon"></span>http://seleniumforum.forumotion.net/selenium-rc-discussion-f4/how-to-use-jquery-in-selenium-t256.htm</a></p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
