<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#4512 (jquery-1.3.2.min.js &amp;quot;visible&amp;quot; selector doesn&amp;#39;t run properly) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/4511/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/4513/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#4512</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(fixed)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened April 10, 2009 02:04AM UTC</p>
      
        <p>Closed October 09, 2010 08:22PM UTC</p>
      
      
        <p>Last modified March 09, 2012 10:45AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">jquery-1.3.2.min.js &quot;visible&quot; selector doesn&#39;t run properly</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        qiuzj
      </td>
      <th>Owned by:</th>
      <td>snover</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        high
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.4.3">1.4.3</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>css</td>
      
        <th>Version:</th>
      
      <td>1.4.2</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th>Cc:</th>
      
      <td>dmethvin, snover</td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>HTML Code:</p><p>&lt;table&gt;</p><p>  &lt;tr style="display:none"&gt;&lt;td&gt;Value 1&lt;/td&gt;&lt;/tr&gt;</p><p>  &lt;tr&gt;&lt;td&gt;Value 2&lt;/td&gt;&lt;/tr&gt;</p><p>&lt;/table&gt;</p><p>jQuery Code:</p><p>$("tr:visible")</p><p>Results:</p><p>[ &lt;tr style="display:none"&gt;&lt;td&gt;Value 1&lt;/td&gt;&lt;/tr&gt;,&lt;tr&gt;&lt;td&gt;Value 2&lt;/td&gt;&lt;/tr&gt; ]</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (3)</summary>

  <ul class="ticket-attachments">
    
      <li>
        <a href="/attachment/ticket/4512/4512.diff/index.html">4512.diff</a> (0.9 KB) - added by brandon
        <strong>May 18, 2009 01:50PM UTC</strong>.<br>
        
      </li>
    
      <li>
        <a href="/attachment/ticket/4512/test-all-elements.html/index.html">test-all-elements.html</a> (12.8 KB) - added by jvdneut
        <strong>July 01, 2010 01:16PM UTC</strong>.<br>
        <p>Test page for IE8 visibility problem</p>
      </li>
    
      <li>
        <a href="/attachment/ticket/4512/test2.html/index.html">test2.html</a> (1.2 KB) - added by brandon
        <strong>May 07, 2009 04:23PM UTC</strong>.<br>
        
      </li>
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (35)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 10, 2009 02:23AM UTC by <span class="author">qiuzj</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Firefox：</p><p>[ &lt;tr&gt;&lt;td&gt;Value 2&lt;/td&gt;&lt;/tr&gt; ]</p><p>IE：</p><p>[ &lt;tr style="display:none"&gt;&lt;td&gt;Value 1&lt;/td&gt;&lt;/tr&gt;,&lt;tr&gt;&lt;td&gt;Value 2&lt;/td&gt;&lt;/tr&gt; ]</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 06, 2009 03:50PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">ajax</span> → <span class="change-field-new">selector</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.3.2</span> → <span class="change-field-new">1.3.3</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ john</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 06, 2009 03:54PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-old">john</span> → <span class="change-field-new">brandon</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 06, 2009 03:55PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'm unable to reproduce this. Please validate your HTML. If you are able to create a complete and clean test case, please feel free to reopen this ticket.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 07, 2009 04:24PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Found a complete test-case that is failing.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 07, 2009 04:30PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>And realized my own test-case was flawed. I was looking at the td, not the tr. </p><p>The tr, although hidden with display: none, still has a width &gt; 0. The height of the hidden tr is 0. The logic for the :visible/:hidden selectors was changed so that if an element has a width or a height, it is considered visible.</p><p>The reason it can have a height of 0 and width &gt; 0 and still be visible is because a parent with uncleared floated elements is still visible but will have a height of 0.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 18, 2009 01:02PM UTC by <span class="author">benoit@gardentechno.</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p> I just have a look on the source and I think the following code :</p><p> </p><pre class="wiki">
 return elem.offsetWidth &gt; 0 || elem.offsetHeight &gt; 0;
 </pre><p></p><p> should be replaced by :</p><p> </p><pre class="wiki">
 return elem.offsetWidth &gt; 0 && elem.offsetHeight &gt; 0;
 </pre><p></p> <ul><li>(jQuery/src/selector.js at line 984)</li> <li>This works on firefox and ie6 event if the element is a TR</li></ul>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 18, 2009 01:16PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:7 benoit@gardentechno.]:</p><blockquote>  I just have a look on the source and I think the following code :  <pre class="wiki">
&gt;  return elem.offsetWidth &gt; 0 || elem.offsetHeight &gt; 0;
&gt;  </pre>  should be replaced by :  <pre class="wiki">
&gt;  return elem.offsetWidth &gt; 0 && elem.offsetHeight &gt; 0;
&gt;  </pre></blockquote><p>Unfortunately an element can be "visible" even if one of its dimensions is 0. For example, a div that has un-cleared floated children will cause the parent's height to be 0 but the width will be &gt; 0. Just because the height is 0 doesn't mean the element is hidden.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 18, 2009 01:22PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>My thinking right now is to use the width/height checks for speed and if the result is ambiguous (one dimension is 0 and the other is &gt; 0) then check the display property.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 18, 2009 03:39PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>fixed in r6357</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 18, 2009 09:51PM UTC by <span class="author">vbabiy86</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I just checked out r6357 and it does not work in IE8 if I turn on compatibility mode it works fine.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 18, 2009 11:39PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Can you expand on "does not work" by providing a test case? Thanks.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 18, 2009 11:41PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:12 dmethvin]:</p><blockquote> Can you expand on "does not work" by providing a test case? Thanks.</blockquote><p>I can verify that the patch does not work with the supplied test case in IE8. There is a thread in the dev mailing-list where I've posted another possible solution.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 23, 2009 05:29PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The other possible solution I posted was this.</p><pre class="wiki">
Index: src/selector.js
===================================================================
--- src/selector.js     (revision 6357)
+++ src/selector.js     (working copy)
@@ -977,19 +977,21 @@
 jQuery.expr[":"] = jQuery.expr.filters;

 Sizzle.selectors.filters.hidden = function(elem){
-       var width = elem.offsetWidth, height = elem.offsetHeight;
-       return ( width === 0 && height === 0 ) ?
+       var width = elem.offsetWidth, height = elem.offsetHeight,
+               force = /tr/i.test( elem.tagName );
+       return ( width === 0 && height === 0 && !force ) ?
               true :
-               ( width !== 0 && height !== 0 ) ?
+               ( width !== 0 && height !== 0 && !force ) ?
                       false :
                       !!( jQuery.curCSS(elem, "display") === "none" );
 };

 Sizzle.selectors.filters.visible = function(elem){
-       var width = elem.offsetWidth, height = elem.offsetHeight;
-       return ( width === 0 && height === 0 ) ?
+       var width = elem.offsetWidth, height = elem.offsetHeight,
+               force = /^tr$/i.test( elem.tagName );
+       return ( width === 0 && height === 0 && !force ) ?
               false :
-               ( width &gt; 0 && height &gt; 0 ) ?
+               ( width &gt; 0 && height &gt; 0 && !force ) ?
                       true :
                       !!( jQuery.curCSS(elem, "display") !== "none" );
 };
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:15">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 23, 2009 06:59PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:15">comment:15</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Fixed in r6413</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:16">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 12, 2009 06:53PM UTC by <span class="author">alex88</span></span>
        <a class="ticket-change-link" href="#comment:16">comment:16</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The same problem occurs for divs etc too (no only TRs), you can see it here:</p><p><a href="http://jsbin.com/obavo" class="ext-link"><span class="icon"></span>http://jsbin.com/obavo</a></p><p>using ie8. Temp01 from irc channel suggested me this solution, replace:</p><p>force = /^tr$/i.test( elem.nodeName ); // ticket <a href="/ticket/4512">#4512</a></p><p>with:</p><p>force = true;</p><p>in nightly build rev. 6586, and now it's working fine.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:17">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 02, 2009 02:39PM UTC by <span class="author">davidserduke</span></span>
        <a class="ticket-change-link" href="#comment:17">comment:17</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>See duplicate <a href="/ticket/4512">#4512</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:18">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 11, 2009 10:35PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:18">comment:18</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Looks like this fix is still working, as far as I can tell.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:19">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 30, 2009 09:20AM UTC by <span class="author">januszjasinski</span></span>
        <a class="ticket-change-link" href="#comment:19">comment:19</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:21 john]:</p><blockquote> Looks like this fix is still working, as far as I can tell.</blockquote><p>It is not working in IE8 as can be seen when going to <a href="http://jsbin.com/ijini" class="ext-link"><span class="icon"></span>http://jsbin.com/ijini</a> and when loading the file here: <a href="http://dev.jquery.com/attachment/ticket/4512/test2.html" class="ext-link"><span class="icon"></span>http://dev.jquery.com/attachment/ticket/4512/test2.html</a></p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:20">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 30, 2009 11:00AM UTC by <span class="author">janusz</span></span>
        <a class="ticket-change-link" href="#comment:20">comment:20</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The only way I can get this to work is using the code below</p><pre class="wiki">
$("#clicktoshoworhide").click(function() {  
var elem = $('#elementtoshoworhide')[0];
if(elem.style.display == 'none')
  $('#elementtoshoworhide').show();
    else
  {
    $('#elementtoshoworhide').hide();                       
}
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:21">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 30, 2009 10:50PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:21">comment:21</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>janusz, you're using jQuery 1.3.2 for your test and the fix is in the nightlies.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:22">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 04, 2009 07:06AM UTC by <span class="author">cipher</span></span>
        <a class="ticket-change-link" href="#comment:22">comment:22</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This is not fixed. In IE8 <code>offsetWidth</code> and <code>offsetHeight</code> are not zero for UL's as well.</p><p>I have tested the nightly jQuery file and <code>is(':visible')</code> does not work correctly (along with <code>.toggle()</code>) with UL's.</p><p>changing the code to:</p><p><code>force = /^(?:tr|ul)$/i.test(...);</code></p><p>has fixed the problem; I still don't like selectively testing certain elements for <code>display:none</code>. I think that if the elements height and width are 0, it's hidden; if not, it <strong>might</strong> be hidden but <code>display:none</code> should still be checked.  </p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:23">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 05, 2009 08:01PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:23">comment:23</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@cipher. I created a test case but I got the result that I expected:</p><pre class="wiki">
&lt;script src="dist/jquery.js"&gt;&lt;/script&gt;
&lt;script&gt;
$(window).load(function(){
        alert( $("ul:first").is(":hidden") );
        alert( $("ul:last").is(":hidden") );
});
&lt;/script&gt;
&lt;ul style="width:0;height:0;"&gt;&lt;/ul&gt;
&lt;ul style="display:none;"&gt;&lt;/ul&gt;
</pre><p>The first one was false (height/width of zero, but still visible - correct) the second one was true (display: none, not visible).</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:24">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 01, 2010 01:25PM UTC by <span class="author">jvdneut</span></span>
        <a class="ticket-change-link" href="#comment:24">comment:24</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:27 john]:</p><p>I have encountered the same problem using jQuery 1.4.2 running on IE8 in standards mode but for the TD and TH tags.</p><p>I wrote the following test code to try and detect all the elements that were causing problems. It is by no means complete, but it does show that the problem occurs on more elements than just TR's (specifically it also occurs on BUTTON, TD, TH, CODE, and Q)</p><p><a href="http://dev.jquery.com/attachment/ticket/4512/test-all-elements.html" class="ext-link"><span class="icon"></span>http://dev.jquery.com/attachment/ticket/4512/test-all-elements.html</a></p><p>I also discovered that the problem only occurs on IE8 running in "standards mode", meaning that pages that do not specify a doctype or include a &lt;meta http-equiv="X-UA-Compatible" content="IE=7" /&gt; do work correctly.</p><p>The problem is, as stated earlier, related to the offsetWidth and offsetHeight of the elements in question not being equal to 0 when hidden.</p><p>For my own purposes I modified the jQuery file to read:</p><p>skip = /^(tr|td|th)$/.test(elem.nodeName.toLowerCase());</p><p>instead of:</p><p>skip = elem.nodeName.toLowerCase() === "tr";</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:25">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 05, 2010 03:22AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:25">comment:25</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>cc:</th>
                  <td>
                    
                      <span class="change-field-new">→ dmethvin, snover</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.4</span> → <span class="change-field-new">1.4.3</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>need:</th>
                  <td>
                    
                      <span class="change-field-old">Review</span> → <span class="change-field-new">Patch</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">major</span> → <span class="change-field-new">high</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>version:</th>
                  <td>
                    
                      <span class="change-field-old">1.3.2</span> → <span class="change-field-new">1.4.2</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>So, just to clarify, the *principal* (but not only) issue here is that IE gives table elements a width and height whenever there is an additional table cell in the row that is not hidden but which also has a height.</p><p>We can work around that. This bug is far more nefarious, however, and I feel like laughing and crying at the same time.</p><p>In doing research for this issue, I have discovered that are some inexplicable rules dictating when offsetWidth/offsetHeight are non-zero:</p><p>1. <code>button</code> inside <code>label</code> (but not <code>input</code>)</p><p>2. <code>q</code> inside <code>q</code> (but not <code>code</code> inside <code>code</code>, <code>div</code> inside <code>div</code>, or <code>span</code> inside <code>span</code>)</p><p>3. any table cell as long as there is at least one table cell in the row that is not hidden and is not empty</p><p>4. any element followed by an inline element as long as the first element in the parent is a text node</p><p>That last one is particularly interesting. As far as I can tell, none of these rules are related to <code>hasLayout</code>, either.</p><p>In conclusion, I think we can safely patch the issue with :visible selector and tables, but unless someone can figure out the voodoo that is going on behind the scenes in IE’s warped little brain, someone will eventually be haunted by this shortcut again in another permutation.</p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:26">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 05, 2010 04:58AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:26">comment:26</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>OK, so, modification to the rules, based off this <a href="http://jsfiddle.net/qzBCN/14/" class="ext-link"><span class="icon"></span>plainly ridiculous test case</a>.</p><p>1. Innermost nested <code>q</code> breaks if any of the parent <code>q</code> is followed by another node (other elements like <code>span</code> or <code>code</code> are OK)&lt;br&gt;</p><p>2. Any <code>td</code> or <code>th</code> or <code>tr</code> as long as there is at least one table cell in the row that is not hidden and not empty&lt;br&gt;</p><p>3. <code>button</code> preceeded by a <code>button</code> or non-block node&lt;br&gt;</p><p>4. Some voodoo combinations of inline elements, which also sometimes affect block-level elements but not usually</p><p>If someone can figure out that voodoo, I will be super-duper impressed.</p><p>FML Trident is a mess! Interestingly, IE9b1 in IE8 and IE9 modes pass, but IE9b1 in IE9 mode required the addition of a check to avoid testing html/body/head/etc..</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:27">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 05, 2010 08:21AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:27">comment:27</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>OK.</p><p>So, the reason that <code>q</code> appears on the surface to be special is because IE8 generates content. This is not immediately obvious in the above test-case because jsfiddle sets the content to "". That is not the same as setting the content to <code>none</code>, however, so the generated text nodes are still created. This makes <code>q</code> appear special but it is apparently not so much.</p><p>danheberden and I worked on this for a few hours, and the pattern seems to most closely match this description:</p><p>IE8 fails to return offsetWidth/Height properly for hidden elements whenever the element has inline siblings on both sides, or whenever the element is an only child and its parent has an inline next sibling. (Text nodes are apparently considered to be inline elements for the purposes of these decisions within Trident.)</p><p>I know what you are thinking—this sounds like a bug that one would expect to see from hasLayout—but forcing layout does not solve the problem, and the buggy elements are a mix of elements with and without layout. So, no luck there.</p><p>I think that the most important takeaway from this analysis is not the actual criteria under which IE8 screws up; rather, it is that the behaviour changes depending upon the existence or non-existence of ''generated content'', which means that it appears there is <strong>no way</strong> of 100% reliably detecting the conditions under which a specific hidden element may not correctly return offsetWidth/Height.</p><p>Testing for this condition is very easy, and I have written a patch to detect it. Unfortunately, once we know that offsetWidth/Height is unreliable, it looks like we’ll be forced to walk up the DOM every time someone wants to determine if an element is hidden in IE8. :(</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:28">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 05, 2010 09:34AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:28">comment:28</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-old">brandon</span> → <span class="change-field-new">snover</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:29">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 05, 2010 09:34AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:29">comment:29</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">assigned</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:30">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 05, 2010 08:30PM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:30">comment:30</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>need:</th>
                  <td>
                    
                      <span class="change-field-old">Patch</span> → <span class="change-field-new">Commit</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I would just like to mention that the final statement in my last comment was wrong; offsetWidth/Height are only wrong when the element itself has <code>display: none</code> set. If an ascendant is <code>display: none</code>, then offsetWidth/Height are still zero. Yay!</p><p><a href="http://github.com/jquery/jquery/pull/35" class="ext-link"><span class="icon"></span>Pull request</a></p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:31">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 09, 2010 03:54AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:31">comment:31</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/6895">#6895</a> is a duplicate of this bug.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:32">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 09, 2010 08:22PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:32">comment:32</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">assigned</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Landed <a href="http://github.com/jquery/jquery/pull/35" class="ext-link"><span class="icon"></span>http://github.com/jquery/jquery/pull/35</a></p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:33">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 09, 2010 08:22PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:33">comment:33</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">selector</span> → <span class="change-field-new">css</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:34">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 31, 2010 08:44AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:34">comment:34</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/5670">#5670</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:35">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 19, 2010 10:10AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:35">comment:35</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/5567">#5567</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
