<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#8046 ($().find() triggers DOMSubTreeModified events) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/8045/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/8047/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#8046</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened January 25, 2011 08:15AM UTC</p>
      
        <p>Closed January 25, 2011 01:55PM UTC</p>
      
      
        <p>Last modified March 13, 2012 06:29PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">$().find() triggers DOMSubTreeModified events</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        judson@lrdesign.com
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.next">1.next</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>selector</td>
      
        <th>Version:</th>
      
      <td>1.4.3</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I've been building a library to make packaging behaviors simple.  It works very well against jQuery 1.4.2.  However, the Sizzle included in 1.4.3 and 1.4.4 uses a technique to keep track of it's place in the DOM - it changes the id of nodes as it traverses.  In 1.4.3, it's about line 3904 of the unmini'd version.  </p><p>When the id changes (at least in Chrome) a DOMSubtreeModified event gets thrown.  The trouble is, I've attached a handler to the document for DSM events that needs to find the target Element - which triggers a DSM.  </p><p>Is it reasonable for $().find(selector) to trigger an event?</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (4)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 25, 2011 01:55PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">selector</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks for reporting this, but jQuery cannot provide support to deprecated specs (the mutation events).</p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 26, 2011 12:15AM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>That's incredibly disappointing, since there aren't satisfactory replacements for the <a href="/wiki/MutationEvent">MutationEvent</a> past the stage of industry proposals.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2011 01:47PM UTC by <span class="author">jitter</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:2 anonymous]:</p><blockquote> That's incredibly disappointing, since there aren't satisfactory replacements for the <a href="/wiki/MutationEvent">MutationEvent</a> past the stage of industry proposals.</blockquote><p>The reason <code>$(...).find()</code> modifies the id of an element is to fix some quirks with qSA. There have been some improvements since 1.4.3 and .find() for this specific logic. You might want to try out the current 1.5rc1 release which (depending on your selectors) might trigger less unwanted DSM events.</p><p>Personally I think it's not a good idea to rely on a deprecated specification, especially as this one isn't implemented cross-browser anyway nor completely in the browsers which do. So whatever you do is prone to work just in some browsers and for those probably only in specific versions.</p><p>Another thing I don't understand is, why you need to look for the target element when a DSM gets triggered?</p><pre class="wiki">
$("something").bind("DOMSubtreeModified", function( e ) {
  //e.target &lt;-- this should be what you are looking for
});
</pre><p>As a last resort I can propose this very hacky and slow workaround </p><pre class="wiki">
//this should stop DOMSubtreeModified events triggered by
//jQuery on "something" to bubble up to your DSM handler
//further up the tree
//clearly this comes at a high cost (bind/unbind)
$( "something" )
    .bind( "DOMSubtreeModified", function( e ) {
        e.stopImmediatePropagation();
    })
    .find( "someselector" )
    .unbind( "DOMSubtreeModified" );
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2011 08:26PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks very much for the reply - I've been considering tacks along these lines.</p><p>Replying to [comment:3 jitter]:</p><blockquote> The reason <code>$(...).find()</code> modifies the id of an element is to fix some quirks with qSA. There have been some improvements since 1.4.3 and .find() for this specific logic. You might want to try out the current 1.5rc1 release which (depending on your selectors) might trigger less unwanted DSM events. </blockquote><p>Yeah, I could see that was the purpose.  I didn't dig to far in, although I assume that something like setting a custom property on the Element itself wouldn't work, since you can't count on the browser to return the same object. (is that so?)</p><blockquote> Personally I think it's not a good idea to rely on a deprecated specification, especially as this one isn't implemented cross-browser anyway nor completely in the browsers which do. So whatever you do is prone to work just in some browsers and for those probably only in specific versions. </blockquote><p>DSM is part of a larger, admittedly hacky, solution that does it's best to cope with different browsers.  My lower bar here is something along the lines of:</p><pre class="wiki">
setInterval(250, function() {
  $(document).find(...).etc()
})
</pre><p>If I can't do better than that, I'll fall back to that position.  I've been doing pretty well so far :)</p><blockquote> Another thing I don't understand is, why you need to look for the target element when a DSM gets triggered?  <pre class="wiki">
&gt; $("something").bind("DOMSubtreeModified", function( e ) {
&gt;   //e.target &lt;-- this should be what you are looking for
&gt; });
&gt; </pre></blockquote><p>The trouble is that what I care about are nodes that have been inserted or modified such that they might match a selector - DSM is guaranteed not to target the node inserted, and isn't guaranteed to target anything closer than an ancestor.</p><p>I might be able to examine the event to find out what changes occurred, but that's a further reliance on a compliant implementation.</p><blockquote>  As a last resort I can propose this very hacky and slow workaround  </blockquote><p>I'm pretty sure I can do better than that.  I'm already handling and reducing an event queue to make sure that changes I make in response to a ME don't produce an infinite loop internally.  It's possible that I can either tighten that up, or change my handling so that I avoid using jQuery while the event is being processed.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
