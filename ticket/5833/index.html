<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#5833 (Greasemonkey &amp;quot;@require&amp;quot; error) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/5832/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/5834/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#5833</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(patchwelcome)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened January 15, 2010 10:40PM UTC</p>
      
        <p>Closed November 11, 2010 01:44AM UTC</p>
      
      
        <p>Last modified March 22, 2011 01:52PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Greasemonkey &quot;@require&quot; error</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        eegee
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/"></a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>misc</td>
      
        <th>Version:</th>
      
      <td>1.4.3</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>When including either "jquery-1.4.js" or "jquery-1.4.min.js" using the "@require" key in Greasemonkey v0.8.20091209.4 with Firefox v3.5.7 it reports the following error in Firebug v1.4.5 using the Development version of jQuery v1.4:</p><p>"Component is not available</p><p>file:///.../jquery-latestmin.js</p><p>Line 918"</p><p>(I have removed the directory location as it is irrelevant). It worked with with jQuery v1.3.5.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (2)</summary>

  <ul class="ticket-attachments">
    
      <li>
        <a href="/attachment/ticket/5833/jquery-1.4.1.js-event_detection.patch/index.html">jquery-1.4.1.js-event_detection.patch</a> (0.5 KB) - added by orderthruchaos
        <strong>February 05, 2010 04:49PM UTC</strong>.<br>
        <p>Patch that (potentially) fixes event support.</p>
      </li>
    
      <li>
        <a href="/attachment/ticket/5833/jquery-1.4.2.js.GMfix.diff/index.html">jquery-1.4.2.js.GMfix.diff</a> (1.0 KB) - added by koshi
        <strong>October 04, 2010 07:52PM UTC</strong>.<br>
        <p>Safe access to wrappedJSObject</p>
      </li>
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (16)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 15, 2010 10:42PM UTC by <span class="author">eegee</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>EDIT: I meant to say it worked with the latest jQuery v1.3.x</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 02, 2010 09:53PM UTC by <span class="author">cz</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This was introduced with the addition of eventSupported() used to determine support for onsubmit and onchange (for submitBubbles and changeBubbles).  First mention I can find of it is here:</p><p><a href="http://dev.jquery.com/ticket/5267" class="ext-link"><span class="icon"></span>http://dev.jquery.com/ticket/5267</a></p><p>Inside the eventSupported function, the created HTMLDivElement is wrapped with XPCNativeWrapper under Greasemonkey.. and blam, "Component is not available"</p><p>No more jQuery under Greasemonkey.  Verified with 1.4 and 1.4.1.  Last working revision under Greasemonkey is 1.3.2.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 05, 2010 04:57PM UTC by <span class="author">orderthruchaos</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I have added a patch which allows the div to be inspected by using the <a href="https://developer.mozilla.org/en/XPCNativeWrapper#Accessing_unsafe_properties" class="ext-link"><span class="icon"></span>.wrappedJSObject</a> property of the new div.  My only concern is security effects in Firefox versions before 3.  Starting in v3, this property returns a <a href="https://developer.mozilla.org/en/XPConnect_wrappers#XPCSafeJSObjectWrapper" class="ext-link"><span class="icon"></span>XPCSafeJSObjectWrapper</a>, which is meant to allow inspection of the object.</p><p>Note that this same problem may prevent jQuery 1.4+ from working under the Jetpack extension system.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 02, 2010 02:27PM UTC by <span class="author">orderthruchaos</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Actually the method in <a href="/ticket/6131">#6131</a> is probably safer.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 30, 2010 12:57PM UTC by <span class="author">cz</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The method in <a href="/ticket/6131">#6131</a> may be safer, but it doesn't actually keep the desired functionality.  There are a few working solutions in this thread: <a href="http://forum.jquery.com/topic/importing-jquery-1-4-1-into-greasemonkey-scripts-generates-an-error" class="ext-link"><span class="icon"></span>http://forum.jquery.com/topic/importing-jquery-1-4-1-into-greasemonkey-scripts-generates-an-error</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 15, 2010 01:46AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">support</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 04, 2010 08:23PM UTC by <span class="author">koshi</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>All proposed solutions in the forum thread are either unsafe or doesn't keep the desired functionality.</p><p>It is unsafe to access ANY property of wrappedJSObject. An attack is based on a malformed getter on a prototype property.</p><p>Firefox 4 (<a href="/wiki/JavaScript">JavaScript</a> 1.8.5) has introduced getOwnPropertyDescriptor and other methods which maybe can be useful for safe observation of properties. For now we can only check if property is "clean" (has no custom getter) and then access this property (does not invoke it but only check a property type).</p><p>Theoretically there is yet watch-based attack. But it seems like Firefox (tested on FF 3.6) does not call watcher on indirect property assignment (through attribute assignment). To be more safe the setAttribute called on the wrapper.</p><p>See jquery-1.4.2.js.GMfix.diff patch.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 18, 2010 11:54PM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">support</span> → <span class="change-field-new">misc</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-new">→ needsreview</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">1.4.1</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">major</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>version:</th>
                  <td>
                    
                      <span class="change-field-old">1.4</span> → <span class="change-field-new">1.4.3</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 11, 2010 01:44AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">needsreview</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ patchwelcome</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Perhaps some Greasemonkey devs can examine the patch or propose an alternate fix? Without close cooperation from Greasemonkey users we can't proceed.</p>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 14, 2010 04:06PM UTC by <span class="author">jerone</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>As version 1.4.4 still has problems with <a href="/wiki/GreaseMonkey">GreaseMonkey</a>, I uploaded a [[http://userscripts.org/scripts/show/90232|working <a href="/wiki/UserScript">UserScript</a>]] version of jQuery 1.4.4 with 2 fixes. Fixes are on line 575 to 577 and line 1112 to 1127 of the userscript.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 09, 2010 02:16PM UTC by <span class="author">yah.avatar@gmail.com</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Here's a working minified version of jQuery 1.4.4 for Greasemonkey:</p><p><a href="http://userscripts.org/scripts/review/92329" class="ext-link"><span class="icon"></span>http://userscripts.org/scripts/review/92329</a></p><p>Enjoy,</p><p>yah.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 16, 2010 10:10PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:10 jerone]:</p><blockquote> As version 1.4.4 still has problems with <a href="/wiki/GreaseMonkey">GreaseMonkey</a>, I uploaded a [[http://userscripts.org/scripts/show/90232|working <a href="/wiki/UserScript">UserScript</a>]] version of jQuery 1.4.4 with 2 fixes. Fixes are on line 575 to 577 and line 1112 to 1127 of the userscript.</blockquote><p>Sorry, it doesn't totally work. html.mozMatchesSelector somehow doesn't get detected correctly in Greasemonkey (jQuery assumes it works, but it doesn't give the right answer), which causes .is and .closest to not work (at least). And of course I was using those..</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 09, 2011 07:56PM UTC by <span class="author">jerone</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>For the records, jQuery 1.5 is compatible with <a href="/wiki/GreaseMonkey">GreaseMonkey</a> again.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 15, 2011 01:10PM UTC by <span class="author">eegee</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:13 jerone]:</p><blockquote> For the records, jQuery 1.5 is compatible with <a href="/wiki/GreaseMonkey">GreaseMonkey</a> again.</blockquote><p>Great, thanks for the update.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:15">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 07, 2011 10:44PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:15">comment:15</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:13 jerone]:</p><blockquote> For the records, jQuery 1.5 is compatible with <a href="/wiki/GreaseMonkey">GreaseMonkey</a> again.</blockquote><p>This is not the case. There are several functions that won't work with GM 0.9.1.</p><p>The problem still lies in mozMatchesSelector and eventSupported.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:16">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 22, 2011 01:52PM UTC by <span class="author">Kambfhase</span></span>
        <a class="ticket-change-link" href="#comment:16">comment:16</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Afaik the mozMatchesSelector problem only happens in Firefox 4. I filed a bug against Greasemonkey with a more general test case, because they might know a way to fix that: <a href="https://github.com/greasemonkey/greasemonkey/issues#issue/1300" class="ext-link"><span class="icon"></span>https://github.com/greasemonkey/greasemonkey/issues#issue/1300</a></p><p>Quickfix for jQuery: <a href="http://jsfiddle.net/JFsht/1/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/JFsht/1/</a></p><p>That little snippet makes jQuery.is() work correctly again.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
