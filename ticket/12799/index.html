<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#12799 (replaceWith fails when MIME is application/xhtml+xml) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/12798/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/12800/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#12799</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(notabug)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened October 29, 2012 07:45AM UTC</p>
      
        <p>Closed November 21, 2012 10:00PM UTC</p>
      
      
        <p>Last modified April 17, 2013 11:55PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">replaceWith fails when MIME is application/xhtml+xml</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        ndobrynin
      </td>
      <th>Owned by:</th>
      <td>ndobrynin</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        undecided
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>manipulation</td>
      
        <th>Version:</th>
      
      <td>1.8.2</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I needed to use replaceWith to perform a very simple task.  It didn't work, so I took the following demo posted on the website</p><p>&lt;!DOCTYPE html&gt;</p><p>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;</p><p>&lt;head&gt;</p><p>  &lt;script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"&gt;&lt;/script&gt;</p><p>&lt;/head&gt;</p><p>&lt;body&gt;</p><p>&lt;p&gt;Hello&lt;/p&gt;</p><p>&lt;p&gt;cruel&lt;/p&gt;</p><p>&lt;p&gt;World&lt;/p&gt;</p><p>&lt;script&gt;</p><p>jQuery("p").replaceWith( "&lt;b&gt;Paragraph. &lt;/b&gt;" );</p><p>&lt;/script&gt;</p><p>&lt;/body&gt;</p><p>&lt;/html&gt;</p><p>(The xmlns attribute was added by me).</p><p>It fails in Firefox 16.0.1 (Fedora) and Chromium 21.0.1180.89 (Fedora) <strong>when the content is served as application/xhtml+xml</strong>.  It also fails on the Firefox (not sure what version) I have on my Android phone.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (30)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2012 01:38PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">manipulation</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ ndobrynin</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks for taking the time to contribute to the jQuery project! Please provide a complete reduced test case on jsFiddle to help us assess your ticket.</p><p>Additionally, be sure to test against the jQuery Edge version to ensure the issue still exists. To get you started, use this boilerplate: <a href="http://jsfiddle.net/FrKyN/." class="ext-link"><span class="icon"></span>http://jsfiddle.net/FrKyN/.</a> Open the link and click to "Fork" (in the top menu) to get started.</p>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2012 06:33PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Please see <a href="http://jsfiddle.net/ndobrynin/Ygnu3/1/." class="ext-link"><span class="icon"></span>http://jsfiddle.net/ndobrynin/Ygnu3/1/.</a></p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 30, 2012 10:32PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This is tricky to repro. What error do you get from Chrome when you do this? Please report the error from the UNMINIFIED file.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 05, 2012 09:55PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I have not seen any errors in Chrome and FF alike.  Also, you can catch this</p><p>bug in action:</p><p><a href="http://horizontwenzel.de/html/test/test-unminified.xhtml" class="ext-link"><span class="icon"></span>http://horizontwenzel.de/html/test/test-unminified.xhtml</a></p><p><a href="http://horizontwenzel.de/html/test/test-unminified.html" class="ext-link"><span class="icon"></span>http://horizontwenzel.de/html/test/test-unminified.html</a></p><p><a href="http://horizontwenzel.de/html/test/test-minified.xhtml" class="ext-link"><span class="icon"></span>http://horizontwenzel.de/html/test/test-minified.xhtml</a></p><p><a href="http://horizontwenzel.de/html/test/test-minified.html" class="ext-link"><span class="icon"></span>http://horizontwenzel.de/html/test/test-minified.html</a></p><p>Minified or not makes absolutely no difference, as far as FF and Chrome</p><p>are concerned.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 05, 2012 10:17PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Just a quick follow up.  I am using the latest Fedora 17 on 64-bit AMD.</p><p>The bug also presents itself on Android 2.&lt;something&gt; with FF-17 beta.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 21, 2012 10:00PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ notabug</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>From the XHTML Strict DTD it looks like a <code>b</code> tag can't be below the body. </p><p><a href="http://www.w3.org/TR/xhtml1/dtds.html#a_dtd_XHTML-1.0-Strict" class="ext-link"><span class="icon"></span>http://www.w3.org/TR/xhtml1/dtds.html#a_dtd_XHTML-1.0-Strict</a></p><p>If you read otherwise please explain via a traversal of the DTD and I'll reopen. I suggest you switch to HTML5 doctype and avoid this nonsense.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 23, 2012 12:11AM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I am using HTML5.  I've updated the test case (see below), so it now has a div in place of the &lt;b&gt;, and the problem is still there.  </p><p>Technically, &lt;b&gt; is not supported in HTML5, but in the actual code I was doing something totally different, so the problem is not due to that.  The code below validates.</p><p>&lt;!DOCTYPE html&gt; &lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;</p><p>&lt;head&gt;</p><p>&lt;meta charset="utf-8"/&gt;</p><p>    &lt;script src="http://code.jquery.com/jquery-latest.js"&gt;&lt;/script&gt;</p><p>&lt;title&gt;replaceWith fails when MIME is application/xhtml+xml&lt;/title&gt;</p><p>&lt;/head&gt; &lt;body&gt; &lt;p&gt;Hello&lt;/p&gt;</p><p>&lt;script&gt; jQuery("p").replaceWith( "&lt;div&gt;Good buy&lt;/div&gt;" ); &lt;/script&gt;</p><p>&lt;/body&gt; &lt;/html&gt; </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 01:18PM UTC by <span class="author">adam.lakomy@outlook.com</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Hi, </p><p>it is still a bug. But its not visible on jsfiddle. </p><p>When you create a valid xhtml file like:</p><pre class="wiki">
&lt;?xml version="1.0" encoding="utf-8" standalone="no"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
  &lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"&gt;&lt;/script&gt;
  &lt;style type="text/css"&gt;
    button { display:block; margin:3px; color:red; width:200px; }
    div { color:red; border:2px solid blue; width:200px;
      margin:3px; text-align:center; }

  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
 
&lt;button&gt;First&lt;/button&gt;
&lt;button&gt;Second&lt;/button&gt;
&lt;button&gt;Third&lt;/button&gt;
 
&lt;script&gt;
$("button").click(function () {
  $(this).replaceWith( "&lt;div&gt;" + $(this).text() + "&lt;/div&gt;" );
});
&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;

</pre><p>its not working. On other hand when you change only a doctype to html valid it works perfectly.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 01:37PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Nope, that document isn't valid according to the W3C HTML Validator. A <code>button</code> element can't be directly below the body. </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 07:47PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Guys, I am requesting a reopen for this bug.  Thankfully, this still gets attention.</p><p>Many thanks,</p><p>Nickolai Dobrynin</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 07:53PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>You have not provided a valid test case yet, so it won't be reopened.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 08:12PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This is surprising.  The code I posted in comment 7 validates.  Am I missing something?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 08:22PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Not validating here: <a href="http://i.imgur.com/R4bqYI6.png" class="ext-link"><span class="icon"></span>http://i.imgur.com/R4bqYI6.png</a></p><p>In particular, <code>&lt;button&gt;</code> elements are not block elements and therefore can't be direct children of the <code>&lt;body&gt;</code>, just like I said in comment 6 above. </p><p>Please, please, PLEASE just use HTML5 and give up on XHTML if you aren't going to follow its stupid restrictive rules. Very few pages that are marked XHTML on the web are actually XHTML.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 09:07PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>PLEASE PLEASE PLEASE read carefully.  The button example is NOT the one I was talking about and was posted by a different person.  I referred to comment 7, *NOT* comment 8.</p><p>The code I posted in comment 7 does validate.</p><p>PS  Of course, button is not a block-level element.  And, of course, I've been using HTML5 throughout this entire bug report.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:15">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 09:17PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:15">comment:15</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@ndobrynin, your example seems to work for me. If you have a failing test case and it's not XHTML, please don't add to this ticket. Create a new one with a failing test case. I didn't see that your failed here:</p><p><a href="http://jsfiddle.net/5LdAa/1/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/5LdAa/1/</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:16">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 09:32PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:16">comment:16</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@methvin, are you sure you served it as application/xhtml+xml as opposed to text/html?  I have just re-tested it on FF-20 running on x86_64 Fedora-18 and Chromium 25.0.1364.172 and, sadly, got the same outcome.  It also fails on FF-20.0.1 on Android.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:17">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 09:43PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:17">comment:17</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Comment 7 says you are using HTML5 and uses an HTML5 doctype. So are you now saying you are serving that markup as XHTML? If you serve it as HTML5 does it work? If so is there a reason to not use HTML5 since the doctype says it's HTML5? What does the browser do with a document served as XML+XHTML that has a doctype that isn't XML+XHTML? Is there a reason to do that? </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:18">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 16, 2013 10:04PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:18">comment:18</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@methvin,</p><p>Answering point by point:</p><blockquote> So are you now saying you are serving that markup as XHTML?</blockquote><p>Yes, this was in the title of the original bug report.</p><blockquote> If you serve it as HTML5 does it work?</blockquote><p>Didn't really try, I admit.  This was outside the scope of the bug report.</p><blockquote> is there a reason to not use HTML5 since the doctype says it's HTML5?</blockquote><p>The &lt;!DOCTYPE html&gt; is common to both HTML5 and XHTML5.  The XHTML preamble (&lt;?xml version="1.0" encoding="UTF-8"?&gt;) is optional.  The reason I omit the preamble is that I also want to serve this to IE7+.</p><blockquote> What does the browser do with a document served as XML+XHTML that has a doctype that isn't XML+XHTML?</blockquote><p>It *is* XML+XHTML (see above).  No yellow screen of death here, if this is what you have in mind.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:19">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 01:35AM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:19">comment:19</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@methvin, unless you have further reservations, I am requesting that the bug be reopened.  I posted my comment 7 a long time ago, and I assumed you were satisfied.  I did not realize we had a misunderstanding going on.  Thx.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:20">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 02:08AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:20">comment:20</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Your document in comment 7 does does not validate as XHTML in the W3C XHTML Validator, it sees the document as HTML5 not XHTML due to the doctype. I can reopen this ticket if you can provide a test case that validates cleanly as XHTML in the W3C HTML Validator. </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:21">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 02:44AM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:21">comment:21</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <blockquote> W3C XHTML Validator, it sees the document as HTML5 not XHTML due to the doctype.</blockquote><p>Correct me if I am wrong: DOCTYPE has no significance when the document is XML+XHTML.  From <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-xhtml-syntax.html#writing-xhtml-documents" class="ext-link"><span class="icon"></span>http://www.whatwg.org/specs/web-apps/current-work/multipage/the-xhtml-syntax.html#writing-xhtml-documents</a> and <a href="http://en.wikipedia.org/wiki/Document_Type_Declaration" class="ext-link"><span class="icon"></span>http://en.wikipedia.org/wiki/Document_Type_Declaration</a></p><p>"XML documents may contain a DOCTYPE if desired, but this is not required to conform to this specification."</p><p>and</p><p>"The DOCTYPE is optional in XHTML5 and may simply be omitted. However, if the markup is to be processed as both XML and HTML, a DOCTYPE should be used."</p><p>What puzzles me is that the validator does not provide XHTML5 as a possible option for doctype.  Maybe because it's in preliminary stage.</p><p>Objections?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:22">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 02:54AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:22">comment:22</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>No objections at all. Just provide a test case that passes the W3C XHTML Validator. I don't think it's unreasonable to start there. </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:23">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 03:08AM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:23">comment:23</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>At present, the validator does not have that ability: it does not support XHTML5 validation, as per my previous post.  Otherwise how could it have deduced the doctype as HTML5 given the xml+xhtml mime type?</p><p>This is why the only choice is to look at the code and decide if it's valid, and if not, why not.  This is also why I am providing all these arguments.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:24">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 04:38AM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:24">comment:24</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I found a validator that does support XHTML5: <a href="http://html5.validator.nu/" class="ext-link"><span class="icon"></span>http://html5.validator.nu/</a></p><p>It does validate the document in question.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:25">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 04:04PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:25">comment:25</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Wow, so the validator doesn't catch scripts that aren't in CDATA blocks? Yet another reason to use HTML5 if you ask me.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:26">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 08:38PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:26">comment:26</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Is it fair to say that jQuery does not support XHTML5?  If so, it's worth mentioning on the website.  </p><p>Any discussion concerning XHTML5 and application/xhtml+xml will hit the same roadblock I hit.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:27">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 08:49PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:27">comment:27</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>What are you talking about? Your page isn't valid XHTML. The script isn't in a CDATA block.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:28">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 09:48PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:28">comment:28</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Yes, sir!  Placing it inside a CDATA block solves it, which is extremely helpful. Having said this, the supposedly invalid test in comment 7 was a well-formed XML document, and, according to</p><p><a href="https://developer.mozilla.org/en-US/docs/Writing_JavaScript_for_XHTML" class="ext-link"><span class="icon"></span>https://developer.mozilla.org/en-US/docs/Writing_JavaScript_for_XHTML</a></p><p>there is no requirement to enclose Javascript in XHTML, unless it's got special characters that break XML validity (e.g. if (i &lt; 10)), which was not the case here.  </p><p>Well, at least we now have a definitive solution.  For that I'm grateful.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:29">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 10:09PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:29">comment:29</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <blockquote> there is no requirement to enclose Javascript in XHTML, </blockquote><p>Right, you can take your chances and then spend a lot of yours and someone else's time trying to debug the problem instead of consistently using CDATA.</p><blockquote> unless it's got special characters that break XML validity (e.g. if (i &lt; 10)), which was not the case here. </blockquote><p>Yes it was. What's inside that <a href="/wiki/JavaScript">JavaScript</a> string that XHTML doesn't understand? Markup.</p><blockquote> Well, at least we now have a definitive solution.</blockquote><p>Not if you don't understand the problem.</p><p>If the problem isn't obvious still, don't use XHTML. It sure wasn't obvious TO ME for a while. I don't use XHTML and I am happier for it, except when people post bug reports like this and I remember then why XHTML is such a dumb idea.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:30">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2013 11:55PM UTC by <span class="author">ndobrynin</span></span>
        <a class="ticket-change-link" href="#comment:30">comment:30</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Very sorry, and I mean it, for wasting your time, which I probably did.  Hopefully, this will become yet another source people can refer to in the future.</p><p>For the problem you mentioned, it must have something to do with infinite recursion.  Trees (XHTML trees, in this particular case) are "naturally recursive", so replacing may never end UNLESS you cut it at the knees by putting CDATA around: no more self-referential data strucs.  By doing so, you mimic the old HTML (without X) behavior.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
