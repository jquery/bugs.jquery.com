<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#11483 (&amp;quot;current&amp;quot; context for add) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/11482/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/11484/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#11483</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">enhancement</span>
      <span class="ticket-resolution">(plugin)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened March 16, 2012 08:57PM UTC</p>
      
        <p>Closed April 04, 2012 06:57PM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">&quot;current&quot; context for add</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        gibson042
      </td>
      <th>Owned by:</th>
      <td>gibson042</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        undecided
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>unfiled</td>
      
        <th>Version:</th>
      
      <td>1.7.1</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p><code>add</code> is the only <a href="http://api.jquery.com/category/traversing/" class="ext-link"><span class="icon"></span>traversing</a> method that does not use "current set" as the context for selector arguments. It has a context parameter, but <code>$set.add( selector, context )</code> is identical to <code>$set.add( $( selector, context ) )</code> and requires breaking the chain for intermediate variable assignment.</p><p>We should special-case context=<code>true</code> to enable code like <code>$setAndNext = $set.add( "+ *", true )</code> or <code>$form.add(".invalid")</code>.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (8)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 16, 2012 08:58PM UTC by <span class="author">gibson042</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Err, that second example should be <code>$form.add( ".invalid", true )</code>.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 28, 2012 12:33PM UTC by <span class="author">gibson042</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Any thoughts before @trac-o-bot auto-closes this?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 28, 2012 01:44PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>It won't close since it's not "pending". It's worth discussion.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 04, 2012 01:12AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ gibson042</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>We've had some discussion about relative selectors, which always end up going through Sizzle's <a href="/wiki/JavaScript">JavaScript</a> path. Where would this feature simplify code? Are there some real-life examples?</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 04, 2012 04:51AM UTC by <span class="author">gibson042</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Good comments.</p><p>Regarding relative selectors, I doubt this enhancement would much increase their use, because anyone wanting to use <code>$set.add( strRelative, true )</code> is probably ''already'' using <code>$set.add( selRelative, $set )</code> or <code>$set.find( selRelative ).andSelf()</code>. But as an aside, isn't @timmywil's big Sizzle overhaul going to seriously improve the Javascript path for scoped queries anyway?</p><p>On to examples. <code>.and</code> and its derivative <code>.andSelf</code> seem to be fairly uncommon, but this new syntax would clarify many uses of the former (by eliminating otherwise unnecessary variable declarations) and most of the latter (by avoiding clunky re-adding).</p><ul><li><a href="http://api.jquery.com/andSelf/" class="ext-link"><span class="icon"></span>http://api.jquery.com/andSelf/</a>: <code>$("div").find("p").andSelf().addClass("border")</code> → <code>$("div").add( "p", true ).addClass("border")</code></li><li><a href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.js" class="ext-link"><span class="icon"></span>https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.js</a>: <code>uiDialogTitlebar.find("*").add(uiDialogTitlebar).disableSelection()</code> → <code>uiDialogTitlebar.add( "*", true ).disableSelection()</code></li><li><a href="http://stackoverflow.com/questions/3037382/jquery-this-selector-help" class="ext-link"><span class="icon"></span>http://stackoverflow.com/questions/3037382/jquery-this-selector-help</a>; <a href="http://stackoverflow.com/questions/2828019/looking-for-jquery-find-method-that-includes-the-current-node" class="ext-link"><span class="icon"></span>http://stackoverflow.com/questions/2828019/looking-for-jquery-find-method-that-includes-the-current-node</a>: <code>$set.find(selector).andSelf()</code> → <code>$set.add( selector, true )</code></li><li><a href="http://forum.jquery.com/topic/advanced-use-of-load-function" class="ext-link"><span class="icon"></span>http://forum.jquery.com/topic/advanced-use-of-load-function</a>; <a href="http://jsfiddle.net/2g8Yv/8/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/2g8Yv/8/</a>: <code>$set.filter(selector).add( $set.find(selector) )</code> → <code>$set.filter( selector ).add( selector, true )</code></li></ul>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 04, 2012 05:59PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>To me, the use of <code>.andSelf()</code> (perhaps renamed to <code>.addPrior()</code> per <a href="/ticket/9800">#9800</a>) is much clearer than using a second Boolean argument to <code>.add()</code>. Admittedly it's not as mystical as <code>.stop(true, true)</code> but the added method name makes it much clearer what is going on.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 04, 2012 06:45PM UTC by <span class="author">gibson042</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I agree, and in my opinion we'd be better off if <code>this</code> were the default context for <code>.add( selector )</code> rather than <code>null</code> (<code>document</code>), but that would be a breaking change.</p><p>Can you come up with a better special-case value (<code>null</code> and <code>undefined</code> are probably out, as are strings and user-defined objects—but perhaps a conveniently-mapped <code>true</code> like like <code>jQuery.CONTEXT_SELF</code>?) or (*shudder*) new method name, or is this ticket doomed to rejection by historical contingency?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 04, 2012 06:57PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ plugin</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I think it makes more sense to do this with <code>.addPrior()</code> or an <code>.addFind(selector)</code> plugin at this point, I'm not a fan at all of a magical second argument. If history were rewritten I agree it might make sense to have <code>.add()</code> use the set elements as context, since it's so easy to add rooted elements via <code>$()</code>. Perhaps we can add a time machine to the 1.9 roadmap.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
