<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#9381 (animations halt when the browser is out of focus due to requestAnimationFrame) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/9380/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/9382/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#9381</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(fixed)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened May 21, 2011 11:10PM UTC</p>
      
        <p>Closed August 16, 2011 03:22PM UTC</p>
      
      
        <p>Last modified March 10, 2013 10:51PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">animations halt when the browser is out of focus due to requestAnimationFrame</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        super@lynhurtig.dk
      </td>
      <th>Owned by:</th>
      <td>timmywil</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.6.3">1.6.3</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>effects</td>
      
        <th>Version:</th>
      
      <td>1.6.1</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>needsreview</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Hello,</p><p>I found a little nasty bug (:)) when using the fadeIn() and fadeOut() functions with setTimeout() (probably also a problem with setInterval()) and version 1.6.1 (and 1.6) in Chrome.</p><p>The problem is that all animations using fadeIn() and fadeOut() seem to be blocked when the browser window is minimized.</p><p>When it is reopened the animations fires rapidly until all have been executed, and it resumes to work normally.</p><p>I have created an example on jsfiddle.</p><p><a href="http://jsfiddle.net/9RNzC/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/9RNzC/</a></p><p>Just open it, minimize the browser window, wait for 10 seconds (etc - it changes every 3 second), and reopen it again, and it will fire the animation effects rapidly, like they have been blocked while minimized.</p><p>It works fine with version 1.5.2 so something have probably changed between 1.5.2 and 1.6 in the animate function.</p><p>Hope it helps.</p><p>Best regards</p><p>Martin</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (35)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 21, 2011 11:29PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">effects</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ gnarf</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">assigned</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I believe this is caused by requestAnimationFrame, which stops when the window is out of focus. </p><p>assigning to gnarf for assessment</p>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 22, 2011 12:04AM UTC by <span class="author">super@lynhurtig.dk</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Just noticed that i forgot to change the out commented code using the show() and hide() functions, when i tried to simplify the code.</p><p>I have just updated it, if you want to see that it works when using the show() and hide() functions (remember to out comment the code and comment out the fadeIn() and fadeOut() calls above()).</p><p><a href="http://jsfiddle.net/9RNzC/1/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/9RNzC/1/</a></p><p>It doesnt make a difference for the actual problem, just wanted to note it in case you were trying it out and wondered why it isnt working.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 24, 2011 06:47AM UTC by <span class="author">gnarf</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">gnarf</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">assigned</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Yeah, sadly because of the way that </p><pre class="wiki"> requestAnimationFrame() </pre> works (it does't give you any updates while the page isn't focused) this is exactly what will happen.<p></p><ul><li>unfocus tab</li><li>You queue an animation....</li><li>No animation frames are given, so you queue another animation, etc, etc</li><li>focus tab</li><li>Animation Frame is given, you finally get the second frame of the first animation</li><li>First animation Completes, second starts</li><li>The rest of your queue plays out.</li></ul><p>To avoid: Don't use setTimeout() like that directly, instead use the callback of one of the animations to setTimeout for the next transition...  Or you could use the queue itself...</p><p>Either of these solutions will work around the issue:</p><pre class="wiki">
elem.fadeIn(1000, function() {
    setTimeout( nextCycle, 2000 );
});
// or....
elem.fadeIn(1000).delay(2000).queue(function( next ) {
    // tell the cycler to move on
    nextCycle();
    // then call the next queue function
    next();
});
</pre><p>I don't see any way that we can avoid the "huge queue playback" of an animation like this that doesn't expect "stalling" time when the window isn't focused.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 24, 2011 04:22PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/9411">#9411</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 24, 2011 04:25PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-new">→ needsdocs</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>gnarf's suggestion is really what should happen instead.  I think we should document this behavior and leave it as is.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 24, 2011 05:31PM UTC by <span class="author">gnarf</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="http://api.jquery.com/animate/" class="ext-link"><span class="icon"></span>http://api.jquery.com/animate/</a> -- Added the following note to the animation functions:</p><p>Because of the nature of requestAnimationFrame(), you should never queue animations using a setInterval or setTimeout loop. In order to preserve CPU resources, browsers that support requestAnimationFrame will not update animations when the window/tab is not displayed. If you continue to queue animations via setInterval or setTimeout while animation is paused, all of the queued animations will begin playing when the window/tab regains focus. To avoid this potential problem, use the callback of your last animation in the loop to set a timeout to start the next animation.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 24, 2011 05:54PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">needsdocs</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 24, 2011 11:00PM UTC by <span class="author">Martin</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>If it is possible for you somehow, it would be great if you could let some of all the major plugin makers know about this, because this will break a whole lot of plugins.</p><p>When making my plugin which just cycles between elements and fade them in and out, i looked at other plugins, and as far as i remember all of them will break because of this.</p><p>Why not go back to how it was before ? </p><p>It worked fine, and how you would expect it to work. Now with then new version you have to do some kind of "hack" to make it play nice with jQuery.</p><p>Any way, great work with jQuery, it is really great. :)</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 25, 2011 11:09AM UTC by <span class="author">gnarf</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Good way to work around this issue is to disable repeating animations using window.onfocus and window.onblur. By doing so animationts are not stacked together when the browser gets minimized or another tab is active.&#92;
Example:&#92;
function windowActive() { focus = true; }&#92;
function windowInactive() { focus = false; }&#92;
window.onfocus = windowActive;&#92;
window.onblur = windowInactive;&#92;
&#92;
var animation = function(){&#92;
 if(focus){&#92;
  //code&#92;
 }&#92;
}&#92;
</span> → <span class="change-field-new">1306445589124644</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Good way to work around this issue is to disable repeating animations using window.onfocus and window.onblur. By doing so animationts are not stacked together when the browser gets minimized or another tab is active.</p><p>Example:</p><pre class="wiki">
function windowActive() { focus = true; }
function windowInactive() { focus = false; }
window.onfocus = windowActive;
window.onblur = windowInactive;

var animation = function(){
 if(focus){
  //code
 }
}
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 25, 2011 03:29PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Adam: That is not a good solution because it will stop the animation even if the user is able to see the window. You could have 2 windows (or more) running side by side but without having focus.</p><p>Wasnt it one of the ideas behind jQuery in the first place that you shouldnt have to do "hacks" and write browser specific code to make it work ?</p><p>I dont want to mix my transition logic with my "autoplay" (cycle) logic as they are seperate things and dont belong together.</p><p>The animation logic should also work when not set to automatically cycle between elements, so user can just click the element they want to go to.</p><p>The work arounds suggested earlier is not great.</p><p>I much prefer it working like expected without having to do hacks to make jQuery play nice. It was working fine with older versions, so it should be possible.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 25, 2011 04:04PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>currently to fix the problem i have just implemented a varaible (ready) containing the state.</p><p>So before i do an animation I set it to false, and at the end of the animation (using the callback) i set it to true.</p><p>In the autoplay function i just check the ready variable, and only call the animation method if true.</p><p>Then the animations doesnt stack up, as the autoplay stops calling when animations start to not get executed.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 26, 2011 01:32PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I had similar problem with animate function, and it took me quite a while to repeair the whole slideshow application, I've created, which broke after moving to the latest release of jQuery. It's quite serious bug in my opinion since, most "autocycle" applications will stop to work properly in chrome. I am wondering why it was classified as low priority bug and closed with wontfix flag?!</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 26, 2011 02:32PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-new">→ needsreview</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">closed</span> → <span class="change-field-new">reopened</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This has been closed as wontfix because really the choice here is we can nix requestAnimationFrame and go back to setInterval for all browsers and miss out on the performance/smoothness advantages or document that users should use callbacks instead of stacking animations blindly.  If this is a problem for enough people, we will probably have to switch back to setInterval or find some glorious hack that fixes this bug without too much code and keeps requestAnimationFrame, but I cannot think of a viable solution.</p>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 26, 2011 02:32PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">reopened</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:15">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 26, 2011 09:33PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:15">comment:15</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I think the writing is on the wall; it seems more likely that the other vendors will follow Chrome than for Chrome to revert this behavior. By not doing  <code>requestAnimationFrame</code> animations when a user cannot see them, the browser is saving CPU time -- and more importantly, battery life in mobile devices.</p><p>timmywil is right that "blindly stacking animations" is a bad idea. For example if you want to show a slide for 10 seconds, have the callback for the completion of showing of the slide set a timeout for 10 seconds or use <code>.queue()</code> to queue the timeout. Don't have some unrelated code just blindly set a 10-second timeout and force a transition regardless. If the user minimized your slide show, they HAVE NOT SEEN THE SLIDES. </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:16">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 26, 2011 09:40PM UTC by <span class="author">gnarf</span></span>
        <a class="ticket-change-link" href="#comment:16">comment:16</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">Replying to [comment:10 anonymous]:&#92;
&gt; Adam: That is not a good solution because it will stop the animation even if the user is able to see the window. You could have 2 windows (or more) running side by side but without having focus.&#92;
&#92;
I agree, this is the wrong way to solve the problem.&#92;
&#92;
&gt; Wasnt it one of the ideas behind jQuery in the first place that you shouldnt have to do &quot;hacks&quot; and write browser specific code to make it work ?&#92;
&#92;
I&#39;m not sure how any of this constitutes a need to write a &quot;hack&quot; to support a browser.  You are instead updating your code to support new versions of jQuery and the improved handling of animation timers that will save your laptops battery life when you tab out of that cycling page...&#92;
&#92;
&gt; I dont want to mix my transition logic with my &quot;autoplay&quot; (cycle) logic as they are seperate things and dont belong together.&#92;
&gt; The animation logic should also work when not set to automatically cycle between elements, so user can just click the element they want to go to.&#92;
&#92;
So, I fail to see how this is a problem... Make your &quot;animation&quot; function accept a callback that gets passed along to the actual {{{.animate()}}} - problem solved.  The situations where you don&#39;t care about getting a callback are still fine, because your &quot;complete&quot; callback will be undefined:&#92;
&#92;
{{{&#92;
&#92;
function animateElementIn( in, done ) {&#92;
   // assuming current is already set somewhere...&#92;
   current.fadeOut( 1000 );&#92;
   in.fadeIn( 1000, done );&#92;
}&#92;
&#92;
function loopyCycler() {&#92;
    animateElementIn( next, function() {&#92;
        setTimeout( loopyCycler, 2000 );&#92;
    });&#92;
}&#92;
}}}&#92;
&#92;
&gt; The work arounds suggested earlier is not great.&#92;
&#92;
Explain any issues with my earlier examples, and I might take the time to write a better work around for your specific needs.  Oh, and personally, I think using {{{setTimeout}}} or {{{setInterval}}} to queue &quot;cycles&quot; is &quot;not great&quot;...</span> → <span class="change-field-new">1306446215484579</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:10 anonymous]:</p><blockquote> Adam: That is not a good solution because it will stop the animation even if the user is able to see the window. You could have 2 windows (or more) running side by side but without having focus.</blockquote><p>I agree, this is the wrong way to solve the problem.</p><blockquote> Wasnt it one of the ideas behind jQuery in the first place that you shouldnt have to do "hacks" and write browser specific code to make it work ?</blockquote><p>I'm not sure how any of this constitutes a need to write a "hack" to support a browser.  You are instead updating your code to support new versions of jQuery and the improved handling of animation timers that will save your laptops battery life when you tab out of that cycling page...</p><blockquote> I dont want to mix my transition logic with my "autoplay" (cycle) logic as they are seperate things and dont belong together. The animation logic should also work when not set to automatically cycle between elements, so user can just click the element they want to go to.</blockquote><p>So, I fail to see how this is a problem... Make your "animation" function accept a callback that gets passed along to the actual </p><pre class="wiki">.animate()</pre> - problem solved.  The situations where you don't care about getting a callback are still fine, because your "complete" callback will be undefined:<p></p><pre class="wiki">

function animateElementIn( in, done ) {
   // assuming current is already set somewhere...
   current.fadeOut( 1000 );
   in.fadeIn( 1000, done );
}

function loopyCycler() {
    animateElementIn( next, function() {
        setTimeout( loopyCycler, 2000 );
    });
}
</pre><blockquote> The work arounds suggested earlier is not great.</blockquote><p>Explain any issues with my earlier examples, and I might take the time to write a better work around for your specific needs.  Oh, and personally, I think using </p><pre class="wiki">setTimeout</pre> or <pre class="wiki">setInterval</pre> to queue "cycles" is "not great" you should have been using the <pre class="wiki">.animate()</pre> callback or <pre class="wiki">.queue()</pre> in the first place...<p></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:17">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 29, 2011 06:13AM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:17">comment:17</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>In some applications the problem is really serious.</p><p>Using a callback function as a workaround is nice for a simple predefined things, but that is not always possible.</p><p>For example, if you have a game application where there are a lot of timeouts and intervals based on previous user input and game state. Using animations instead of timers? That's crazy.</p><p>A nice solution is to drop animations at all in inactive state.</p><p>But how to easily define if the state is inactive and animation won't play?</p><p>I suggest adding some property/function to determine that.</p><p>To make it possible things like</p><pre class="wiki">
if(IsAnimationsRunning) $(something).animate(...); else $(something).clearQueue();
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:18">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 30, 2011 01:28PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:18">comment:18</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>summary:</th>
                  <td>
                    
                      <span class="change-field-old">setTimeout and fadeIn/fadeOut blocking in Chrome</span> → <span class="change-field-new">animations halt when the browser is out of focus due to requestAnimationFrame</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:19">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 30, 2011 01:30PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:19">comment:19</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/9711">#9711</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:20">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 14, 2011 02:40PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:20">comment:20</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/9825">#9825</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:21">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 15, 2011 11:12PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:21">comment:21</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This is an additional approach to managing things that might happen when the window has lost focus: </p><p><a href="http://jsfiddle.net/rwaldron/KK5mP/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/rwaldron/KK5mP/</a></p><p>based on a request in -dev</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:22">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 16, 2011 09:15PM UTC by <span class="author">gnarf</span></span>
        <a class="ticket-change-link" href="#comment:22">comment:22</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="https://github.com/jquery/jquery/pull/436" class="ext-link"><span class="icon"></span>https://github.com/jquery/jquery/pull/436</a> - Pull request to implement a way to disable rAF and revert to setInterval always.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:23">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 18, 2011 02:07PM UTC by <span class="author">gnarf</span></span>
        <a class="ticket-change-link" href="#comment:23">comment:23</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="https://github.com/gnarf37/jquery/compare/jquery:master...ticket_9381_2" class="ext-link"><span class="icon"></span>https://github.com/gnarf37/jquery/compare/jquery:master...ticket_9381_2</a> - Here is yet another possible solution to the problem inspired by a jaubourg comment in -dev.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:24">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 20, 2011 12:26AM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:24">comment:24</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/9865">#9865</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:25">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 22, 2011 03:28PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:25">comment:25</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I not sure, just a jquery n00b but I had this problem in google chrome when opening another tab. When returning to that tab the animations ran wild. Just stumbled on to this tip: <a href="http://www.learningjquery.com/2009/01/quick-tip-prevent-animation-queue-buildup" class="ext-link"><span class="icon"></span>http://www.learningjquery.com/2009/01/quick-tip-prevent-animation-queue-buildup</a></p><p>seems simply adding the .stop() solves all problems, at least for me it did, in two completly different animation scripts even. Just my 2 cents.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:26">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 25, 2011 04:54PM UTC by <span class="author">lrbabe</span></span>
        <a class="ticket-change-link" href="#comment:26">comment:26</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'd like to give this bug a try as well.</p><p>I know of a better solution to prevent this behavior and would like to see if it can be applied here.</p><p>louisremi</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:27">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 26, 2011 02:04PM UTC by <span class="author">lrbabe</span></span>
        <a class="ticket-change-link" href="#comment:27">comment:27</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>PR is here: <a href="https://github.com/jquery/jquery/pull/446" class="ext-link"><span class="icon"></span>https://github.com/jquery/jquery/pull/446</a></p><p>Animation frameworks have to deal with the problems that occur when requestAnimationFrame powers the animation loop and the tab loses focus. The general idea is to artificially limit the interval between two animation ticks.</p><p>This was illustrated in Seth Ladd's "Intro to HTML5 Game Development" during Google I/O 2011: <a href="http://io-2011-html5-games-hr.appspot.com/#36" class="ext-link"><span class="icon"></span>http://io-2011-html5-games-hr.appspot.com/#36</a></p><p>He calculates the time delta between two animation ticks and limit this value to 60ms</p><pre class="wiki">var dT = Math.min( now - prevNow, 60 );</pre><p>The way jQuery animations work is more complex than Seth's ones, as animations aren't based on the time delta between the previous tick and the current one, but between the beginning of the animation (startTime) and the current one. The only way to limit the interval between two ticks is to move the value of startTime forward in time.</p><p>With this 5loc patch, jQuery detects when the interval takes longer than usual and moves startTime accordingly to effectively pause the animation. Once the tab is focused again, the animation continues where it stopped.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:28">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 02, 2011 01:59PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:28">comment:28</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/9957">#9957</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:29">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 15, 2011 04:27PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:29">comment:29</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>We've discussed the raf issue in the monday meeting and have decided to remove raf until it is both fleshed out further by all of the browser vendors and we have reliable solutions to the problems that come with supporting a requestAnimationFrame animate.  This does not rule out the possibility of it's eventual permanent inclusion into jQuery's animate in either 1.7, or possibly 1.8, but we unknowingly opened up a can of worms by adding this too soon and we need to clear the detritus.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:30">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 15, 2011 04:30PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:30">comment:30</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ timmywil</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">assigned</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:31">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 15, 2011 04:30PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:31">comment:31</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.next</span> → <span class="change-field-new">1.6.3</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:32">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 16, 2011 03:22PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:32">comment:32</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">assigned</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Remove requestAnimationFrame support. Fixes <a href="/ticket/9381">#9381</a>. </p><p> Changeset: 2053d1c621e8ef65b79d6b339d7336c732ed1b82</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:33">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 14, 2011 11:34PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:33">comment:33</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/10281">#10281</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:34">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 10, 2013 09:47AM UTC by <span class="author">mathias</span></span>
        <a class="ticket-change-link" href="#comment:34">comment:34</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Could this be a solution?</p><p>Using a plugin like <a href="https://github.com/mathiasbynens/jquery-visibility" class="ext-link"><span class="icon"></span>https://github.com/mathiasbynens/jquery-visibility</a> you could disable any animations while the window/tab isn’t focused, and re-enable them as soon as the window gains focus again. (The plugin uses the Page Visibility API and falls back to good old <code>focus</code> and <code>blur</code> in older browsers.)</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:35">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 10, 2013 10:51PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:35">comment:35</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Let's not tag new discussions onto long-closed tickets.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
