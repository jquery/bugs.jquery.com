<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#2196 (Coords returned by offset method are false in a specific context with firefox) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/2195/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/2197/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#2196</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(wontfix)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened January 20, 2008 08:39AM UTC</p>
      
        <p>Closed March 17, 2009 09:25PM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">Coords returned by offset method are false in a specific context with firefox</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        djwo
      </td>
      <th>Owned by:</th>
      <td>brandon</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        minor
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.2.3">1.2.3</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>offset</td>
      
        <th>Version:</th>
      
      <td>1.2.2</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>offset coords jquery</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Hello,</p><p>I've just discovered a bug with the offset method included in jQuery 1.2.1.</p><p>The coords returned by the offset methods are false with Mozilla Firefox if both TABLE element with a CAPTION element are used,  AND if the CSS property « position : relative » has been applied to the TABLE element.</p><p>I am not a jQuery user but I like to analyse code from experts when I am in front of a difficulty. So, after many search, I have added this line of code for jQuery works (line 2950) :</p><pre class="wiki">
// Mozilla doesn't take care of CAPTION element in offsetHeight =&gt; added manually
if (offsetParent.tagName == 'TABLE' && offsetParent.getElementsByTagName('CAPTION').length == 1 && jQuery.css(offsetParent, 'position').toLowerCase() == 'relative') {
    add(0, offsetParent.getElementsByTagName('CAPTION')[0].offsetHeight);
}
</pre><p>And the code used to reproduce the bug :</p><pre class="wiki">
&lt;!DOCTYPE html SYSTEM "https://ov/netCFARegion/dtd/xhtml1-strict.dtd"&gt;
  &lt;style type="text/css"&gt;table {position : relative;}&lt;/style&gt;
  &lt;script type="text/javascript" src="jquery-1.2.1.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript"&gt;
/**
 * Fonction de débuggage à l'écran.
 * Mettre str='clear' pour effacer la zone de debug.
 * 
 * @param sting str
 */
function write(str) {
    myDiv = document.createElement('DIV');
    myDiv.innerHTML = str;
    
    debugBlock = document.getElementById('debug');
    
    if (!debugBlock ) {
        debugBlock = document.createElement('DIV');
        debugBlock.id = 'debug';
        
        with (debugBlock.style) {
            position = 'absolute';right = '5px';top = '5px';padding = '3px';
            width = "350px";minHeight = "150px";border = "1px solid #525D73";
            backgroundColor = "#DEEBF9";
        }
        
        document.getElementsByTagName('BODY')[0].appendChild(debugBlock);
    }
    
    nbDiv = debugBlock.getElementsByTagName('DIV').length;
    
    if (nbDiv % 2 == 0) myDiv.style.backgroundColor = '#BDD3EF';
    
    if (str == 'clear') debugBlock.innerHTML = '';
    else                debugBlock.appendChild(myDiv);
}

function getPos() {
    
    coords = $('#test').offset();
    
    var elt = document.createElement('DIV');
    elt.style.width    = '14px';
    elt.style.height   = '14px';
    elt.style.border   = '1px solid red';
    elt.style.position = 'absolute';
    elt.style.top      = coords.top + 'px';
    elt.style.left     = coords.left + 'px';
    
    document.getElementsByTagName('BODY')[0].appendChild(elt);
    
    write('top='  + coords.top);
    write('left=' + coords.left);
}

&lt;/script&gt;
&lt;/head&gt;

&lt;body onload="getPos()"&gt;

&lt;table class="classical"&gt;
  &lt;caption&gt;Caption&lt;/caption&gt;
    &lt;tr&gt;
      &lt;td id="test" style="border:1px solid blue"&gt;content&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;

&lt;/body&gt;
&lt;/html&gt;
&lt;/code&gt;
</pre><p>Tested with : </p><p>OS : Windows XP</p><p>Firefox : Mozilla/5.0 (Windows; U; Windows NT 5.1; fr; rv:1.8.1.11) Gecko/20071127 Firefox/2.0.0.11</p><p>I am sincerly sorry for my poor english, it's very difficult for me to explain the bug. I made a post on this with a lot of expanations on my website (<a href="http://www.miasmatech.net)" class="ext-link"><span class="icon"></span>http://www.miasmatech.net)</a> but this is in french. If you can understand french...</p><p>Congratulations for your job and greatings from french</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (1)</summary>

  <ul class="ticket-attachments">
    
      <li>
        <a href="/attachment/ticket/2196/jQuery.zip/index.html">jQuery.zip</a> (24.7 KB) - added by djwo
        <strong>January 20, 2008 08:40AM UTC</strong>.<br>
        <p>test case and correction included</p>
      </li>
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (2)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 21, 2008 04:49AM UTC by <span class="author">djwo</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Ooops... I'm sorry, I forget to put the CSS "position:relative" in the example. The table is formated like this :</p><pre class="wiki">
&lt;table style="position:relative"&gt;
  &lt;caption&gt;Caption&lt;/caption&gt;
    &lt;tr&gt;
      &lt;td id="test" style="border:1px solid blue"&gt;content&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 17, 2009 09:25PM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ wontfix</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This is to much of an edge case right now to incur the overhead within the core offset method. The simple workaround is to just include the height of the caption with the offset when in this situation.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
