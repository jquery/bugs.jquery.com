<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#10824 (jQuery.ajax ($.ajax) and its memory leaking) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/10823/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/10825/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#10824</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened November 18, 2011 11:46AM UTC</p>
      
        <p>Closed December 20, 2011 07:50AM UTC</p>
      
      
        <p>Last modified March 14, 2012 10:30AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">jQuery.ajax ($.ajax) and its memory leaking</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        fabbios
      </td>
      <th>Owned by:</th>
      <td>fabbios</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ajax</td>
      
        <th>Version:</th>
      
      <td>1.4.2</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I faced a serius problem with an application suffering of memory leaking. After almost get crazy I could isolate the problem and I figured out the problem was the jQuery.ajax.</p><p>All my pain I posted in here (<a href="http://stackoverflow.com/questions/8158739/ie-memory-leak-and-eval-with-jquery/8176724#8176724)." class="ext-link"><span class="icon"></span>http://stackoverflow.com/questions/8158739/ie-memory-leak-and-eval-with-jquery/8176724#8176724).</a></p><p>I'm using in my application jQuery.ajax, which is called in a regular basis (like every 10 seconds), but after each iteration some memory wasn't being released, it reaches until 1GB of memory usage, to solve it I did this:</p><p>var request = $.ajax({ .... });</p><p>When finished the request:</p><p> request.onreadystatechange = null;  </p><p> request.abort = null;  </p><p> request = null;</p><p>jQuery.ajax doesn’t do that and the memory never releases. It solves my problem and I found a lot of people with the same issue.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (11)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 18, 2011 02:51PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ fabbios</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Version 1.4.2 is nearing its second birthday. We only maintain the most recent release. Can you reproduce this in jQuery 1.7?</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 19, 2011 07:41AM UTC by <span class="author">cbr@nicelooking.de</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I can confirm this. Its also in 1.7.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 19, 2011 01:56PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Can you provide a test case?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 19, 2011 04:09PM UTC by <span class="author">cbr@nicelooking.de</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I got following scenario:</p><p>I had to deliver preloaded pages, so i build three frames.</p><p>1. Frame: controlscript with the ajax request</p><p>2. Frame: to preload the page of next request</p><p>3. Frame: to display the cached page from Frame 2</p><p>The controlscript at frame1 asks the masterscript about the next page-url to display and the duration of showing. It loads the page into frame2 because of caching. If the page at frame2 is loaded (jquery event document.ready), it will change the document.href of frame 3 to the document.href of frame 2.</p><p>Following code i've done and rises the memory usage at every request:</p><p>&lt;script&gt;</p><p>f_preload = parent.preload.document;</p><p>f_preload.location.href = 'URI_OF_FIRST_PAGE';</p><p>var dauer = 10;</p><p>var intID;</p><p>$(document).ready(function(){</p><p>     intID = setInterval(Seitenwechsel, 1000);</p><p>});</p><p>var Seitenwechsel = function() {</p><p>  var f_content = window.parent.content.document;</p><p>  var f_preload = window.parent.preload.document;</p><p>  if (f_content.location.href == f_preload.location.href)</p><p>  {</p><p>    dauer--;</p><p>    if (dauer &lt; 0)</p><p>    {</p><p>      clearInterval(intID);</p><p>       $.get("/URL_TO_MASTERSCRIPT.php", { someValues: "value"}, function(data) {</p><p>       <em> check if answer is okay</em></p><p>       nextparams = data.split(" ");</p><p>       if (nextparams[2] != "OK") {dauer=2; intID = setInterval(Seitenwechsel, 1000);}</p><p>       dauer = nextparams[1];</p><p>       f_preload = parent.preload.document;</p><p>       f_preload.location.href = nextparams[0] + "?" + Math.round(Math.random() * 999999999999);</p><p>       intID = setInterval(Seitenwechsel, 1000);</p><p>      })</p><p>      .error(function() { dauer=2; intID = setInterval(Seitenwechsel, 1000); }) ran into error, check frequently now to get a good answer</p><p>    }</p><p>  }</p><p>}</p><p>&lt;/script&gt;</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 19, 2011 05:53PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">ajax</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks for taking the time to contribute to the jQuery project! Please provide a working reduced test case to help us assess your ticket.</p><p>Additionally, be sure to test against the jQuery Git version to ensure the issue still exists.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 22, 2011 06:03PM UTC by <span class="author">fabbios</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Also I'm confirming it's leaking in 1.7</p><p>I've noticed that it leaks less memory than in 1.4.2, but it's just feeling I didn't perform any deep test. </p><p>This is exactly I what have in my code:</p><pre class="wiki">
var interval;
function setupdaterate(rate) {
   interval = setInterval(updateitems, rate * 1000);
}


function updateitems() {
    
        $('.updatable').each(function () {
            var data = 'varTest=12';

            var request = $.ajax({
                async: true,
                url: '/url.ashx',
                data: data,
                type: 'POST',
                timeout: 10000,
                success: function (data) {
                    //update some IU component here.
                }
            });

            data = null;

            //HERE IS THE HACK! :)
            request.onreadystatechange = null;
            request.abort = null;
            request = null;
        });
    
}
</pre>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 28, 2011 09:01PM UTC by <span class="author">sindresorhus</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Please read the text in the red box:</p><blockquote> Please follow the  bug reporting guidlines and use  jsFiddle when providing test cases and demonstrations instead of pasting the code in the ticket.</blockquote>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 28, 2011 09:06PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>It would help us to have a small test case that can reproduce the issue.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 29, 2011 01:09PM UTC by <span class="author">Jonas L</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>"request.onreadystatechange = null;</p><p> request.abort = null;</p><p> request = null;"</p><p>This is the same fix I reported for 1.4.2 over a year ago. It looks like as long IE has anything assigned to a callback it will not release the memory for the ajax object.</p><p>/Jonas</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 06, 2011 06:36AM UTC by <span class="author">Kei Oikawa</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I noticed that $.ajax() involves memory leaks in IE6(SP3) and IE8 when it is used from other frame.</p><p>This thread really helps me. The solution in this thread works perfectly. I really appreciate it.</p><p>Situation is like this:</p><p> 1) We have two frames.</p><p> 2) jQuery(v1.6.2) is loaded in the parent frame.</p><p> 3) Our application run in one of the frames and uses parent jQuery.</p><p> 4) When the application uses $.ajax() to get JSON file, it leaks! </p><p>Apparently, using jQuery $.ajax function from different frame seems to be a bad habit for IE</p><p>because when I tried to remove jQuery in the parent frame and put it in the application frame(child frame, in other word) instead,</p><p>the problem was gone completely. But in terms of saving memory consumption, I wanted like to load</p><p>jQuery library in the parent frame and share it in the child frames.</p><p>When this situation happens, nullifying the return value of $.ajax() just stated above works perfectly.</p><p>In addition to that, it seems sometimes IE6 does not release memory even if the returned XHR object is set to be null.</p><p>So, I suggest to set "noop" function(empty function) instead of using setting null. I hope this information helps for all users in the same trouble.</p><pre class="wiki">
var noop = function(){}; // function doing nothing

var $req = $.ajax( ... ); // ajax processing

// Clean XHR object up
if( $req != null ){
    $req.onreadystatechange = $req.abort = noop;
        $req = null;        
}
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 20, 2011 07:50AM UTC by <span class="author">trac-o-bot</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Because we get so many tickets, we often need to return them to the initial reporter for more information. If that person does not reply within 14 days, the ticket will automatically be closed, and that has happened in this case. If you still are interested in pursuing this issue, feel free to add a comment with the requested information and we will be happy to reopen the ticket if it is still valid. Thanks!</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
