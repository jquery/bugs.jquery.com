<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#7784 ($(str) is failing when str is an entire html document) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/7783/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/7785/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#7784</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(duplicate)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened December 15, 2010 03:46AM UTC</p>
      
        <p>Closed December 15, 2010 08:18PM UTC</p>
      
      
        <p>Last modified December 15, 2010 08:19PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">$(str) is failing when str is an entire html document</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        cowboy
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        undecided
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.6">1.6</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>unfiled</td>
      
        <th>Version:</th>
      
      <td>1.4.4</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Go to jquery.com, and enter this into the console. You'll see that while the html string is being logged, <code>$(html)</code> is not acting as expected, stripping the <code>html</code>, <code>head</code> and <code>body</code> tags and flattening the structure somewhat. As a result, <code>$(html).find('body')</code> returns nothing!</p><pre class="wiki">
$.get( '/', function( html ){
  console.log( html ); // full html string, as-expected
  console.log( $(html) ); // html, head, body removed?
  console.log( $(html).find('body') ); // nothing ?!
});
</pre><p>Another example for the jquery.com console:</p><pre class="wiki">
$('&lt;div/&gt;').load( '/', function(){
  console.log( this );
});
</pre><p>logs this:</p><pre class="wiki">
&lt;div&gt;​
  &lt;meta http-equiv=​"content-type" content=​"text/​html;​ charset=utf-8"&gt;​
  &lt;title&gt;​jQuery: The Write Less, Do More, JavaScript Library​&lt;/title&gt;​
  &lt;link rel=​"stylesheet" href=​"http:​/​/​static.jquery.com/​files/​rocker/​css/​reset.css" type=​"text/​css"&gt;​
  &lt;link rel=​"stylesheet" href=​"http:​/​/​static.jquery.com/​files/​rocker/​css/​screen.css" type=​"text/​css"&gt;​
  &lt;link rel=​"alternate" type=​"application/​rss+xml" title=​"jQuery Blog" href=​"http:​/​/​jquery.com/​blog/​feed/​"&gt;​
  &lt;link rel=​"shortcut icon" href=​"http:​/​/​static.jquery.com/​favicon.ico" type=​"image/​x-icon"&gt;​
  &lt;div id=​"jq-siteContain"&gt;​…​&lt;/div&gt;​
  &lt;!-- /#siteContain --&gt;
&lt;/div&gt;​
</pre><p>And this:</p><pre class="wiki">
$('&lt;div/&gt;').load( '/ body', function(){
  console.log( $(this).html() );
});
</pre><p>logs nothing!</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (6)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 15, 2010 03:25PM UTC by <span class="author">cowboy</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>FWIW, I have been operating under the impression that the whole point of <code>$.fn.load</code> was to be able to load (and select from) entire html documents, as per the examples at <a href="http://api.jquery.com/load/." class="ext-link"><span class="icon"></span>http://api.jquery.com/load/.</a></p><p>Placing this seemingly arbitrary restriction that a developer can't target the <code>html</code>, <code>head</code>, or <code>body</code> elements of deserialized entire-html-document strings in <code>$(str)</code> or <code>$.fn.load</code> isn't great.</p><p>Of course, I'm sure it's not actually arbitrary, it only ''seems'' arbitrary to me as I try to do the following:</p><p>A common use case for <code>$.fn.load</code> might be to very quickly "ajaxify" a site by "hijacking" internal links with a delegated click handler, loading the target page's html via GET request and then replacing the existing body's contents with the newly loaded page's <code>body</code> contents.</p><p>So perhaps this use-case isn't as common as I thought, because it doesn't work!</p><p>Maybe this is an issue of documentation. Maybe it can be fixed without too much effort. Either way, the current behavior doesn't feel particularly elegant, requiring someone who just wants to quickly "ajaxify" a site to wrap all their ajax-loaded content in a parent element (that's ''not'' <code>body</code>).</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 15, 2010 03:43PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <blockquote> Maybe this is an issue of documentation.</blockquote><p>You mean documentation like this? :)</p><blockquote> jQuery uses the browser's .innerHTML property to parse the retrieved document and insert it into the current document. During this process, browsers often filter elements from the document such as &lt;html&gt;, &lt;title&gt;, or &lt;head&gt; elements. As a result, the elements retrieved by .load() may not be exactly the same as if the document were retrieved directly by the browser.  <a href="http://api.jquery.com/load/" class="ext-link"><span class="icon"></span>http://api.jquery.com/load/</a></blockquote><p>I agree it would be ideal if we could somehow load complete document HTML (somewhere off the current document, without fetching its linked images/css) and inject just parts of them into the current document. There are some workarounds like loading the doc into an iframe or fetching it as an XML document, but they have their own sets of problems and don't work for the general case either.</p><p>See also <a href="/ticket/7757">#7757</a> .</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 15, 2010 03:55PM UTC by <span class="author">cowboy</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Also, given this <code>test.html</code>:</p><pre class="wiki">
&lt;!DOCTYPE HTML&gt;
&lt;html lang="en-US"&gt;
&lt;head&gt;
  &lt;title&gt;Index page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="content"&gt;
    &lt;p&gt;stuff&lt;/p&gt;
    &lt;p&gt;more stuff&lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre><p>If I do this:</p><pre class="wiki">
$('&lt;div/&gt;').load( 'test.html #content', function(){
  console.log( this );
} );
</pre><p>I get this, which should be expected:</p><pre class="wiki">
&lt;div&gt;​
  &lt;div id=​"content" class=​"content"&gt;​…​&lt;/div&gt;​
&lt;/div&gt;​
</pre><p>Bit if I use <code>$.get</code> instead of using <code>$.fn.load</code> plus a string selector, this (extremely unintuitive) behavior is what I observe:</p><pre class="wiki">
$.get( 'test.html', function(html){
  console.log( $(html).find( '#content') ); // fails!
  console.log( $(html).filter( '#content') ); // works!
});
</pre><p>Of course, this works.. but it's also fairly inelegant:</p><pre class="wiki">
$.get( 'test.html', function(html){
  console.log( $('&lt;div/&gt;').html( html ).find( '#content' ) ); // ugleey!
});
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 15, 2010 04:11PM UTC by <span class="author">cowboy</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">A user could do something like this, however:&#92;
&#92;
{{{&#92;
$.get( &#39;test.html&#39;, function(html){&#92;
  html = html.replace( /&lt;(&#92;&#92;/?)(html|head|body)([^&gt;]*)&gt;/g, function(a,b,c,d){&#92;
    return &#39;&lt;&#39; + b + &#39;div&#39; + ( b ? &#39;&#39; : &#39; data-element=&quot;&#39; + c + &#39;&quot;&#39; ) + d + &#39;&gt;&#39;;&#92;
  });&#92;
  &#92;
  // These all behave as-expected:&#92;
  console.log( $( html ).find( &#39;#content&#39; ) );&#92;
  console.log( $( html ).find( &#39;[data-element=head]&#39; ).children() );&#92;
  console.log( $( html ).find( &#39;[data-element=body]&#39; ).contents() );&#92;
});&#92;
}}}</span> → <span class="change-field-new">1292429819145596</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>A user could do something like this, however:</p><pre class="wiki">
$.get( 'test.html', function(html){
  html = html.replace( /&lt;(\\/?)(html|head|body)([^&gt;]*)&gt;/ig, function(a,b,c,d){
    return '&lt;' + b + 'div' + ( b ? '' : ' data-element="' + c + '"' ) + d + '&gt;';
  });
  
  // These all behave as-expected:
  console.log( $( html ).find( '#content' ) );
  console.log( $( html ).find( '[data-element=head]' ).children() );
  console.log( $( html ).find( '[data-element=body]' ).contents() );
});
</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 15, 2010 08:18PM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ duplicate</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 15, 2010 08:19PM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Duplicate of <a href="/ticket/3409">#3409</a>.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
