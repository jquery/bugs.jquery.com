<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#5706 (.attr() fails with TypeError when used on foreign elements, such as SVG) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/5705/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/5707/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#5706</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(duplicate)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened December 23, 2009 12:58PM UTC</p>
      
        <p>Closed November 21, 2010 04:42AM UTC</p>
      
      
        <p>Last modified March 10, 2012 07:09AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">.attr() fails with TypeError when used on foreign elements, such as SVG</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        rdworth
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        high
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.5">1.5</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>core</td>
      
        <th>Version:</th>
      
      <td>1.4a2</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>attr attribute TypeError foreign svg getAttribute setAttribute</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>For foreign elements in an HTML document, the .attr() method fails for getting and setting values, as it attempts to use</p><pre class="wiki">
//DOM HTML
var value = elem[name];
elem[name] = value;
</pre><p>instead of</p><pre class="wiki">
//DOM Core
var value = elem.getAttribute(name);
elem.setAttribute(name, value);
</pre><p>A simple test of this, in a browser that supports foreign elements in HTML documents (must implement document.createElementNS):</p><pre class="wiki">
var rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
rect.setAttribute('width', 100);
jQuery(rect).attr('width', 200);
</pre><p>In jQuery 1.4a2, this fails with TypeError: setting a property that has only a getter.</p><p>References:</p> <ul><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html#foreign-elements" class="ext-link"><span class="icon"></span>HTML5 - Foreign Elements</a></li> <li><a href="http://annevankesteren.nl/2008/04/html5-foreign" class="ext-link"><span class="icon"></span>Anne’s Weblog - HTML5: the foreign lands (mathematics and graphics)</a></li> <li><a href="http://snook.ca/archives/snooksurvey/element_attributes_in_javascript#c48593" class="ext-link"><span class="icon"></span>Snook.ca - <a href="/wiki/SnookSurvey">SnookSurvey</a> Element Attributes in <a href="/wiki/JavaScript">JavaScript</a>, comment by molily</a></li> <li><a href="http://snook.ca/archives/snooksurvey/element_attributes_in_javascript#c48717" class="ext-link"><span class="icon"></span> Snook.ca - <a href="/wiki/SnookSurvey">SnookSurvey</a> Element Attributes in <a href="/wiki/JavaScript">JavaScript</a>, comment by PPK</a></li> <li><a href="http://snook.ca/archives/snooksurvey/element_attributes_in_javascript#c48720" class="ext-link"><span class="icon"></span>Snook.ca - <a href="/wiki/SnookSurvey">SnookSurvey</a> Element Attributes in <a href="/wiki/JavaScript">JavaScript</a>, comment by Anne van Kesteren</a></li> <li><a href="http://ejohn.org/blog/nodename-case-sensitivity/" class="ext-link"><span class="icon"></span>John Resig - .nodeName Case Sensitivity</a></li></ul></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (6)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 23, 2009 02:29PM UTC by <span class="author">rdworth</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>There is a current check in .attr() for isXMLDoc, but we need a fix that works for foreign elements in HTML documents, meaning the fix needed here cannot be based on the type of document the element is from or in, but based on whether the element is from a namespace other than HTML. Patches (including tests):</p> <ul><li><a href="http://github.com/rdworth/jquery/commit/f9463b1e7d153c0dee9afa20cb90af03b59231c8" class="ext-link"><span class="icon"></span>jQuery patch</a></li></ul><p>This fixes .attr() by not using the DOM HTML method of getting and setting attributes if the element is detected to be foreign. In this case, it falls back to DOM Core's .getAttribute() and .setAttribute(). Tests included.</p> <ul><li><a href="http://github.com/rdworth/sizzle/commit/7b1e0a100bbe89b679049d4468400e33380ce7c6" class="ext-link"><span class="icon"></span>Sizzle patch</a></li></ul><p>This adds a new function, isForeignElement. This is similar to isXML (isXMLDoc in jQuery), except that it's based on the namespace of the element itself, rather than the type of document it's in/from, or the way it's parsed (text/html vs. application/xhtml+xml). In the case of IE, we'll get nothing from .namespaceURI, but IE doesn't support foreign elements anyway. So in this case we fall back to using isXML. This means the function isn't defined as detecting whether an element is foreign to the document it's in, but whether the element is foreign to the HTML namespace. See tests in above commit.</p><p>References:</p> <ul><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html#foreign-elements" class="ext-link"><span class="icon"></span>HTML5 - Foreign Elements</a></li> <li><a href="https://developer.mozilla.org/En/DOM/Node.namespaceURI" class="ext-link"><span class="icon"></span>MDC - Node.namespaceURI</a></li> <li><a href="https://developer.mozilla.org/en/DOM/document.createElementNS" class="ext-link"><span class="icon"></span>MDC - document.createElememtNS</a></li></ul>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 06, 2010 12:32AM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfilled</span> → <span class="change-field-new">core</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.4</span> → <span class="change-field-new">1.5</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Richard - We're going to tackle this, and a number of other XML/XHTML/XUL/SVG related issues post-1.4. Thanks for the patch!</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 07, 2010 11:32PM UTC by <span class="author">rdworth</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Moved jQuery patch to a feature branch: <a href="http://github.com/rdworth/jquery/commits/svgfriendly" class="ext-link"><span class="icon"></span>http://github.com/rdworth/jquery/commits/svgfriendly</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 19, 2010 06:49AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.4.4</span> → <span class="change-field-new">1.5</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">major</span> → <span class="change-field-new">high</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 21, 2010 04:42AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ duplicate</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 21, 2010 04:42AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Duplicate of <a href="/ticket/3116">#3116</a>.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
