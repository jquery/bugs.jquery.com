<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#12824 (Ajax fires abort onunload event, even when using XMLHTTP (IE only)) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/12823/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/12827/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#12824</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(notabug)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened November 01, 2012 01:02PM UTC</p>
      
        <p>Closed November 23, 2012 12:10PM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">Ajax fires abort onunload event, even when using XMLHTTP (IE only)</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        eyaleyal2001@yahoo.com
      </td>
      <th>Owned by:</th>
      <td>eyaleyal2001@yahoo.com</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        undecided
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>ajax</td>
      
        <th>Version:</th>
      
      <td>1.8.2</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th>Cc:</th>
      
      <td>jaubourg</td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>On IE8/9, When using Ajax call when <a href="/wiki/OnUnload">OnUnload</a> event fires, the ajax call is aborted immediately.</p><p>While looking at the jQuery source, i found out that there is a place when you want to release the IE resources when using ActiveX : when setting the xhrOnUnloadAbort var.</p><p>On the other hand, when setting the xhr object for IE, there is a function that returns the standard XHR while calling createStandardXHR(). (in case the isLocal param is false). (I belive the logic was that the activeX will always work when available, but it actually using the standard XMLHTTP)</p><p>I think it is kind of logic conflict...</p><p>I've tried to look for a way to change the xhrOnUnloadAbort, but there is no access for it. And i thing maybe there should be one?</p><p>My final solution in the code is to define xhrOnUnloadAbort when considering the isLocal var as well:</p><p>xhrOnUnloadAbort = this.isLocal && window.ActiveXObject ? function() {</p><p>		// Abort all pending requests</p><p>		for ( var key in xhrCallbacks ) {</p><p>			xhrCallbacks[ key ]( 0, 1 );</p><p>		}</p><p>	} : false</p><p>Creating an example for it is difficult, because i discovered it on a server side error (probably when a connection was opened and aborted immediately with no data). So in <a href="/wiki/FireFox">FireFox</a> and Chrome it works great and the connection is not aborted.</p><p>I didn't find any information about resources abuse of IE when using XMHHTTP.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (6)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 01, 2012 02:28PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>cc:</th>
                  <td>
                    
                      <span class="change-field-new">→ jaubourg</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">ajax</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 21, 2012 10:04PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>jaubourg, can you weigh in on this ticket?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 22, 2012 04:10PM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <blockquote> On IE8/9, When using Ajax call when <a href="/wiki/OnUnload">OnUnload</a> event fires, the ajax call is aborted immediately.</blockquote><p>Please, tell me you made a __synchronous__ request. If you made an asynchronous one, you're not guaranteed it will finish before the browser navigates to another page anyway.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 22, 2012 05:25PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ eyaleyal2001@yahoo.com</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 23, 2012 08:57AM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:3 jaubourg]:</p><blockquote> &gt; On IE8/9, When using Ajax call when <a href="/wiki/OnUnload">OnUnload</a> event fires, the ajax call is aborted immediately.  Please, tell me you made a __synchronous__ request. If you made an asynchronous one, you're not guaranteed it will finish before the browser navigates to another page anyway.</blockquote><p>Hi,</p><p>I know that using a synchronous request will work.</p><p>But, the asynchronous requests used to work as well when using XMLHTTP directly before moving to JQuery to manage my ajax requests.</p><p>Firefox and Chrome work perfect with the same code i am running asynchronous.</p><p>It doesn't change the issue of non logical dealing of aborting the requests. one u do to IE, even though no ActiveX object had been created and used. </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 23, 2012 12:10PM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">&#39;&#39;I assume you&#39;re talking about requests issued from an `onunload` handler. Because, if you&#39;re talking about any request in your page (that is requests that are &#39;&#39;&#39;not&#39;&#39;&#39; issued in an `onunload` handler), I find your statement about requests never being aborted in Chrome and FF very hard to believe. Hence why I assume the former. Some code sample / test case would have helped clarified this much better than an attempted &quot;fix&quot; inside jQuery.&#39;&#39;&#92;
&#92;
Anyway, glad to know you know about synchronous requests working. Where is it mentionned in the bug report? :P&#92;
&#92;
Firefox and Chrome do not work &quot;perfect&quot; with asynchronous requests. It just so happens your network is good enough, your server close enough or your computer slow enough for the request to be sent before the page is actually unloaded. That&#39;s not at all guaranteed though. Any network congestion or just having a faster computer will abort the request early, just like jQuery does in IE, and the data will never reach the server. &#39;&#39;&#39;Even requests with no data are not guaranteed to reach the server!&#39;&#39;&#39;&#92;
&#92;
You &#39;&#39;&#39;must&#39;&#39;&#39; use synchronous requests in an `onunload` handler. See the top response [http://stackoverflow.com/questions/3584288/can-the-unload-event-be-used-to-reliably-fire-ajax-request here] for the full rationale.</span> → <span class="change-field-new">1353672740989474</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment1:</th>
                  <td>
                    
                      <span class="change-field-old">&#39;&#39;I assume you&#39;re talking about requests issued from an `onunload` handler. Because, if you&#39;re talking about any request in your page (that is requests that are &#39;&#39;&#39;not&#39;&#39;&#39; issued in an `onunload` handler), I find your statement about requests never being aborted in Chrome and FF very hard to believe. Hence why I assume the former. Some code sample / test case would have helped clarified this much better than an attempted &quot;fix&quot; inside jQuery.&#39;&#39;&#92;
&#92;
Anyway, glad to know you know about synchronous requests working. Where is it mentionned in the bug report? :P&#92;
&#92;
Firefox and Chrome do not work &quot;perfect&quot; with asynchronous requests. It just so happens your network is good enough, your server close enough or your computer slow enough for the request to be sent before the page is actually unloaded. That&#39;s not at all guaranteed though. Any network congestion or just having a faster computer will abort the request early, just like jQuery does in IE, and the data will never reach the server. &#39;&#39;&#39;Even requests with no data are not guaranteed to reach the server! &#39;&#39;&#39;&#92;
&#92;
You &#39;&#39;&#39;must&#39;&#39;&#39; use synchronous requests in an `onunload` handler. See the top response [http://stackoverflow.com/questions/3584288/can-the-unload-event-be-used-to-reliably-fire-ajax-request here] for the full rationale.</span> → <span class="change-field-new">1353672795716433</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ notabug</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
        
          
            <div class="ticket-comment-body">
              <p>''I assume you're talking about requests issued from an <code>onunload</code> handler. Because, if you're talking about any request in your page (that is requests that are <strong>not</strong> issued in an <code>onunload</code> handler), I find your statement about requests never being aborted in Chrome and FF very hard to believe. Hence why I assume the former. Some code sample / test case would have helped clarify this much better than an attempted "fix" inside jQuery.''</p><p>Anyway, glad to know you know about synchronous requests working. Where is it mentionned in the bug report? :P</p><p>Firefox and Chrome do not work "perfect" with asynchronous requests. It just so happens your network is good enough, your server close enough or your computer slow enough for the request to be sent before the page is actually unloaded. That's not at all guaranteed though. Any network congestion or just having a faster computer will abort the request early, just like jQuery does in IE, and the data will never reach the server. <strong>Even requests with no data are not guaranteed to reach the server! </strong></p><p>You <strong>must</strong> use synchronous requests in an <code>onunload</code> handler. See the top response <a href="http://stackoverflow.com/questions/3584288/can-the-unload-event-be-used-to-reliably-fire-ajax-request" class="ext-link"><span class="icon"></span>here</a> for the full rationale.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
