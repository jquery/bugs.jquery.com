<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#10522 (animate() in IE7-8 function after complete called twice) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/10521/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/10523/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#10522</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened October 18, 2011 04:52PM UTC</p>
      
        <p>Closed November 03, 2011 08:11AM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">animate() in IE7-8 function after complete called twice</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        vasis123@gmail.com
      </td>
      <th>Owned by:</th>
      <td>vasis123@gmail.com</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>effects</td>
      
        <th>Version:</th>
      
      <td>1.6.4</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>This is my code reduced.</p><pre class="wiki">
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
	$(function() {
		var $bg_image   = $('#bf_background').children('img'), //(1)
			animSpeed   = 700,
			animated    = false,
			current     = 0,
		navigate = function(dir) {
			if(animated) return false;
			animated = true;
			total_items = $('.bf_gallery_item').length;
			(dir) ? ++current : --current;
			if(current &gt; total_items - 1)
				current = 0;
			else if(current &lt; 0)
				current = total_items - 1;
			var $next_item = $('.bf_gallery_item').eq(current);
			animateBGImage(dir, $next_item);
		},
		animateBGImage = function(dir, $next_item) {
			var $next_item_bgimage = $('&lt;img src="' + $next_item.children('img').data('bgimg') + '" alt="image' + (current + 1) + '" &gt;&lt;/img&gt;'),
				starting_left = (dir) ? $(window).width() : -$(window).width();
			//(2)
			$next_item_bgimage.css({
				width	: '100%',
				height	: '100%',
				left	: starting_left,
				top		: '0'
			}).insertAfter($bg_image).stop().animate({
				left	: '0px'
			}, animSpeed);
			var ending_left	= (dir) ? -$bg_image.width() : $(window).width();
			$bg_image.stop().animate({
				left	: ending_left + 'px'
			}, animSpeed, function() {	//(3)
				$(this).remove();
				$bg_image 	= $next_item_bgimage;
				animated 	= false;
			});
		};
		$('#bf_prev').bind('click', function(e) {
			navigate(0);
			return false;
		});
		$('#bf_next').bind('click', function(e) {
			navigate(1);
			return false;
		});
	});
&lt;/script&gt;
&lt;style&gt;
	.bf_nav a{
		width:72px;
		height:140px;
		position:fixed;
		top:50%;
		margin-top:-70px;
		cursor:pointer;
		z-index:999;
		background:#000;
	}
	.bf_nav a.bf_next{
		right:0;
	}
	.bf_nav a.bf_prev{
		left:0;
	}
	.bf_background img{
		position:fixed;
		top:0px;
		left:0px;
		width:100%;
	}
	.bf_gallery_item {
		display:none;
	}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id="bf_background" class="bf_background"&gt;
		&lt;img src="images/background/default.jpg" alt="image1"/&gt;
	&lt;/div&gt;
	&lt;div id="bf_gallery" class="bf_gallery"&gt;
		&lt;div class="bf_nav"&gt;
			&lt;a id="bf_prev" href="#" class="bf_prev"&gt;&lt;/a&gt;
			&lt;a id="bf_next" href="#" class="bf_next"&gt;&lt;/a&gt;
		&lt;/div&gt;
		&lt;div class="bf_gallery_item"&gt;
			&lt;img src="images/foreground/1.jpg" alt="image1" data-bgimg="images/background/1.jpg" /&gt;
		&lt;/div&gt;
		&lt;div class="bf_gallery_item"&gt;
			&lt;img src="images/foreground/2.jpg" alt="image1" data-bgimg="images/background/2.jpg" /&gt;
		&lt;/div&gt;
		&lt;div class="bf_gallery_item"&gt;
			&lt;img src="images/foreground/3.jpg" alt="image1" data-bgimg="images/background/3.jpg" /&gt;
		&lt;/div&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre><p>This code changes the background image, but in IE7-8 (and possibly 6) function is invoked after the animation and marked as "//(3)" is called twice. This leads to the fact that after the second slide transitions in the block "bf_background" placed the following code: </p><pre class="wiki">

&lt;img style="left: 0px; top: 0px; width: 100%; height: 100%;" alt="image3" src="images/background/3.jpg"/&gt;
&lt;/img style="left: 0px; top: 0px; width: 100%; height: 100%;"/&gt;
&lt;img style="left: 0px; top: 0px; width: 100%; height: 100%;" alt="image3" src="images/background/3.jpg"/&gt;
&lt;/img style="left: 0px; top: 0px; width: 100%; height: 100%;"/&gt;

</pre><p> and the code becomes non-functional. But if the line marked "<em>(1)" move into function  "animateBGImage", at the place is marked as "</em>(2)" everything is working well.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (2)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 19, 2011 10:58AM UTC by <span class="author">addyosmani</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">effects</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ vasis123@gmail.com</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Is there any way you could clean up the code supplied into a test case on jsFiddle.net?</p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 03, 2011 08:11AM UTC by <span class="author">trac-o-bot</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Because we get so many tickets, we often need to return them to the initial reporter for more information. If that person does not reply within 14 days, the ticket will automatically be closed, and that has happened in this case. If you still are interested in pursuing this issue, feel free to add a comment with the requested information and we will be happy to reopen the ticket if it is still valid. Thanks!</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
