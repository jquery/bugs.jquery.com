<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#3265 (Critical error raised when animating VML) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/3264/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/3266/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#3265</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(fixed)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened August 20, 2008 12:23AM UTC</p>
      
        <p>Closed February 16, 2009 03:53PM UTC</p>
      
      
        <p>Last modified March 14, 2012 04:39PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Critical error raised when animating VML</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        westonruter
      </td>
      <th>Owned by:</th>
      <td>john</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        major
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.3.2">1.3.2</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>selector</td>
      
        <th>Version:</th>
      
      <td>1.3.1</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>msie, vml, animation</td>
      
        <th>Cc:</th>
      
      <td>westonruter, flesler</td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>In MSIE 7 (at least) an error is raised when this jQuery is executed:</p><pre class="wiki">
$('#vml-image').animate({rotation:'360deg'});
</pre><p>The error first occurs on line 1407 (and then subsequently on line 1162) and is described simply as "Failed". It is raised when an animation is attempted and then subsequently whenever the page is unloaded (even after the page is reloaded) until the entire browser is closed and restarted.</p><p><a href="http://weston.ruter.net/projects/test-cases/jquery-vml-bug/" class="ext-link"><span class="icon"></span>http://weston.ruter.net/projects/test-cases/jquery-vml-bug/</a></p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (10)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 20, 2008 04:23PM UTC by <span class="author">flesler</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>cc:</th>
                  <td>
                    
                      <span class="change-field-new">→ westonruter, flesler</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">core</span> → <span class="change-field-new">fx</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 23, 2009 04:00PM UTC by <span class="author">fansipans</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This also impacted me when using the "DD Roundies" script library, which relies on VML, see example error (in IE6 and IE7) here: <a href="http://pastebin.com/f4175991b" class="ext-link"><span class="icon"></span>http://pastebin.com/f4175991b</a></p><p>It appears that certain elements being manipulated throw exceptions when any properties are accessed - not returning undefined, just throwing exceptions. Perhaps a guard could be placed in Sizzle where elements are first grabbed from the browser to ignore these nodes? </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 04, 2009 12:22AM UTC by <span class="author">Nikola</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>There is a similar problem with the Cornerz plug-in and the UI Dialog.  When inserting VML into MSIE all js breaks and the browser must be restarted in order to clear the problem.</p><p>Minimal Test Case</p><p><a href="http://paste.pocoo.org/show/102218/" class="ext-link"><span class="icon"></span>http://paste.pocoo.org/show/102218/</a></p><p>UI Development Ticket</p><p><a href="http://dev.jqueryui.com/ticket/4020" class="ext-link"><span class="icon"></span>http://dev.jqueryui.com/ticket/4020</a></p><p>UI Discusison</p><p><a href="http://groups.google.com/group/jquery-ui/browse_thread/thread/259fd784e4b454f9" class="ext-link"><span class="icon"></span>http://groups.google.com/group/jquery-ui/browse_thread/thread/259fd784e4b454f9</a></p><p>Cornerz Discussion</p><p><a href="http://groups.google.com/group/cornerz/browse_thread/thread/95ed7ffaafd022b3" class="ext-link"><span class="icon"></span>http://groups.google.com/group/cornerz/browse_thread/thread/95ed7ffaafd022b3</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 12, 2009 06:04PM UTC by <span class="author">mgl</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I've found something that may be the source of the problem.  IE doesn't seem to like Sizzle.selectors.filters.visible when I'm working with VML.  The solution I came up with is a bit absurd, but I've run into a few problems where IE seems to throw up if you use certain words as properties of objects (among other issues):</p><p>Rename </p><pre class="wiki">
Sizzle.selectors.filters.visible
</pre><p>to</p><pre class="wiki">
Sizzle.selectors.filters.isVisible
</pre><p>Then add the following to the beginning of jQuery.fn.is (at line 394):</p><pre class="wiki">
if (typeof(selector)=="string") 
	selector = selector.split(":visibl").join(":isVisibl");
</pre><p>Is it just me, or is this a bit crazy?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 13, 2009 03:15AM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">fx</span> → <span class="change-field-new">selector</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.3</span> → <span class="change-field-new">1.3.2</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ john</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>version:</th>
                  <td>
                    
                      <span class="change-field-old">1.2.6</span> → <span class="change-field-new">1.3.1</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>That's definitely crazy. A test case here would be immensely useful in drilling down to find what the problem is.</p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 13, 2009 03:39AM UTC by <span class="author">mgl</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Ok...here's a test case, similar to the one I posted in the Sizzle discussion:</p><pre class="wiki">
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
	&lt;head&gt;
		&lt;title&gt;VML Bug&lt;/title&gt;
		&lt;link rel="stylesheet" type="text/css" href="../css/ui.all.css" /&gt;
		&lt;script type="text/javascript" src="../js/jquery/jquery-1.3.1.js"&gt;&lt;/script&gt;
		&lt;script type="text/javascript" src="../js/jquery/ui/ui.core.js"&gt;&lt;/script&gt;
		&lt;script type="text/javascript" src="../js/jquery/ui/ui.draggable.js"&gt;&lt;/script&gt;
		&lt;script type="text/javascript" src="../js/jquery/ui/ui.resizable.js"&gt;&lt;/script&gt;
		&lt;script type="text/javascript" src="../js/jquery/ui/ui.dialog.js"&gt;&lt;/script&gt;
		&lt;script&gt;
		
			$(document).ready(function(){
				
				$("&lt;div&gt;&lt;/div&gt;").dialog();
				
				var canvas1 = $("#canvas1");
				
				initVML();
				
				var geom = canvas1.get(0).appendChild(document.createElement("v:shape"));
				geom.style.width=canvas1.css("width");
				geom.style.height=canvas1.css("height");
				geom.coordsize = parseInt(canvas1.css("width"))+","+parseInt(canvas1.css("height"));
				var fill = geom.appendChild(document.createElement("v:fill"));
				fill.color = "#0F0";
				var stroke = geom.appendChild(document.createElement("v:stroke"));
				stroke.weight = 2;
				stroke.color = "#00F";
				
				geom.path.value = "M 10 10 L 10 100 100 100 100 10 X";
				
			});
			
			
			initVML = function(){
				var nsLoaded = false;
				$.each(document.namespaces,function(i,v){
					if (v.urn=="urn:schemas-microsoft-com:vml")
					{
						nsLoaded = true; return false;
					}
				});
				
				if(!nsLoaded)
				{
					document.namespaces.add("v", "urn:schemas-microsoft-com:vml");
					var style = document.createStyleSheet();
					style.addRule('v\\\\:*', "behavior: url(#default#VML); position: absolute; display: inline-block;");
				}
			}
			
		&lt;/script&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;div id="canvas1" style="position:absolute;width:500px;top:10px;left:100px;height:200px;"&gt;&lt;/div&gt;
	&lt;/body&gt;
&lt;/html&gt;

</pre>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 13, 2009 04:20AM UTC by <span class="author">mgl</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Ok...in ui.dialog.js (1.6rc6), line 188, there is a selector with :visible.  I took that selector out, and the sample above works fine.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 13, 2009 11:16PM UTC by <span class="author">mgl</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>To simplify the test case above, you can take the dialog entirely out of the equation, and replace the ready function with this:</p><pre class="wiki">
$(document).ready(function(){
	var canvas1 = $("#canvas1");
	initVML();
	var geom = canvas1.get(0).appendChild(document.createElement("v:shape"));
	var x = $(':visible');
});
</pre><p>The error will now happen immediately when the page is loaded</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 16, 2009 02:31AM UTC by <span class="author">mgl</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Just another note - I seem to have found that the hidden filter has the same issue, and needs the same fix.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 16, 2009 03:53PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Fixed in SVN rev [6210].</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
