<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#14001 (Easy context switching (temporarily load in an iFrame)) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/14000/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/14003/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#14001</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">feature</span>
      <span class="ticket-resolution">(notabug)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened June 07, 2013 02:24PM UTC</p>
      
        <p>Closed March 01, 2014 10:13PM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">Easy context switching (temporarily load in an iFrame)</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        timmywil
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>core</td>
      
        <th>Version:</th>
      
      <td>1.10.1</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>1.11-discuss</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>From Mr. Diego Perini =&gt;</p><p>For ages I have been wanting to load jQuery in a temporary IFRAME then moving it to the main browsing context and finally remove the IFRAME used for loading.</p><p>Since the IFRAME is going to disappear all the method calls executed in that context or not explicitly scoped will fail and return errors (for example setTimeout =&gt; window.setTimeout and parseFloat =&gt; window.parseFloat etc.).</p><p>To make this work I need the patches you can see in the attached file.</p><p>It seems to me none of these changes will introduce incompatibilities.</p><p>Can you have a look and tell me if this would be possible?</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (1)</summary>

  <ul class="ticket-attachments">
    
      <li>
        <a href="/attachment/ticket/14001/jquery-iframe-patch.diff/index.html">jquery-iframe-patch.diff</a> (6.4 KB) - added by timmywil
        <strong>June 07, 2013 02:26PM UTC</strong>.<br>
        
      </li>
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (11)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 07, 2013 02:33PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">core</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-new">→ 1.11-discuss</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I've recommended Diego make a pull request. Just wanted to get the team's thoughts. I think it's plausible, but it would be good to see a use case in action.</p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 07, 2013 02:35PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">For ages I have been wanting to load jQuery in a temporary IFRAME then moving it to the main browsing context and finally remove the IFRAME used for loading.&#92;
From Mr. Diego Perini:&#92;
&#92;
Since the IFRAME is going to disappear all the method calls executed in that context or not explicitly scoped will fail and return errors (for example setTimeout =&gt; window.setTimeout and parseFloat =&gt; window.parseFloat etc.).&#92;
&#92;
To make this work I need the patches you can see in the attached file.&#92;
&#92;
It seems to me none of these changes will introduce incompatibilities.&#92;
&#92;
Can you have a look and tell me if this would be possible?&#92;
</span> → <span class="change-field-new">For ages I have been wanting to load jQuery in a temporary IFRAME then moving it to the main browsing context and finally remove the IFRAME used for loading.&#92;
From Mr. Diego Perini:&#92;
&#92;
From Mr. Diego Perini:&#92;
&#92;
Since the IFRAME is going to disappear all the method calls executed in that context or not explicitly scoped will fail and return errors (for example setTimeout =&gt; window.setTimeout and parseFloat =&gt; window.parseFloat etc.).&#92;
&#92;
To make this work I need the patches you can see in the attached file.&#92;
&#92;
It seems to me none of these changes will introduce incompatibilities.&#92;
&#92;
Can you have a look and tell me if this would be possible?&#92;
</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 07, 2013 02:36PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">For ages I have been wanting to load jQuery in a temporary IFRAME then moving it to the main browsing context and finally remove the IFRAME used for loading.&#92;
From Mr. Diego Perini:&#92;
&#92;
From Mr. Diego Perini:&#92;
&#92;
Since the IFRAME is going to disappear all the method calls executed in that context or not explicitly scoped will fail and return errors (for example setTimeout =&gt; window.setTimeout and parseFloat =&gt; window.parseFloat etc.).&#92;
&#92;
To make this work I need the patches you can see in the attached file.&#92;
&#92;
It seems to me none of these changes will introduce incompatibilities.&#92;
&#92;
Can you have a look and tell me if this would be possible?&#92;
</span> → <span class="change-field-new">&#92;
From Mr. Diego Perini =&gt;&#92;
&#92;
For ages I have been wanting to load jQuery in a temporary IFRAME then moving it to the main browsing context and finally remove the IFRAME used for loading.&#92;
&#92;
Since the IFRAME is going to disappear all the method calls executed in that context or not explicitly scoped will fail and return errors (for example setTimeout =&gt; window.setTimeout and parseFloat =&gt; window.parseFloat etc.).&#92;
&#92;
To make this work I need the patches you can see in the attached file.&#92;
&#92;
It seems to me none of these changes will introduce incompatibilities.&#92;
&#92;
Can you have a look and tell me if this would be possible?</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 07, 2013 02:38PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">If jQuery is loaded in an iframe, all the constructors such as Array or Object will belong to the iframe. That will cause issues if there are checks such as `thing.constuctor === Array` when `thing` was created in the parent. I don&#39;t know if that may affect our code or client code, especially for oldIE which is very cranky about those things. Did all unit tests pass after this patch?&#92;
&#92;
There was a thread going on at http://forum.jquery.com/topic/save-the-jquery-factory-reuse-it-in-frames-no-2nd-network-request to get the unit tests working in a similar situation but it seems to have stalled.&#92;
&#92;
I think it may be a good idea to explicitly scope things to our internal `window`, especially for non-browser environments, but that is only part of the proposal.&#92;
</span> → <span class="change-field-new">1370615954827072</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>If jQuery is loaded in an iframe, all the constructors such as Array or Object will belong to the iframe. That will cause issues if there are checks such as <code>thing.constructor === Array</code> when <code>thing</code> was created in the parent. I don't know if that may affect our code or client code, especially for oldIE which is very cranky about those things. Did all unit tests pass after this patch?</p><p>There was a thread going on at <a href="http://forum.jquery.com/topic/save-the-jquery-factory-reuse-it-in-frames-no-2nd-network-request" class="ext-link"><span class="icon"></span>http://forum.jquery.com/topic/save-the-jquery-factory-reuse-it-in-frames-no-2nd-network-request</a> to get the unit tests working in a similar situation but it seems to have stalled.</p><p>I think it may be a good idea to explicitly scope things to our internal <code>window</code>, especially for non-browser environments, but that is only part of the proposal.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 07, 2013 02:40PM UTC by <span class="author">gibson042</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Sending the top level IIFE <code>frameElement && /^loader/.test(frameElement.name) ? parent : this</code> instead of <code>window</code>, aside from the obvious concerns like "frameElement is not defined" and "WTF is 'loader'?", will screw with non-browser environments like jsdom.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 07, 2013 03:19PM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I don't wanna raise the deads but wouldn't it be time to give <code>newInstance</code> another go? For those who never heard of it, the main jQuery closure was referenced as a <code>newInstance</code> method. So we had something like:</p><pre class="wiki">window.jQuery = ( function newInstance( window ) {

    var jQuery = { /*...*/ };

    jQuery.newInstance = newInstance;

    return jQuery;

} )( window );
</pre><p>It always creates a fresh new instance of jQuery (no plugins) and it was faster than <code>sub</code> while re-performing the support tests.</p><p>Bonus point: we could publish the newInstance main closure as an official npm module which would solve a lot of problems we have in that env.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 08, 2013 01:13PM UTC by <span class="author">diego.perini@gmail.com</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@dave, thank your for that link, it shows there is a demand for that, very similar in scope to the changes proposed in this patch. As you have noticed these are simple scoping changes that will probably also benefit headless environments, and they are innocuous (tests always needed though).</p><p>Maybe there are others like those that I couldn't find during my tests.</p><p>The last diff line in that patch, related to the "frameELement" property, was unintentionally left in and should not be considered part of this request. It was just part of my testing and not yet part of this proposal.</p><p>@gibson042, can you tell me more about the "frameElement is not defined" error you get related to this standard property of the host browsing context ?</p><p>That line (pass "parent" instead of "window") would have effect only when explicitly loaded in an iframe having its name string starting with "loader".</p><p>My request was limited to explicitly scoping methods to the internal "window".</p><p>Though, since it slipped in, it would be good for me to have some feedback on that "frameElement" trickery, I currently have other alternatives and ideas for that.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 08, 2013 01:38PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@jaubourg</p><p>that's the way I am currently using to retrieve the original source code by explicitly naming the IFE and saving it internally or externally somewhere.</p><p>The same could be achieve by getting the "arguments.callee" but that would be a violation when "use strict"; is enforced in user code.</p><p>Also in my current testing I am saving names, references and strings of code in an two level deeper property of the host context, namely I use "window.navigator.modules" as my namespace. This also leads to 0 globals.</p><p>While I am not sure this is everybody's objective, I swear I am trying to do my best to avoid breaking jQuery for others. I am sure both objectives are possible without too much effort.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 08, 2013 02:28PM UTC by <span class="author">diego.perini@gmail.com</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Just wanted to say that the previous anonymous comment to @jaubourg is from me.</p><p>I forgot to set the user name and I am not able to change it.</p><p></p><hr><p></p><p>Diego</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 17, 2013 05:19PM UTC by <span class="author">diego</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Here are the list of object types, global/window properties and methods that need to be explicitly scoped in code to allow new instances to work across browser contexts.</p><p>  object_types = 'Boolean|Number|String|Function|Object|Array|RegExp|Date|Math|Error';</p><p>  global_props = 'Infinity|NaN|undefined';</p><p>  global_methods = 'eval|escape|unescape|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|parseInt|parseFloat|isFinite|isNaN';</p><p>  window_props = 'closed|defaultStatus|document|frames|history|length|location|name|navigator|opener|parent|screen|self|status|top|innerHeight|innerWidth|outerHeight|outerWidth|pageXOffset|pageYOffset|screenLeft|screenTop|screenX|screenY';</p><p>  window_methods = 'alert|blur|focus|open|close|confirm|prompt|print|moveBy|moveTo|resizeBy|resizeTo|scroll|scrollBy|ScrollTo|clearTimeout|setTimeout|clearInterval|setInterval';</p><p>If we had access to the original source of the generating Javascript code we would not need to explicitly scope each method/property, however explicitly scoping will allow extending jQuery with plugin/modules and have new instances include the needed plugin/modules.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 01, 2014 10:13PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ notabug</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>It's interesting, but nobody's taken it up as a cause and I can also see possible issues with use in environments like node.js. Probably better if someone could experiment a bit and come up with compelling use cases.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
