<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#9479 (o is null) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/9478/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/9480/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#9479</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(worksforme)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened June 01, 2011 08:12AM UTC</p>
      
        <p>Closed June 03, 2011 09:53PM UTC</p>
      
      
        <p>Last modified June 07, 2011 07:09AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">o is null</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        anonymous
      </td>
      <th>Owned by:</th>
      <td>anonymous</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.next">1.next</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>effects</td>
      
        <th>Version:</th>
      
      <td>1.6.1</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>in firefox I obtain always "o is null" when using toggle()</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (5)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 01, 2011 01:11PM UTC by <span class="author">addyosmani</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">effects</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ anonymous</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks for taking the time to contribute to the jQuery project! Please provide a reduced jsFiddle test case to help us assess your ticket!</p><p>Additionally, be sure to test against the jQuery Edge version to ensure the issue still exists. To get you started, use this boilerplate: <a href="http://jsfiddle.net/rwaldron/da3nM/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/rwaldron/da3nM/</a>  Open the link and click to "Fork" in the top menu.</p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 03, 2011 01:45PM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Hello,</p><p>I found that this error "o is null" appears just with 1.6.1 while if I use 1.5.1 I obtain a "JQuery is not defined" on the jquery UI code which is loaded correctly after JQuery.</p><p>I am using Firefox 4.0.1</p><p>My page is XHTML 1.0 Transitional (validated) and I am pretty sure that I had no problems using HTML 4.0 with JQuery.</p><p>Now I upgraded to XHTML 1.0 and JQuery doesn't work anymore even if I downgrade to older versions.</p><p>My code is almost stupid as first rows are just calling a toggle() function on a div.</p><p>So the same page with different jquery versions provides different errors.</p><p>I can't help more at the moment.</p><p>Best regards</p><p>Roberto</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 03, 2011 09:53PM UTC by <span class="author">addyosmani</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ worksforme</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Using the information you've provided, I've put together a test case using XHTML 1.0 transitional, jQuery edge (1.6.1-post, our current in-development version) and a basic toggle() example here <a href="http://jsfiddle.net/BLQRu/2/." class="ext-link"><span class="icon"></span>http://jsfiddle.net/BLQRu/2/.</a> Running this in Firefox 4.01, Chrome and the latest version of the other popular browsers, everything appears to work fine without error messages being output.</p><p>With this in mind, I'm tempted to think that the problem you're experiencing may be related to your code or what you're trying to do. If you need further assistance debugging the issue, please feel free to speak to a community member about it in our forums or on IRC/freenode under the #jquery channel. Should this result in some more information on the cause of the issue, we'll be happy to re-evaluate.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 06, 2011 09:47AM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks for your evaluation, but it seems this is a racing condition or however a kind of assumption in jquery code that doesn't work with my page.</p><p>I found using the debugger that jquery 1.6.1 fails inside its "clean" function I reported below.</p><p>MY EVALUATION:</p><p>Inside the clean function JQuery does a: </p><p>   div = context.createElement("div");</p><p>...later it executes the following which is resulting in a null "div" variable.</p><p>   <em> Move to the right depth</em></p><p>   while ( depth-- ) {</p><p>      div = div.lastChild;</p><p>   }</p><p>...at the end of the clean function we have a "null pointer" trying to use the null div variable:</p><p>   elem = div.childNodes;</p><p>Pratically I see here two problems:</p><p>1) There is an assumption that the created div has child nodes</p><p>2) There is not a protection against the null pointer</p><p>In order to workaround this error I should understand what's wrong in my code (I mean: what jquery don't like in my valid xhtml 1.0)</p><p>I would appreciate some suggestions as I can't understand the logic of the clean function code, sorry.</p><p>Thank you in advance.</p><p>JQuery's Clean function code</p><p>****************************</p><p>	clean: function( elems, context, fragment, scripts ) {</p><p>		var checkScriptType;</p><p>		context = context || document;</p><p>		 !context.createElement fails in IE with an error but returns typeof 'object'</p><p>		if ( typeof context.createElement === "undefined" ) {</p><p>			context = context.ownerDocument || context[0] && context[0].ownerDocument || document;</p><p>		}</p><p>		var ret = [], j;</p><p>		for ( var i = 0, elem; (elem = elems[i]) != null; i++ ) {</p><p>			if ( typeof elem === "number" ) {</p><p>				elem += "";</p><p>			}</p><p>			if ( !elem ) {</p><p>				continue;</p><p>			}</p><p>			<em> Convert html string into DOM nodes</em></p><p>			if ( typeof elem === "string" ) {</p><p>				if ( !rhtml.test( elem ) ) {</p><p>					elem = context.createTextNode( elem );</p><p>				} else {</p><p>					 Fix "XHTML"-style tags in all browsers</p><p>					elem = elem.replace(rxhtmlTag, "&lt;$1&gt;&lt;/$2&gt;");</p><p>					<em> Trim whitespace, otherwise indexOf won't work as expected</em></p><p>					var tag = (rtagName.exec( elem ) || ["", ""])[1].toLowerCase(),</p><p>						wrap = wrapMap[ tag ] || wrapMap._default,</p><p>						depth = wrap[0],</p><p>						div = context.createElement("div");</p><p>					 Go to html and back, then peel off extra wrappers</p><p>					div.innerHTML = wrap[1] + elem + wrap[2];</p><p>					<em> Move to the right depth</em></p><p>					while ( depth-- ) {</p><p>						div = div.lastChild;</p><p>					}</p><p>					 Remove IE's autoinserted &lt;tbody&gt; from table fragments</p><p>					if ( !jQuery.support.tbody ) {</p><p>						<em> String was a &lt;table&gt;, *may* have spurious &lt;tbody&gt;</em></p><p>						var hasBody = rtbody.test(elem),</p><p>							tbody = tag === "table" && !hasBody ?</p><p>								div.firstChild && div.firstChild.childNodes :</p><p>								 String was a bare &lt;thead&gt; or &lt;tfoot&gt;</p><p>								wrap[1] === "&lt;table&gt;" && !hasBody ?</p><p>									div.childNodes :</p><p>									[];</p><p>						for ( j = tbody.length - 1; j &gt;= 0 ; --j ) {</p><p>							if ( jQuery.nodeName( tbody[ j ], "tbody" ) && !tbody[ j ].childNodes.length ) {</p><p>								tbody[ j ].parentNode.removeChild( tbody[ j ] );</p><p>							}</p><p>						}</p><p>					}</p><p>					// IE completely kills leading whitespace when innerHTML is used</p><p>					if ( !jQuery.support.leadingWhitespace && rleadingWhitespace.test( elem ) ) {</p><p>						div.insertBefore( context.createTextNode( rleadingWhitespace.exec(elem)[0] ), div.firstChild );</p><p>					}</p><p>					elem = div.childNodes;</p><p>				}</p><p>			}</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 07, 2011 07:09AM UTC by <span class="author">anonymous</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>SOLVED:</p><p>JQuery raises "o is null" or "div is null" during the "clean" action with an XHTML page that uses JQuery and JQuery UI with the XML processing instruction at the top.</p><p>The behaviour of JQuery is correct to identify an XML processable document using the processing instruction, but XHTML is actually an XML file and it is correct to use the processing instruction or it as well. </p><p>I really think JQuery should look at the doctype to verify if it is an XHTML page before reading the page as XML.</p><p>This way JQueryUI doesn't work:</p><p>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</p><p>&lt;!DOCTYPE html PUBLIC "-<em>W3C</em>DTD XHTML.............</p><p>This is ok.</p><p>&lt;!DOCTYPE html PUBLIC "-<em>W3C</em>DTD XHTML.............</p><p>Hope this help</p><p>Roberto</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
