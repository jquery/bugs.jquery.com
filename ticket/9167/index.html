<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#9167 (jq1.6 in ie6 memory leak bug) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/9166/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/9168/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#9167</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(worksforme)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened May 07, 2011 03:31PM UTC</p>
      
        <p>Closed May 10, 2011 05:38AM UTC</p>
      
      
        <p>Last modified March 14, 2012 07:01AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">jq1.6 in ie6 memory leak bug</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        dongdongface
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        undecided
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.next">1.next</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>misc</td>
      
        <th>Version:</th>
      
      <td>1.6</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>test file: jq1.52 and jq1.6</p><p>browser: ie6(win)</p><p>ie6 default memory state</p><p>jq1.52 in ie6  default memory:~22MB</p><p>jq1.6 in ie6  default memory:~22MB</p><p>ie6 refresh page 10 times after memory state</p><p>jq1.52 in ie6  memory:~23MB</p><p>jq1.6 in ie6   memory:~30MB (memory leak)</p><p>test snap pic:</p><p>[[Image(www.cssjs.com/jq6inIE6bug.gif)]]</p><p>www.cssjs.com/jq6inIE6bug.gif</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (5)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 07, 2011 03:54PM UTC by <span class="author">dongdongface</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">test file: jq1.52 and jq1.6 &#92;
&#92;
browser: ie6(win)&#92;
&#92;
&#92;
&#92;
ie6 default memory state &#92;
&#92;
jq1.52 in ie6 default memory:~22MB &#92;
&#92;
jq1.6 in ie6 default memory:~22MB&#92;
&#92;
&#92;
&#92;
&#92;
ie6 refresh page 10 times after memory state &#92;
&#92;
jq1.52 in ie6 memory:~23MB &#92;
&#92;
jq1.6 in ie6 memory:~30MB (memory leak)&#92;
&#92;
&#92;
test snap pic:  www.cssjs.com/jq6inIE6bug.gif</span> → <span class="change-field-new">1304783723612682</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment1:</th>
                  <td>
                    
                      <span class="change-field-old">test file: jq1.52 and jq1.6 &#92;
&#92;
browser: ie6(win)&#92;
&#92;
&#92;
----------------------------------------------&#92;
ie6 default memory state &#92;
&#92;
jq1.52 in ie6 default memory:~22MB &#92;
&#92;
jq1.6 in ie6 default memory:~22MB&#92;
&#92;
&#92;
&#92;
----------------------------------------------&#92;
ie6 refresh page 10 times after memory state &#92;
&#92;
jq1.52 in ie6 memory:~23MB &#92;
&#92;
jq1.6 in ie6 memory:~30MB (memory leak)&#92;
&#92;
----------------------------------------------&#92;
test snap pic:  www.cssjs.com/jq6inIE6bug.gif</span> → <span class="change-field-new">1304783925709448</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>_comment2:</th>
                  <td>
                    
                      <span class="change-field-old">test file: jq1.52 and jq1.6 &#92;
&#92;
browser: ie6(win)&#92;
&#92;
&#92;
----------------------------------------------&#92;
ie6 default memory state &#92;
&#92;
jq1.52 in ie6 default memory:~22MB &#92;
&#92;
jq1.6 in ie6 default memory:~22MB&#92;
&#92;
&#92;
&#92;
----------------------------------------------&#92;
ie6 refresh page 10 times after memory state &#92;
&#92;
jq1.52 in ie6 memory:~23MB &#92;
&#92;
jq1.6 in ie6 memory:~30MB (memory leak)&#92;
&#92;
----------------------------------------------&#92;
test snap pic:  [[Image(http://www.cssjs.com/jq6inIE6bug.gif)]]</span> → <span class="change-field-new">1304783977780242</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
        
          
        
          
            <div class="ticket-comment-body">
              <p>test file: jq1.52 and jq1.6 </p><p>browser: ie6(win)</p><p></p><hr><p></p><p>ie6 default memory state </p><p>jq1.52 in ie6 default memory:~22MB </p><p>jq1.6 in ie6 default memory:~22MB</p><p></p><hr><p></p><p>ie6 refresh page 10 times after memory state </p><p>jq1.52 in ie6 memory:~23MB </p><p>jq1.6 in ie6 memory:~30MB (memory leak)</p><p></p><hr><p></p><p>test snap pic: www.cssjs.com/jq6inIE6bug.gif</p><p> [[Image(<a href="http://www.cssjs.com/jq6inIE6bug.gif)" class="ext-link"><span class="icon"></span>http://www.cssjs.com/jq6inIE6bug.gif)</a>]]</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 10, 2011 05:38AM UTC by <span class="author">addyosmani</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">misc</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ worksforme</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks for submitting a ticket to the jQuery Project!. I've put together the code you provided here <a href="http://jsfiddle.net/jNHh3/1" class="ext-link"><span class="icon"></span>http://jsfiddle.net/jNHh3/1</a> - it's not really much more than $(document).ready({}), however haven't been able to replicate the memory leak mentioned even with 10 refreshes in IE6.</p><p>Simply including jQuery 1.6 in the page is very unlikely to cause memory leaks and as there isn't any real additional logic going on in your test, I'm more likely to think that the memory spike in the 1.6 test is due to excessively fast refreshing, where IE may be still attempting some level of garbage collection before being asked to render the same page again.</p><p>With that in mind, we'll be closing this ticket, however if you can provide any additional stats or tests that can help us reproduce the issue, we'll happily re-investigate. There are a number of tools designed just for the purpose of IE memory leak detection and some provide a little more reporting which would also be useful to look at.</p>
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 17, 2011 02:41PM UTC by <span class="author">nonos</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I've got the same problem under IE6.</p><p>Simply including jQuery 1.6 causes memory leaks (you can see it with Drip).</p><p>Can you reopen it please ?</p><p>Sincerely,</p><p>Nonos</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 19, 2011 04:37PM UTC by <span class="author">chris@theguidrys.us</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Hi guys, please reopen this ticket, since I've actually got a fix for this:</p><p>At the very end of the jQuery.support setup (around lines 1137-1373 in my copy of jquery-1.6.1.js), simply null out the enclosed variables that are holding the temporary DOM references:</p><pre class="wiki">
	
    // CAG 2011.08.19: clean up temporary DOM elements
    body = null;
    div = null;
    documentElement = null;
    all = null;
    a = null;
    select = null;
    opt = null;
    input = null;
    marginDiv = null;
    fragment = null;
    body = null;
    bodyStyle = null;
    tds = null;
    events = null;
    // end patch

    return support;
})();

</pre><p>Using Drip, I've confirmed that the leak in IE6 exists in an unpatched jQuery 1.6.1, and that the leaked DOM references are exactly the elements created during the jQuery.support setup.  With the patch above to null out all those enclosed variables, the leak goes away.</p><p>Thanks!</p><p>Chris</p><p>Replying to [comment:3 nonos]:</p><blockquote> I've got the same problem under IE6.  Simply including jQuery 1.6 causes memory leaks (you can see it with Drip).  Can you reopen it please ?  Sincerely, Nonos</blockquote>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 19, 2011 04:47PM UTC by <span class="author">chris@theguidrys.us</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Hi, addyosmani,</p><p>This bug is definitely reproducible by only including jQuery 1.6.1 in a page and not invoking any jQuery code directly.  The thing is that it appears you need a specific version of IE6.  I know, I know, IE6 is dead, except it actually isn't.  My application must run on the version of IE6 included on Windows CE 5 (sigh, horrible, I know) which exhibits this problem, but I'm also reproducing this quite easily on a clean non-updated VM of Windows XP with IE6.  The only additional software I've installed is Drip, but I haven't updated the browser at all from the stock version on Windows XP.</p><p>Please see my patch above and consider it.  It's totally harmless in any other browser, allows for some more eager garbage collection, and most importantly, fixes a very atrocious memory leak (one that causes the entire document to be leaked between refreshes) in IE6.</p><p>This is the entire test case that I'm running through Drip to reproduce this:</p><pre class="wiki">
&lt;html&gt;
    &lt;head&gt;
        &lt;script type="text/javascript" src="../media/libraries/jquery-1.6.1.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;/body&gt;
&lt;/html&gt;
</pre><p>Thanks!</p><p>Chris</p><p>Replying to [comment:2 addyosmani]:</p><blockquote> Thanks for submitting a ticket to the jQuery Project!. I've put together the code you provided here <a href="http://jsfiddle.net/jNHh3/1" class="ext-link"><span class="icon"></span>http://jsfiddle.net/jNHh3/1</a> - it's not really much more than $(document).ready({}), however haven't been able to replicate the memory leak mentioned even with 10 refreshes in IE6.  Simply including jQuery 1.6 in the page is very unlikely to cause memory leaks and as there isn't any real additional logic going on in your test, I'm more likely to think that the memory spike in the 1.6 test is due to excessively fast refreshing, where IE may be still attempting some level of garbage collection before being asked to render the same page again.  With that in mind, we'll be closing this ticket, however if you can provide any additional stats or tests that can help us reproduce the issue, we'll happily re-investigate. There are a number of tools designed just for the purpose of IE memory leak detection and some provide a little more reporting which would also be useful to look at.</blockquote>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
