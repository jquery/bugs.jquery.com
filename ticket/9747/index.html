<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#9747 (:first selector behaves inconsistently in chained find() invocations) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/9746/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/9748/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#9747</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened July 05, 2011 06:47PM UTC</p>
      
        <p>Closed July 05, 2011 08:15PM UTC</p>
      
      
        <p>Last modified July 06, 2011 04:19PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">:first selector behaves inconsistently in chained find() invocations</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        hallettj
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.next">1.next</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>selector</td>
      
        <th>Version:</th>
      
      <td>1.6.1</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Affects every version of jQuery that I tested: 1.2.6, 1.3.2, 1.4.4, 1.5.2, 1.6.1.</p><p>Reproduced in Chrome  beta under Ubuntu 11.04.</p><p>Steps to reproduce:</p><p>1. Create HTML structure with multiple elements, such as a list.</p><p>3. Construct a jQuery selector that selects some or all of those elements, such as $('li').</p><p>2. Use a find() invocation on the previously selected elements with a selector that matches some nested element and include the expression ":first" in that selector.  For example, $('li').find('a:first').</p><p>Expected results:</p><p>The first matched nested element is returned from the find() invocation.  In the case of a list where nested elements are single anchor tags, the anchor tag in the first list element is returned.</p><p>Actual results:</p><p>Every nested element matching the given selectors is returned.  It is as though ":first" has no effect on result of the find() invocation.</p><p>jsfiddle test case: </p><p>If I combine both selectors into one jQuery() call instead of using a chained find() invocation then the result is as I expect.  For example, <code>$('li a:first')</code> returns a single anchor tag: the one in the first list item.  But <code>$('li').find('a:first')</code> returns every anchor tag in every list item - assuming that each list item has at most one anchor tag.</p><p>Maybe this is intended behavior.  But it is really not what I expected.  If this is intended behavior it would be helpful to have a note in the documentation for :first, :eq, or find() that explains the discrepancy.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (7)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 05, 2011 08:15PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">selector</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I reduced your test even further and there is nothing inconsistent about it: <a href="http://jsfiddle.net/rwaldron/XBM2w/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/rwaldron/XBM2w/</a></p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 06, 2011 12:23AM UTC by <span class="author">hallettj</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:1 rwaldron]:</p><blockquote> I reduced your test even further and there is nothing inconsistent about it: <a href="http://jsfiddle.net/rwaldron/XBM2w/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/rwaldron/XBM2w/</a></blockquote><p>The inconsistency is that I expected $(selectorA + " " + selectorB) to be equivalent to $(selectorA).find(selectorB) in every case.  Finding out that that is not true is very surprising.  If this is really not the way that find() is supposed to work there should be an explanation in the documentation as the current behavior is not obvious.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 06, 2011 03:54AM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The description in the api is quite clear:</p><blockquote> Description: Get the descendants of each element in the current set of matched elements, filtered by a selector,  jQuery object, or element.</blockquote>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 06, 2011 07:31AM UTC by <span class="author">hallettj</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">What is not clear is the scope of the selectors in the find() call.  Consider that, at least in a case where every &#39;li&#39; has an &#39;a&#39; descendant, $(&#39;li a:first&#39;) and $(&#39;li:first a&#39;) produce the same results.  This implies that &#39;:first&#39; scopes over the entire result set, not just to the results of traversing an individual &#39;li&#39; tag.  So when I run $(&#39;li&#39;).find(&#39;a:first&#39;) I expect &#39;:first&#39; to limit the entire result set to one element.  But instead I get three elements.  This time &#39;:first&#39; *is* scoped to the results of traversing an individual &#39;li&#39; tag.  To my view the scope of &#39;:first&#39; is inexplicably inverted when used in find().&#92;
&#92;
I understand now that find() probably makes separate selections against the descendants of each &#39;li&#39; tag and that &#39;:first&#39; is probably scoped to the results each individual selection.  But I was only able to come to that conclusion because of my investigation of find() behavior for this issue report.&#92;
&#92;
The documentation for &#39;:eq()&#39; says,&#92;
&#92;
  Select the element at index n within the matched set.&#92;
&#92;
It does not give any indication that in the case of find() there will be a separate &quot;matched set&quot; corresponding to each element in the original selection, and that &#39;:eq()&#39; will apply to each such set individually before those sets are unioned and returned.  But the actual behavior of &#39;:first&#39; and &#39;:eq()&#39; in find() seems to indicate that this is a more accurate description.&#92;
&#92;
I do not believe that the docs provide any information to clarify this point.  Furthermore, in my opinion the behavior as it is implemented is counter-intuitive and is a bug.</span> → <span class="change-field-new">1309937654279707</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>What is not clear is the scope of the selectors in the find() call.  Consider that, at least in a case where every 'li' has an 'a' descendant, $('li a:first') and $('li:first a') produce the same results.  This implies that ':first' scopes over the entire result set, not just to the results of traversing an individual 'li' tag.  So when I run $('li').find('a:first') I expect ':first' to limit the entire result set to one element.  But instead I get three elements.  This time ':first' *is* scoped to the results of traversing an individual 'li' tag.  To my view the scope of ':first' is inexplicably inverted when used in find().</p><p>I understand now that find() probably makes separate selections against the descendants of each 'li' tag and that ':first' is probably scoped to the results each individual selection.  But I was only able to come to that conclusion because of my investigation of find() behavior for this issue report.</p><p>The documentation for ':eq()' says,</p><blockquote> Select the element at index n within the matched set.</blockquote><p>It does not give any indication that in the case of find() there will be a separate "matched set" corresponding to each element in the original selection, and that ':eq()' will apply to each such set individually before those sets are unioned and returned.  But the actual behavior of ':first' and ':eq()' in find() seems to indicate that this is a more accurate description.</p><p>I do not believe that the docs provide any information to clarify this point.  Furthermore, in my opinion the behavior as it is implemented is counter-intuitive and is a bug.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 06, 2011 01:40PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">Affects every version of jQuery that I tested: 1.2.6, 1.3.2, 1.4.4, 1.5.2, 1.6.1.&#92;
&#92;
Reproduced in Chrome 13.0.782.32 beta under Ubuntu 11.04.&#92;
&#92;
Steps to reproduce:&#92;
&#92;
1. Create HTML structure with multiple elements, such as a list.&#92;
3. Construct a jQuery selector that selects some or all of those elements, such as $(&#39;li&#39;).&#92;
2. Use a find() invocation on the previously selected elements with a selector that matches some nested element and include the expression &quot;:first&quot; in that selector.  For example, $(&#39;li&#39;).find(&#39;a:first&#39;).&#92;
&#92;
Expected results:&#92;
&#92;
The first matched nested element is returned from the find() invocation.  In the case of a list where nested elements are single anchor tags, the anchor tag in the first list element is returned.&#92;
&#92;
Actual results:&#92;
&#92;
Every nested element matching the given selectors is returned.  It is as though &quot;:first&quot; has no effect on result of the find() invocation.&#92;
&#92;
jsfiddle test case: http://jsfiddle.net/hallettj/q9zfd/1/&#92;
&#92;
If I combine both selectors into one jQuery() call instead of using a chained find() invocation then the result is as I expect.  For example, `$(&#39;li a:first&#39;)` returns a single anchor tag: the one in the first list item.  But `$(&#39;li&#39;).find(&#39;a:first&#39;)` returns every anchor tag in every list item - assuming that each list item has at most one anchor tag.&#92;
&#92;
Maybe this is intended behavior.  But it is really not what I expected.  If this is intended behavior it would be helpful to have a note in the documentation for :first, :eq, or find() that explains the discrepancy.</span> → <span class="change-field-new">Affects every version of jQuery that I tested: 1.2.6, 1.3.2, 1.4.4, 1.5.2, 1.6.1.&#92;
&#92;
Reproduced in Chrome  beta under Ubuntu 11.04.&#92;
&#92;
Steps to reproduce:&#92;
&#92;
1. Create HTML structure with multiple elements, such as a list.&#92;
3. Construct a jQuery selector that selects some or all of those elements, such as $(&#39;li&#39;).&#92;
2. Use a find() invocation on the previously selected elements with a selector that matches some nested element and include the expression &quot;:first&quot; in that selector.  For example, $(&#39;li&#39;).find(&#39;a:first&#39;).&#92;
&#92;
Expected results:&#92;
&#92;
The first matched nested element is returned from the find() invocation.  In the case of a list where nested elements are single anchor tags, the anchor tag in the first list element is returned.&#92;
&#92;
Actual results:&#92;
&#92;
Every nested element matching the given selectors is returned.  It is as though &quot;:first&quot; has no effect on result of the find() invocation.&#92;
&#92;
jsfiddle test case: &#92;
&#92;
If I combine both selectors into one jQuery() call instead of using a chained find() invocation then the result is as I expect.  For example, `$(&#39;li a:first&#39;)` returns a single anchor tag: the one in the first list item.  But `$(&#39;li&#39;).find(&#39;a:first&#39;)` returns every anchor tag in every list item - assuming that each list item has at most one anchor tag.&#92;
&#92;
Maybe this is intended behavior.  But it is really not what I expected.  If this is intended behavior it would be helpful to have a note in the documentation for :first, :eq, or find() that explains the discrepancy.</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-new">→ needsdocs</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Just because you says it's a bug, does not make it a bug.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 06, 2011 03:00PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">&gt; Consider that, at least in a case where every &#39;li&#39; has an &#39;a&#39; descendant, $(&#39;li a:first&#39;) and $(&#39;li:first a&#39;) produce the same results. This implies that &#39;:first&#39; scopes over the entire result set, not just to the results of traversing an individual &#39;li&#39; tag.&#92;
&#92;
No it doesn&#39;t. Look at the case where the first &#39;li&#39; does not have an &#39;a&#39; descendant. http://jsfiddle.net/dmethvin/PSnPQ/&#92;
&#92;
&gt; To my view the scope of &#39;:first&#39; is inexplicably inverted when used in find(). &#92;
&#92;
The `find()` method finds one &quot;first&quot; in the matched set that it works on, assuming there is one at all. &#92;
&#92;
&#92;
In any case, it&#39;s worked this way since jQuery 1.0 and we&#39;ve never had any other confusion about it, so I&#39;m going to remove the `needsdocs`. Any attempt to explain would need to be duplicated across all the positional selectors (eq, lt, gt, first, last) and IMO only make the docs more difficult to understand. </span> → <span class="change-field-new">1309964469020913</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">needsdocs</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <blockquote> Consider that, at least in a case where every 'li' has an 'a' descendant, $('li a:first') and $('li:first a') produce the same results. This implies that ':first' scopes over the entire result set, not just to the results of traversing an individual 'li' tag.</blockquote><p>No it doesn't. Look at the case where the first 'li' does not have an 'a' descendant. <a href="http://jsfiddle.net/dmethvin/PSnPQ/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/dmethvin/PSnPQ/</a></p><blockquote> To my view the scope of ':first' is inexplicably inverted when used in find(). </blockquote><p>The <code>find()</code> method finds one "first" in each element of the matched set that it works on, assuming there is one at all. </p><p>In any case, it's worked this way since jQuery 1.0 and we've never had any other confusion about it, so I'm going to remove the <code>needsdocs</code>. Any attempt to explain would need to be duplicated across all the positional selectors (eq, lt, gt, first, last) and IMO only make the docs more difficult to understand. </p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 06, 2011 04:19PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Dave, while I'm 100% in agreement with you, what do you think about a single page that offers insight as you have above re: positional selectors. That way we could link all of those docs to a single reference?</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
