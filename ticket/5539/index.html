<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#5539 (Event target is wrong on DOMCharacterDataModified) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/5538/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/5540/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#5539</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened November 20, 2009 05:45PM UTC</p>
      
        <p>Closed October 29, 2010 04:43PM UTC</p>
      
      
        <p>Last modified November 05, 2010 02:35AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Event target is wrong on DOMCharacterDataModified</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        hesselink
      </td>
      <th>Owned by:</th>
      <td>hesselink</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.4">1.4</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>event</td>
      
        <th>Version:</th>
      
      <td>1.3.2</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>If you bind the DOMCharacterDataModified event, the event object your handler gets has the wrong target (the parent node instead of the text node). This is because of these lines:</p><pre class="wiki">
// check if target is a textnode (safari)
if ( event.target.nodeType == 3 )
  event.target = event.target.parentNode;
</pre><p>Since there are other events, like DOMNodeInsertedIntoDocument and DOMNodeRemovedFromDocument that might want a text node as a target, I added the following to fix it:</p><pre class="wiki">
 && event.type.slice(0,3) != "DOM"
</pre></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (14)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 25, 2010 03:11AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>That's a tough one, I'm not sure you want event.target pointing to a text node in most cases. </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 27, 2010 11:05PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-old">brandon</span> → <span class="change-field-new">hesselink</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">pending</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Please provide a distilled and reduced jsFiddle test case, thanks!</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 05:48AM UTC by <span class="author">hesselink</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">pending</span> → <span class="change-field-new">new</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'm not sure what you want me to do, or why. Was my explanation not clear enough?</p><p>If you bind a DOMCharacterDataModified event (using jQuery.bind), and a text node has its character data modified, you get an event, but not with the text node as a target, but its parent. This is not what you generally want, because there can be multiple text nodes in the parent, and you have no way to figure out which one it is.</p><p>This is generally what you want for all DOM mutation events. That is why my fix changed the jQuery behaviour (which, according to the source comment, works around a bug in Safari) changed only the behaviour of events where the name starts with DOM. So this doesn't change anything in 'most cases', only in a few very specific ones (i.e. DOM mutation events).</p><p>I'm not sure how me writing code in jsFiddle (which I'm not familiar with) would be a good investment of my or your time. If you can explain why it is, please do.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 07:34AM UTC by <span class="author">hesselink</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>See also <a href="http://github.com/typLAB/jquery/commit/6284b37914e3f4d6634e37cbf93d76d1dc6ee3bd." class="ext-link"><span class="icon"></span>http://github.com/typLAB/jquery/commit/6284b37914e3f4d6634e37cbf93d76d1dc6ee3bd.</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 12:33PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-new">→ needsreview</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">major</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Creating and submitting a jsFiddle that illustrates the behavior that you're reporting saves us the time of trying to recreate your issue based on your description. It also expedites the review process for your issue - faster in, faster out.</p><p>Additionally, jQuery does not have documented support for the DOM <a href="/wiki/MutationEvents">MutationEvents</a> and therefore cannot be accountable for unexpected behavior when attempting to use them.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 12:46PM UTC by <span class="author">hesselink</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Is there any chance you will accept this fix if I take the time to learn this tool and write a test case, given that you state that there is no documented support for DOM mutation events?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 12:51PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I can't guarantee anything, but I can say with confidence that contributions are taken into further consideration with more frequence then just requests</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 02:37PM UTC by <span class="author">hesselink</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Allright, here it is: <a href="http://jsfiddle.net/58gD4/1/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/58gD4/1/</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 04:43PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Thanks for that.</p><p>I've further reduced the test here: <a href="http://jsfiddle.net/rwaldron/RfHZP/2/" class="ext-link"><span class="icon"></span>http://jsfiddle.net/rwaldron/RfHZP/2/</a></p><p>I'd like to note that you're binding an event handler to the div, so logically - the div is your target.</p><p>Additionally, it's not wise for jQuery core to normalize APIs that have been deprecated in the standards bodies. See here:  <a href="http://dev.w3.org/2006/webapi/DOM-Level-3-Events/html/DOM3-Events.html#events-mutationevents" class="ext-link"><span class="icon"></span>http://dev.w3.org/2006/webapi/DOM-Level-3-Events/html/DOM3-Events.html#events-mutationevents</a></p><p>Again, thank you for taking the time to put this test case together.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 04:46PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/6785">#6785</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 05:31PM UTC by <span class="author">hesselink</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Couldn't you have decided that before I invested time in the test case? It added nothing useful if you had just read the ticket. The event bubbles, by the way, so the target is not always the node it is bound to.</p><p>I must say I am very dissatisfied with how jquery has treated me. I had a fix that worked for me. I thought I'd be a good citizen and contribute the patch back. I've been ignored for 11 months, then I received an automated response that I had to write a test, only to spend time on it and promptly have the bug marked invalid. This is no way to treat your community.</p><p>You could have read the bug 11 months ago, and told me you wouldn't fix it because it is about DOM mutation events. You could have read the bug before telling me to write a test case. You could have told me you probably wouldn't accept the patch. Instead, you led me on, acted disinterested, and made it very unlikely I'll ever contribute again.</p><p>Throughout the process, I've felt I was working against the jquery people, who didn't want my contribution. I'd like to work with them, helping them understand the issue, and them helping me get a patch into shape. This whole thing left a very bad taste in my mouth.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 29, 2010 07:10PM UTC by <span class="author">ajpiano</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">hesselink, the jQuery project is very happy to have contributions from the community.  The reply you received was not automated, but rather the result of a recent, concerted effort to deal with the glut of backlogged tickets on the bug tracker, Part of that effort includes having standards for what the people handling ticket triage will and will not handle, and that entails having a test case of the behaviour.  Just because this patch was not accepted does not mean your contributions, in general, are unwelcome.  It is rather indicative of the simple fact that just because something works for a particular user in a particular application, that does not mean it is necessarily an appropriate fix to be landed in the library that will be distributed to all users, everywhere.&#92;
&#92;
Yes, we could have rejected the ticket out of hand just because it had anything to do with mutation events, but with a solid test case, at least we have something to refer back to in the future.  And we know that it is problematic that there are backlogged bugs, like this one - but dealing with them now is better than leaving them completely ignored. No one was leading you on, and there is a big difference between &quot;not wanting your contribution&quot; and &quot;not adding support for this particular issue.&quot;  &#92;
&#92;
The new ticket triaging effort has, in fact, been spearheaded by community members who are doing much of the review and analysis of tickets, in coordination with a number of team members.  Thus, I hope you will reconsider your decision to remove yourself from this process entirely, and reevaluate whether you really think that the interaction you had with respect to this ticket is truly &quot;no way to treat the community,&quot; in light of the facts that I have shared. </span> → <span class="change-field-new">1288379796046804</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>hesselink, the jQuery project is very happy to have contributions from the community.  The reply you received was not automated, but rather the result of a recent, concerted effort to deal with the over 1500 backlogged ticket on the bug tracker, Part of that effort includes having standards for what the people handling ticket triage will and will not handle, and that entails having a test case of the behaviour.  Just because this patch was not accepted does not mean your contributions, in general, are unwelcome.  It is rather indicative of the simple fact that just because something works for a particular user in a particular application, that does not mean it is necessarily an appropriate fix to be landed in the library that will be distributed to all users, everywhere.</p><p>Yes, we could have rejected the ticket out of hand just because it had anything to do with mutation events, but with a solid test case, at least we have something to refer back to in the future.  And we know that it is problematic that there are backlogged bugs, like this one - but dealing with them now is better than leaving them completely ignored. No one was leading you on, and there is a big difference between "not wanting your contribution" and "not adding support for this particular issue."  </p><p>The new ticket triaging effort has, in fact, been spearheaded by community members who are doing much of the review and analysis of tickets, in coordination with a number of team members.  Thus, I hope you will reconsider your decision to remove yourself from this process entirely, and reevaluate whether you really think that the interaction you had with respect to this ticket is truly "no way to treat the community," in light of the facts that I have shared. </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 01, 2010 09:03AM UTC by <span class="author">hesselink</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I understand the need for some process. However, in this case I feel that you traded my time for your process, which doesn't seem to add anything. This doesn't sound appealing for me, which is why I said I wouldn't contribute in the future.</p><p>I specifically asked if there was any chance you would accept this patch with a test case, since you already said jQuery didn't 'support' DOM mutation events. The reply could just have said: the chance we'll accept a patch concerning DOM mutation evens is very low. I wouldn't have wasted my time on a test case, and the outcome would have been the same.</p><p>I want to make very clear that my annoyance is not about my patch not being accepted. We have a local fork of jQuery which we will keep using, regardless of this patch being accepted. I'm annoyed with the strict adherence to process, without any regard for the specific contents of the bug.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 05, 2010 02:35AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">needsreview</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
