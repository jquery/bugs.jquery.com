<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#6500 (document.domain + IE6 + jQuery 1.4.x = &amp;quot;Permission denied&amp;quot; error) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/6499/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/6501/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#6500</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(worksforme)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened April 28, 2010 03:54PM UTC</p>
      
        <p>Closed June 15, 2010 01:37AM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">document.domain + IE6 + jQuery 1.4.x = &quot;Permission denied&quot; error</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        cowboy
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.4.3">1.4.3</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>unfiled</td>
      
        <th>Version:</th>
      
      <td>1.4.2</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>After setting <code>document.domain</code>, I get a "Permission denied" error when accessing the <code>location.hash</code> properties immediately or in DOM ready in IE6 if jQuery 1.4.x is included in the page.</p><p>Test-cases:</p> <ul><li>jQuery 1.4.2: <a href="http://benalman.com/code/test/jquery-142-document-domain-ie6.html" class="ext-link"><span class="icon"></span>http://benalman.com/code/test/jquery-142-document-domain-ie6.html</a></li> <li>jQuery 1.3.2: <a href="http://benalman.com/code/test/jquery-132-document-domain-ie6.html" class="ext-link"><span class="icon"></span>http://benalman.com/code/test/jquery-132-document-domain-ie6.html</a></li></ul><p>Sample code</p><pre class="wiki">
&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  
  document.domain = document.domain.split('.').slice(-2).join('.');
  
  var results = [];
  
  // Error!
  try {
    results.push( 'Immediate: ' + location.href );
  } catch(e) {
    results.push( 'Immediate: ' + e.message )
  }
  
  // Error when executed in the body, but not in the head!
  $(function(){
    try {
      results.push( 'DOMready: ' + location.href );
    } catch(e) {
      results.push( 'DOMready: ' + e.message )
    }
  });
  
  // No error!
  setTimeout(function(){
    try {
      results.push( 'setTimeout: ' + location.href );
    } catch(e) {
      results.push( 'setTimeout: ' + e.message )
    }
  }, 100);
  
  setTimeout(function(){
    alert( results.join( "\\n---\\n" ) );
  }, 1000);
  
&lt;/script&gt;
</pre></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (11)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 28, 2010 04:03PM UTC by <span class="author">cowboy</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>It's not just IE6, but IE7 too. IE8 and IE8-compat mode seem to work fine. My observations:</p><h2>jQuery 1.4.2:</h2><p>IE6</p> <ul><li>Immediate: ERROR</li> <li>DOMready: ERROR</li> <li>setTimeout: success</li></ul><p>IE7</p> <ul><li>Immediate: ERROR</li> <li>DOMready: success</li> <li>setTimeout: success</li></ul><h2>jQuery 1.3.2:</h2><p>IE6</p> <ul><li>Immediate: success</li> <li>DOMready: success</li> <li>setTimeout: success</li></ul><p>IE7</p> <ul><li>Immediate: success</li> <li>DOMready: success</li> <li>setTimeout: success</li></ul>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 28, 2010 04:11PM UTC by <span class="author">cowboy</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>And as I said in my code comments, I get slightly different results depending on whether all this code is in the head vs the body.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 28, 2010 04:19PM UTC by <span class="author">miketaylr</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>For me, i get permission denied for all three (Immediate, DOMReady, and setTimeout) for both 1.3.2 and 1.4.x in IE7.</p><p>I get the same behavior in IE6 that "cowboy" describes--error, error, success w/ 1.4, and success, success, success in 1.3.2.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 28, 2010 04:27PM UTC by <span class="author">iansym</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>my results on M$ <a href="/wiki/VirtualPC">VirtualPC</a> images for IE6</p><p>1.4.2 <a href="http://gyazo.com/de413d08913bb2f55299149abb482f34.png" class="ext-link"><span class="icon"></span>http://gyazo.com/de413d08913bb2f55299149abb482f34.png</a></p><p>1.3.2 <a href="http://gyazo.com/b4fae7d18905f5e15cb2db57c58e8faa.png" class="ext-link"><span class="icon"></span>http://gyazo.com/b4fae7d18905f5e15cb2db57c58e8faa.png</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 28, 2010 04:30PM UTC by <span class="author">iansym</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>my results on M$ <a href="/wiki/VirtualPC">VirtualPC</a> images for IE7</p><p>1.4.2 <a href="http://gyazo.com/f3021d51e530d6f336f69fa20927fd0e.png" class="ext-link"><span class="icon"></span>http://gyazo.com/f3021d51e530d6f336f69fa20927fd0e.png</a></p><p>1.3.2 <a href="http://gyazo.com/e13102bbf1a7895c182192a8e62a1d81.png" class="ext-link"><span class="icon"></span>http://gyazo.com/e13102bbf1a7895c182192a8e62a1d81.png</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 29, 2010 09:14AM UTC by <span class="author">Qwerios</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Tested with:</p><p>Internet Explorer 6 (6.0.2900.5512.xpsp.080413-2111)</p><p>Windows XP SP3 </p><p><a href="/wiki/VirtualBox">VirtualBox</a> 3.1.6</p><p>Getting some freaky results here... </p><p>JQUERY 1.4.2:</p><p>IE6 (1st time)</p><p>Immediate: ERROR</p><p>DOMready: success</p><p>setTimeout: success</p><p>(page reload after 1st try)</p><p>Immediate: ERROR</p><p>DOMready: ERROR</p><p>setTimeout: ERROR</p><p>(close browser, 2nd try)</p><p>Immediate: ERROR</p><p>DOMready: success</p><p>setTimeout: success</p><p>(reload after 2nd try)</p><p>Immediate: success</p><p>DOMready: success</p><p>setTimeout: success</p><p>(close browser, empty cache, 3rd try)</p><p>Immediate: ERROR</p><p>DOMready: ERROR</p><p>setTimeout: success</p><p>(reload after 3rd try)</p><p>Immediate: success</p><p>DOMready: success</p><p>setTimeout: success</p><p>JQUERY 1.3.2:</p><p>IE6 (1st time)</p><p>Immediate: success</p><p>DOMready: success</p><p>setTimeout: success</p><p>Every reload using 1.3.2 gives different results. I've had 1x ERROR, 2x ERROR, 3x ERROR and all success with no apparent pattern. But the first load after closing the browser is always 3x succes.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 03, 2010 06:57PM UTC by <span class="author">cowboy</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I wasn't using .splice correctly in my initial examples. I have since fixed my tests, but they still fail (albeit, in different places) for me in IE6 and IE7 (and work perfectly in IE8):</p><p>jQuery 1.4.2  </p><p><a href="http://benalman.com/code/test/jquery-142-document-domain-fixed.html" class="ext-link"><span class="icon"></span>http://benalman.com/code/test/jquery-142-document-domain-fixed.html</a></p><p>jQuery 1.3.2  </p><p><a href="http://benalman.com/code/test/jquery-132-document-domain-fixed.html" class="ext-link"><span class="icon"></span>http://benalman.com/code/test/jquery-132-document-domain-fixed.html</a></p><h2>JQUERY 1.4.2:</h2><p>IE6</p><p>Immediate: ERROR</p><p>DOMready: ERROR</p><p>setTimeout: ERROR</p><p>IE7</p><p>Immediate: ERROR  </p><p>DOMready: success  </p><p>setTimeout: success  </p><h2>JQUERY 1.3.2:</h2><p>IE6</p><p>Immediate: ERROR  </p><p>DOMready: ERROR  </p><p>setTimeout: ERROR  </p><p>IE7</p><p>Immediate: success  </p><p>DOMready: success  </p><p>setTimeout: success  </p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 04, 2010 09:45AM UTC by <span class="author">Qwerios</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>My results on the fixed test.</p><p>JQUERY 1.4.2:</p><p>IE6</p><p>Immediate: ERROR</p><p>DOMready: ERROR</p><p>setTimeout: ERROR</p><p>Reloading the page gives random results. There has to be some kind of race condition here...</p><p>JQUERY 1.3.2:</p><p>IE6</p><p>Immediate: success</p><p>DOMready: success</p><p>setTimeout: success</p><p>Reloads keep returning success</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 24, 2010 01:30PM UTC by <span class="author">cowboy</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>So, this seems to be a non-issue, but only when document.domain is set BEFORE jQuery is loaded! (thanks to @jaubourg for suggesting this approach)</p><p>jQuery 1.4.2</p><p><a href="http://benalman.com/code/test/jquery-142-document-domain-before.html" class="ext-link"><span class="icon"></span>http://benalman.com/code/test/jquery-142-document-domain-before.html</a></p><p>jQuery 1.3.2</p><p><a href="http://benalman.com/code/test/jquery-132-document-domain-before.html" class="ext-link"><span class="icon"></span>http://benalman.com/code/test/jquery-132-document-domain-before.html</a></p><p>Feel free to confirm!</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 25, 2010 09:24AM UTC by <span class="author">Qwerios</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Verified on my IE6 test image. Both jQuery 1.3 and 1.4 tests work perfectly. Reloads work as well.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 15, 2010 01:37AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ worksforme</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'll close this, sounds like there's a simple workaround.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
