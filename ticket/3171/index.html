<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#3171 (wrap() only adds sibling in some instances) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/3170/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/3172/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#3171</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened July 19, 2008 10:22AM UTC</p>
      
        <p>Closed January 18, 2009 02:37AM UTC</p>
      
      
        <p>Last modified January 18, 2009 11:44AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">wrap() only adds sibling in some instances</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        logicmason
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        major
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.3">1.3</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>core</td>
      
        <th>Version:</th>
      
      <td>1.2.6</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>wrap() adds sibling</td>
      
        <th>Cc:</th>
      
      <td>logicmason, flesler, Julian-Birch</td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I have found that wrap() is not working properly when trying to wrap with elements containing text. For example, taking this HTML:</p><pre class="wiki">
...
    &lt;ul&gt;
        &lt;li&gt;&lt;a target="..." href="..."&gt;Text1&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a target="..." href="..."&gt;Text2&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
...
</pre><p>If I attempt to wrap the &lt;a&gt; element around the &lt;li&gt; element using:</p><p>(<strong>NOTE:</strong> $(this) in all the examples shown on this page relate to the &lt;li&gt; elements)</p><pre class="wiki">
var linkElem = $(this).find( "a:first" );
		
$(this).wrap( linkElem );
$(this).remove( "a" );
</pre><p>The result (seen using firebug) is that the inner &lt;a&gt; element is added as a sibling to the wrap() caller element:</p><pre class="wiki">
...
    &lt;ul&gt;
        &lt;a target="..." href="..."&gt;Text1&lt;/a&gt;
        &lt;li&gt;&lt;a target="..." href="..."&gt;Text1&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a target="..." href="..."&gt;Text2&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
...
</pre><p>I note as well the call to remove() did not remove the inner element. To workaround this, it seems you actually have to remove the wrapping element's text, then wrap it around the inner element, then re-apply the text to the inner element:</p><pre class="wiki">
var linkElem = $(this).find( "a:first" );
var linkText = $(linkElem).text();
		
$(linkElem).empty();
$(this).wrap( linkElem );
$(this).empty();
$(this).text( linkText );
</pre><p>created:</p><pre class="wiki">
...
    &lt;ul&gt;
        &lt;a target="..." href="..."&gt;&lt;li&gt;Text1&lt;/li&gt;&lt;/a&gt;
        &lt;a target="..." href="..."&gt;&lt;li&gt;Text2&lt;/li&gt;&lt;/a&gt;
    &lt;/ul&gt;
...
</pre><p>Have only tried this in FF3.</p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (5)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 22, 2008 02:23AM UTC by <span class="author">flesler</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>need:</th>
                  <td>
                    
                      <span class="change-field-old">Review</span> → <span class="change-field-new">Test Case</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Can you make a small test case out of this ?</p><p>An html file with the js needed for this error to come up.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 31, 2008 11:55AM UTC by <span class="author">Julian-Birch</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>This looks like the same bug I'm experiencing.  The following demonstrates it pretty nicely.  Happens (amazingly) portably on a wide range of browsers.</p><p>Makes certain things pretty impossible...</p><p>Julian.</p><p>&lt;html&gt;</p><p>&lt;head&gt; &lt;script type="text/javascript" src="/jquery-1.2.6.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt;</p><p>$(document).ready(function() {</p><p>elements = $("div &gt; *"); elements.wrap("span");</p><p>}); &lt;/script&gt; &lt;/head&gt; &lt;body&gt;</p><p>&lt;form&gt;&lt;div class='Box'&gt; </p><p>&lt;label for='repeat'&gt;Repeat&lt;/label&gt; &lt;span&gt;</p><p>&lt;input id='repeat' type='text' value='Box1' /&gt;</p><p>&lt;/span&gt;</p><p>&lt;/div&gt; &lt;/form&gt;</p><p>&lt;/body&gt; &lt;/html&gt;</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed October 31, 2008 03:27PM UTC by <span class="author">flesler</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>cc:</th>
                  <td>
                    
                      <span class="change-field-new">→ logicmason, flesler, Julian-Birch</span>
                    
                  </td>
                </tr>
              
            
              
            
              
                <tr>
                  <th>need:</th>
                  <td>
                    
                      <span class="change-field-old">Test Case</span> → <span class="change-field-new">Review</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>Ok, will check the test case asap (not today).</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 18, 2009 02:37AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The Julian-Birch test case isn't valid:</p><pre class="wiki">
elements.wrap("span"); 
</pre><p>works fine with this:</p><pre class="wiki">
elements.wrap("&lt;span&gt;&lt;/span&gt;"); 
</pre><p>On the OP's example, wrap is not intended to deal with cases where there are already sibling elements inside the wrapping element, which is the case with &lt;a href=""&gt;text&lt;/a&gt;. The text is a child of the &lt;a&gt;; using it as the wrapping element does not cause the &lt;li&gt; to adopt the text. </p><p>Note that &lt;a&gt; is an inline element and &lt;li&gt; is a block element, so the HTML created is invalid. However, your final approach would be the right one to use to get the HTML you wanted.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 18, 2009 11:44AM UTC by <span class="author">Julian-Birch</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Agreed.  Sorry, I managed to find the problem with the test case, but couldn't track down the ticket earlier.  Everything works as per spec.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
