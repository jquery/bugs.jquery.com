<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#13103 (Avoid Boolean traps in the API) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/13102/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/13104/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#13103</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">feature</span>
      <span class="ticket-resolution">(fixed)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened December 21, 2012 06:08AM UTC</p>
      
        <p>Closed January 27, 2013 12:59AM UTC</p>
      
      
    </div>
  </div>

  <h1 class="ticket-title">Avoid Boolean traps in the API</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        ariya.hidayat@gmail.com
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.9">1.9</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>effects</td>
      
        <th>Version:</th>
      
      <td>1.9b1</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>stop() function can lead to the following usage:</p><pre class="wiki">
  $('foobar').stop(true, false);
</pre><p>The weird combination of two opposite Boolean values is a classic example of "Boolean trap".</p><p>See also:</p>  <ul><li><a href="http://ariya.ofilabs.com/2012/06/detecting-boolean-traps-with-esprima.html" class="ext-link"><span class="icon"></span>http://ariya.ofilabs.com/2012/06/detecting-boolean-traps-with-esprima.html</a></li>  <li><a href="http://ariya.ofilabs.com/2011/08/hall-of-api-shame-boolean-trap.html" class="ext-link"><span class="icon"></span>http://ariya.ofilabs.com/2011/08/hall-of-api-shame-boolean-trap.html</a></li></ul></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (15)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 21, 2012 06:17AM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">None</span> → <span class="change-field-new">1.9</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>While I completely agree with you, there is nothing we can do without...</p><p>1) breaking backward compatibility </p><p>Or</p><p>2) creating an signature overload and deprecating the Boolean args.</p><p>I'd like to leave this for 1.9/2.0 discussion </p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 21, 2012 02:55PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Totally agree on the boolean traps. Methods like <code>.clone()</code> have the same issue. But migrating out to a new API and actually removing the old one would take at least two years at this point, given that we're going to slow the pace after 1.9/2.0 arrives. </p><p>So, write the new documentation for these methods. Name? Description? Is the old <code>.stop()</code> method deprecated? Scheduled to be removed in 2.1? Or staying forever to allow old code to work since there is nothing functionally broken about the old API?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 21, 2012 03:22PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>If we go <a href="/ticket/2">#2</a>, we can slowly deprecate, but we trade for more code to maintain...</p><pre class="wiki">

$(selector).clone({
  data: Boolean,
  events: Boolean
});

// Omitted options are assumed false, in this case "jumpToEnd" is false:
$(selector).clone({ data: true });

// Both options are assumed false
$(selector).clone();

// ------------------------------

$(this).stop({
  clearQueue: Boolean, 
  jumpToEnd: Boolean
});

// Omitted options are assumed false, in this case "jumpToEnd" is false:
$(this).stop({ clearQueue: true });

</pre><p>...Which is actually quite nice.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 21, 2012 03:34PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>It's worse though: <a href="http://api.jquery.com/stop/" class="ext-link"><span class="icon"></span>http://api.jquery.com/stop/</a></p><p>There's an optional queue parameter at the FRONT, so it's already doing hockey. I doubt many people use that signature with custom queues (it was just added in 1.7) so perhaps we could drop that outright.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 21, 2012 04:31PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I don't think we need to drop it... it will just become one of the options. If the <code>type</code> param is an object re-assign the property values to the matching named args as needed and continue as done previously?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed December 28, 2012 05:04PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">effects</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>version:</th>
                  <td>
                    
                      <span class="change-field-old">git</span> → <span class="change-field-new">1.9b1</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@rwaldron: +1</p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 03, 2013 05:31PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>If we want to land anything for 1.9 it should happen before the next beta, which means, um, today.</p><p>I'd like to avoid going from a "boolean trap" to a "misspelled names in anonymous objects" trap. </p><p>If <code>.stop({ clearQueue: true })</code> is the same as <code>.clearQueue().stop()</code> (it seems to be) we should just advise people to use it. That costs us zero bytes.</p><p>For <code>.stop({ jumpToEnd: true })</code> perhaps we could introduce a new API method that makes it clear what is happening, something like <code>.finish()</code> that implies we're completing the animation steps immediately and not really <code>.stop()</code>ping it dead in its tracks. </p><p>So this would be the mapping from old to new API:</p><pre class="wiki">
  .stop(false, false)  ===&gt;  .stop()
  .stop(true, false)   ===&gt;  .clearQueue().stop()
  .stop(false, true)   ===&gt;  .finish()
  .stop(true, true)    ===&gt;  .clearQueue().finish()
</pre><p>All that needs to be done is adding <code>.finish()</code> and changing the docs to deprecate the boolean args and provide the recommended alternatives.</p><h5>=</h5><p>For <code>.clone(withDataAndEvents, deepWithDataAndEvents)</code> there needs to be a separate discussion. Even though it accepts two booleans I suspect damn near every call just uses 0 or 1 and I'd just prefer to leave it alone.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 03, 2013 05:40PM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The <code>.clone()</code> situation can be dealt with by accepting a string as the first argument.</p><pre class="wiki">
.clone( true ) =&gt; with data and events
.clone("deep") =&gt; with data and events, deep
</pre><p>The logic inside is quite simple:</p><pre class="wiki">
if ( withDataAndEvents ) {
    // deal with data and events
    if ( withDataAndEvents === "deep" ) {
        // do it recursively
    }
}
</pre><p>You can keep the old second param by changing the last condition to:</p><pre class="wiki">
deepWithDataAndEvents || withDataAndEvents === "deep"
</pre><p>Pretty straight-forward. I dunno why we went for two separate arguments given how closely related they are.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 03, 2013 05:53PM UTC by <span class="author">mikesherov</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>"magic string trap", "boolean trap", "misspelled property name in anonymous object trap" all sound like traps to me.</p><p>A boolean trap is simply "bad API design" and may lead to ambiguity as to purpose, but is straightforward in implementation. Magic strings make it harder to detect errors in userland, same goes for anonymous objects.</p><p>IMO, dmethvin's approach of creating new named API functions seems like the "right" "fix", in that it will error out on misspellings, and be clear in intention:</p><p>.clone(), .cloneWithData(), .cloneDeepWithData() Of course, this ruins the jQuery aesthetic of short function names, but I think it's a clarity win.</p><p>I'd say all boolean parameters should be considered for re-evaluation, but the one that comes to mind for me is outerWidth(true). The dimension functions should be called: contentBoxWidth(), paddingBoxWidth(), borderBoxWidth(), and marginBoxWidth()... no booleans.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 03, 2013 06:00PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@jaubourg, <code>.clone(true)</code> is the same as <code>.clone(true, true)</code> because the deep arg is the same as the first arg unless it's explicitly specified. So the only time it comes into play is if you explicitly say <code>.clone(false, true)</code> and I can't imagine a reason why anyone would need to specifically do that.</p><p>So although a <code>.cloneWithDataAndEvents()</code> might make sense, to capture the current behavior we'd need something like <code>cloneWithDataAndEventsExceptForTheRoot()</code> which again I think is so rare that we just act like it isn't there.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 03, 2013 07:57PM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:10 dmethvin]:</p><blockquote> @jaubourg, <code>.clone(true)</code> is the same as <code>.clone(true, true)</code> because the deep arg is the same as the first arg unless it's explicitly specified. So the only time it comes into play is if you explicitly say <code>.clone(false, true)</code> and I can't imagine a reason why anyone would need to specifically do that.</blockquote><p>It's even worse than what I (wrongly) assumed :/</p><blockquote> So although a <code>.cloneWithDataAndEvents()</code> might make sense, to capture the current behavior we'd need something like <code>cloneWithDataAndEventsExceptForTheRoot()</code> which again I think is so rare that we just act like it isn't there.</blockquote><p>+1</p><p>@mikesherov, seems to me you see traps everywhere... how about mispelled or badly named API functions? It's a trap!</p><p>There is no silver bullet. Booleans, strings, separate functions, it all boils down to the actual use case.</p><p>The boolean trap comes into play when you have several boolean arguments next to one another, not when you have a single boolean argument. With a single argument, the question is about ambiguity. This is the problem with the outerWidth method: true/false don't have any obvious meaning in this context.</p><p>Beside, that's why I actually love "magical" strings. They work perfectly to create $.Callbacks for instance as they should in any situation where you need to specify several "flags". I always find them to be very easy to read and make sense of given how inherently explicit they are.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 03, 2013 08:07PM UTC by <span class="author">mikesherov</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Obligatory Admiral Akbar reference: <a href="http://www.youtube.com/watch?v=piVnArp9ZE0" class="ext-link"><span class="icon"></span>http://www.youtube.com/watch?v=piVnArp9ZE0</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 07, 2013 03:20PM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>My first thought on the <code>.finish()</code> method is that it would complete all animations, or at least have an option to complete all animations. It seems more useful to make sure all animations on the element are done before I move on to something else.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 07, 2013 03:29PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I was thinking we might add a <code>.finishAll()</code> method for that reason but then again if you wanted to finish *only* the current step you could <code>.clearQueue().finish()</code> right? So it seems the combo of those two APIs cover all the cases without need for a boolean option to <code>.finish()</code>.</p><p>The interesting thing about that is that there is no easy way to do the equivalent of finishing all animation steps today and I've wanted it a couple of times. So I'd go for that. Other thoughts?</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:15">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed January 27, 2013 12:59AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:15">comment:15</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>We landed <code>.finish()</code> for 1.9.0 and the only todo is for us to talk people out of using the <code>.stop()</code> signature. <a href="https://github.com/jquery/api.jquery.com/issues/236" class="ext-link"><span class="icon"></span>https://github.com/jquery/api.jquery.com/issues/236</a></p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
