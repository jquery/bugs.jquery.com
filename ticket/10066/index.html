<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#10066 (Double referencing jQuery deletes all assigned plugins.) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/10065/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/10067/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#10066</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(invalid)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened August 16, 2011 09:43PM UTC</p>
      
        <p>Closed August 17, 2011 01:19AM UTC</p>
      
      
        <p>Last modified August 18, 2011 05:33PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Double referencing jQuery deletes all assigned plugins.</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        adsood
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        low
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/None">None</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>misc</td>
      
        <th>Version:</th>
      
      <td>1.5.1</td>
    </tr>
    <tr>
      
        <th class="missing">Keywords:</th>
      
      <td></td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>Scenario:</p><ul><li>A web page loads external HTML page and displays it in the Dialog using jQuery UI library.</li></ul><p>What happens:</p><ul><li>When a formatted (HTML) page is loaded into existing document (using .load() function) browser build DOM and loads any scripts if they are referenced on the loaded page. </li></ul><p>if both the host page and the loaded page refer to jQuery library, the jQuery script will be executed twice.</p><p>As jQuery script executes it re-initializes $ and $.prototype, which removes all existing plug-ins. </p><p>The host page stops working.</p><p>Example:</p><p>The following example is simplified version of the issue (jquery explicitly loaded twice):</p><pre class="wiki">

&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;jQuery double reference&lt;/title&gt;
    &lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
        $.fn.test = function(method) {
		alert('test');
	}
    &lt;/script&gt;

    &lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
	$(function() {
		$('body').test();
	});
    &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt; 
</pre><p>No alert has been displayed and an error reported in the console:</p><p>"Uncaught <a href="/wiki/TypeError">TypeError</a>: Object [object Object] has no method 'test'" </p><p>or</p><p>"$("body").test is not a function"</p><p>...</p><p>Solution:</p><p>At the beginning of jQuery script add verification if jQuery has been loaded already:</p><pre class="wiki">
...
if (typeof jQuery === 'undefined')

(function( window, undefined ) {

// Use the correct document accordingly with window argument (sandbox)
var document = window.document;
var jQuery = (function() {

// Define a local copy of jQuery
var jQuery = function( selector, context ) {
...

</pre><p>Similar approach has been utilized by jQueryUI.</p><p>tested in:</p><p>Chrome - 5.0.375.9</p><p>Chrome - 13.0.782.112 m </p><p>Firefox - 3.6.18</p><p>Firefox - 5.0</p><p>IE - 9.0.8112.16421 </p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (4)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 17, 2011 01:19AM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>component:</th>
                  <td>
                    
                      <span class="change-field-old">unfiled</span> → <span class="change-field-new">misc</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">undecided</span> → <span class="change-field-new">low</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ invalid</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Use $.noConflict().</p><p>Also, this will happen in <strong>any programming language</strong> that allows for the declaration and assignment of variables.</p>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 18, 2011 12:18AM UTC by <span class="author">adsood</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
                <tr>
                  <th>_comment0:</th>
                  <td>
                    
                      <span class="change-field-old">There is not conflict here with any other libraries.&#92;
It is not the matter of using $ sign or not using. &#92;
The problem is that jQuery (and its alias - $) get completely wiped out with and replaced with the new copy. &quot;jQuery&quot; variable get reinitialized as well. &#92;
&#92;
We develop our own plug-in and follow all the recommendations from jQuery documentation. However, the plug-in get removed from jQuery prototype.&#92;
$.noConflict() will not help here.&#92;
&#92;
I do not fully understand the reference to other programming languages and its relevance to the problem. If, however, we look at other JavaScript libraries that can suffer from the same issue, then we can see that they use simple verification against double-loading case.&#92;
&#92;
An example is jQueryUI library:&#92;
&#92;
{{{&#92;
$.ui = $.ui || {};&#92;
if ( $.ui.version ) {&#92;
	return;&#92;
}&#92;
}}}&#92;
&#92;
This is a valid issue. Please open the ticket.&#92;
</span> → <span class="change-field-new">1313626946809585</span>
                    
                  </td>
                </tr>
              
            
              
            
          </tbody>
        </table>
        
          
        
          
            <div class="ticket-comment-body">
              <p>There is no conflict here with any other libraries.</p><p>It is not a matter of using $ sign or not using. </p><p>The problem is that jQuery (and its alias - $) get completely wiped out  and replaced with the new copy. "jQuery" variable get re-initialized as well. </p><p>We develop our own plug-in and follow all the recommendations from jQuery documentation. However, the plug-in get removed from jQuery prototype.</p><p>$.noConflict() will not help here.</p><p>I do not fully understand the reference to other programming languages and its relevance to the problem. If, however, we look at other <a href="/wiki/JavaScript">JavaScript</a> libraries that can suffer from the same issue, then we can see that they use simple verification against double-loading case.</p><p>An example is jQueryUI library:</p><pre class="wiki">
$.ui = $.ui || {};
if ( $.ui.version ) {
	return;
}
</pre><p>This is a valid issue. Please open the ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 18, 2011 02:53PM UTC by <span class="author">ajpiano</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>The fact that jQuery UI does not allow multiple instantiations of the library is not germane to this discussion.  jQuery has historically allowed you to have as many copies of jQuery on the page as you like/need, and loading jQuery again will destroy the existing jQuery, unless you've aliased to somewhere else beforehand, perhaps using noConflict.  </p><p>I certainly understand why this issue is annoying - it was the first big "jQuery Bug" I had a number of years ago when I was getting started that drove me into the community in the first place.  WHERE ARE MY PLUGINS GOING?  Turned out I was accidentally AJAX'ing whole pages and thus reloading and clobbering jQuery when I didn't even intend to.</p><p>However, I am now of the mind that it is the developer's responsibility to ensure that their assets are loading properly and reliably.  Because of the various use cases for loading multiple copies of jQuery on a page, we simply cannot block multiple instantiations with the technique you've described here and thus will not reopen this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed August 18, 2011 05:33PM UTC by <span class="author">adsood</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@ajpiano:</p><p>I understand your ground in general. </p><p>The statement "Because of the various use cases for loading multiple copies of jQuery on a page, we simply cannot block multiple instantiations" intrigues me.</p><p>Could you provide a one or two real-life (or practically useful) examples of using "loading multiple copies of jQuery on a page" technique?</p><p>Thanks.</p>
            </div>
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
