<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#2649 (Change between jquery 1.2.1 and 1.2.3 on the clone() function causes lag, freezing, and crashes some browsers.) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/2648/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/2650/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#2649</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">bug</span>
      <span class="ticket-resolution">(worksforme)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened April 03, 2008 04:25PM UTC</p>
      
        <p>Closed March 18, 2009 03:02AM UTC</p>
      
      
        <p>Last modified March 14, 2012 05:59AM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">Change between jquery 1.2.1 and 1.2.3 on the clone() function causes lag, freezing, and crashes some browsers.</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        pthurmond
      </td>
      <th>Owned by:</th>
      <td></td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        major
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.2.1">1.2.1</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>core</td>
      
        <th>Version:</th>
      
      <td>1.2.3</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>clone, internet explorer, firefox</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>I upgraded to version 1.2.3 to fix a problem that occurs in Internet Explorer 6 and 7.</p><p>This problem is when using a function that was written to change the list of select options in one drop down when you select a particular option in another drop down.</p><p>I think the problem is caused by the clone() function. But I haven't been able to verify that for sure. I know it only happens in this function that I wrote. I will include my function below.</p><p>To be more specific on this, in 1.2.1 it would pause and take up to 90 seconds to finish executing, yet it worked perfectly in Firefox and Safari. Then I upgraded to 1.2.3 and it worked instantly and perfectly in IE7, in IE6 it worked a lot faster, in Safari, Firefox 2, and Firefox 3 Beta 4 it runs slow like IE6 and 7 did while on jquery 1.2.1. In the case of Firefox 3 Beta 5 it straight crashed the browser.</p><p>Again I am pretty sure it has to do with the bugfix in Ticket <a href="/ticket/2184">#2184</a> link: <a href="http://dev.jquery.com/ticket/2184" class="ext-link"><span class="icon"></span>http://dev.jquery.com/ticket/2184</a></p><p>However I haven't been able to narrow it down any further. I have only included the relevant code. The setsel() function works when called by another event without any problems, so the problem is not coming from there. The event is the changing of a select option.</p><p>Here is my code...</p><pre class="wiki">
$(function()
{ 
  // Item class stuff
  $('select.itemclass').change(function()
  {
    var itemnum = this.id.substr(7,1);
    var iclass = this.value;

    classChange(itemnum, iclass);
  });
});

function classChange(itemnum, iclass)
{ 
  newsel = $('tr.hiddenitem select.itemcomm').clone();

  if (iclass)
  {
    // Remove items that don't match the selected frieght class
    newsel.find('option:not(.' + iclass +')').remove();

    // We just removed the blank option, so add it back in
    newsel.prepend("&lt;option value=''&gt;&lt;/option&gt;");
  } 

  newsel.attr({id: 'riitem' + itemnum}).change(function()
  {
    setsel('riclass' + itemnum, itemclasses[this.value]);
  });

  itd = $('select#riitem' + itemnum).parent();
  itd.empty();
  itd.append(newsel);

  $('#riitem' + itemnum).val('');
}

function setsel(selid,newval)
{
  if (newval == null)
    return null;
  
  if (!newval)
    newval = "";
  
  $('select#' + selid).val(newval);
}
</pre></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (0)</summary>

  <ul class="ticket-attachments">
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (2)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 04, 2008 05:04AM UTC by <span class="author">davidserduke</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">I upgraded to version 1.2.3 to fix a problem that occurs in Internet Explorer 6 and 7.&#92;
&#92;
This problem is when using a function that was written to change the list of select options in one drop down when you select a particular option in another drop down.&#92;
&#92;
I think the problem is caused by the clone() function. But I haven&#39;t been able to verify that for sure. I know it only happens in this function that I wrote. I will include my function below.&#92;
&#92;
To be more specific on this, in 1.2.1 it would pause and take up to 90 seconds to finish executing, yet it worked perfectly in Firefox and Safari. Then I upgraded to 1.2.3 and it worked instantly and perfectly in IE7, in IE6 it worked a lot faster, in Safari, Firefox 2, and Firefox 3 Beta 4 it runs slow like IE6 and 7 did while on jquery 1.2.1. In the case of Firefox 3 Beta 5 it straight crashed the browser.&#92;
&#92;
Again I am pretty sure it has to do with the bugfix in Ticket #2184 link: http://dev.jquery.com/ticket/2184&#92;
&#92;
However I haven&#39;t been able to narrow it down any further. I have only included the relevant code. The setsel() function works when called by another event without any problems, so the problem is not coming from there. The event is the changing of a select option.&#92;
&#92;
Here is my code...&#92;
$(function()&#92;
{ &#92;
  // Item class stuff&#92;
  $(&#39;select.itemclass&#39;).change(function()&#92;
  {&#92;
    var itemnum = this.id.substr(7,1);&#92;
    var iclass = this.value;&#92;
&#92;
    classChange(itemnum, iclass);&#92;
  });&#92;
});&#92;
&#92;
function classChange(itemnum, iclass)&#92;
{ &#92;
  newsel = $(&#39;tr.hiddenitem select.itemcomm&#39;).clone();&#92;
&#92;
  if (iclass)&#92;
  {&#92;
    // Remove items that don&#39;t match the selected frieght class&#92;
    newsel.find(&#39;option:not(.&#39; + iclass +&#39;)&#39;).remove();&#92;
&#92;
    // We just removed the blank option, so add it back in&#92;
    newsel.prepend(&quot;&lt;option value=&#39;&#39;&gt;&lt;/option&gt;&quot;);&#92;
  } &#92;
&#92;
  newsel.attr({id: &#39;riitem&#39; + itemnum}).change(function()&#92;
  {&#92;
    setsel(&#39;riclass&#39; + itemnum, itemclasses[this.value]);&#92;
  });&#92;
&#92;
  itd = $(&#39;select#riitem&#39; + itemnum).parent();&#92;
  itd.empty();&#92;
  itd.append(newsel);&#92;
&#92;
  $(&#39;#riitem&#39; + itemnum).val(&#39;&#39;);&#92;
}&#92;
&#92;
function setsel(selid,newval)&#92;
{&#92;
  if (newval == null)&#92;
    return null;&#92;
  &#92;
  if (!newval)&#92;
    newval = &quot;&quot;;&#92;
  &#92;
  $(&#39;select#&#39; + selid).val(newval);&#92;
}</span> → <span class="change-field-new">I upgraded to version 1.2.3 to fix a problem that occurs in Internet Explorer 6 and 7.&#92;
&#92;
This problem is when using a function that was written to change the list of select options in one drop down when you select a particular option in another drop down.&#92;
&#92;
I think the problem is caused by the clone() function. But I haven&#39;t been able to verify that for sure. I know it only happens in this function that I wrote. I will include my function below.&#92;
&#92;
To be more specific on this, in 1.2.1 it would pause and take up to 90 seconds to finish executing, yet it worked perfectly in Firefox and Safari. Then I upgraded to 1.2.3 and it worked instantly and perfectly in IE7, in IE6 it worked a lot faster, in Safari, Firefox 2, and Firefox 3 Beta 4 it runs slow like IE6 and 7 did while on jquery 1.2.1. In the case of Firefox 3 Beta 5 it straight crashed the browser.&#92;
&#92;
Again I am pretty sure it has to do with the bugfix in Ticket #2184 link: http://dev.jquery.com/ticket/2184&#92;
&#92;
However I haven&#39;t been able to narrow it down any further. I have only included the relevant code. The setsel() function works when called by another event without any problems, so the problem is not coming from there. The event is the changing of a select option.&#92;
&#92;
Here is my code...&#92;
{{{&#92;
$(function()&#92;
{ &#92;
  // Item class stuff&#92;
  $(&#39;select.itemclass&#39;).change(function()&#92;
  {&#92;
    var itemnum = this.id.substr(7,1);&#92;
    var iclass = this.value;&#92;
&#92;
    classChange(itemnum, iclass);&#92;
  });&#92;
});&#92;
&#92;
function classChange(itemnum, iclass)&#92;
{ &#92;
  newsel = $(&#39;tr.hiddenitem select.itemcomm&#39;).clone();&#92;
&#92;
  if (iclass)&#92;
  {&#92;
    // Remove items that don&#39;t match the selected frieght class&#92;
    newsel.find(&#39;option:not(.&#39; + iclass +&#39;)&#39;).remove();&#92;
&#92;
    // We just removed the blank option, so add it back in&#92;
    newsel.prepend(&quot;&lt;option value=&#39;&#39;&gt;&lt;/option&gt;&quot;);&#92;
  } &#92;
&#92;
  newsel.attr({id: &#39;riitem&#39; + itemnum}).change(function()&#92;
  {&#92;
    setsel(&#39;riclass&#39; + itemnum, itemclasses[this.value]);&#92;
  });&#92;
&#92;
  itd = $(&#39;select#riitem&#39; + itemnum).parent();&#92;
  itd.empty();&#92;
  itd.append(newsel);&#92;
&#92;
  $(&#39;#riitem&#39; + itemnum).val(&#39;&#39;);&#92;
}&#92;
&#92;
function setsel(selid,newval)&#92;
{&#92;
  if (newval == null)&#92;
    return null;&#92;
  &#92;
  if (!newval)&#92;
    newval = &quot;&quot;;&#92;
  &#92;
  $(&#39;select#&#39; + selid).val(newval);&#92;
}&#92;
}}}</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>It's a bit hard to see in the changeset [4513] but the fix for <a href="/ticket/2184">#2184</a> was an IE specific change.  So it shouldn't have made any difference to firefox, et al.  There have been a bunch of other changes to clone since 1.2.1 trying to find a decent solution, so it is still possible clone is the culprit.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 18, 2009 03:02AM UTC by <span class="author">brandon</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ worksforme</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Please feel free to reopen if things are still running slow on the latest build of jQuery 1.3.x</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
