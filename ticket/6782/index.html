<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-pagefind-meta="title">#6782 (carefully allow more strings to use innerHTML) - jQuery - Bug Tracker</title>
    <meta name="description" content="Static archive of the old bugs.jquery.com Trac site.">
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="/bundle/SEeiGkT-TJ.css">
  </head>
  <body>
    <div class="banner flex-center">
      <span>jQuery issues have moved to <a href="https://github.com/jquery/jquery/issues">GitHub</a>. This site is now a static archive of the old <a href="https://trac.edgewall.org/">Trac</a> bugs site. Some functions and pages are no longer available.</span>
    </div>
    <div class="container">
      <a href="#skip" class="visually-hidden">Skip to main content</a>
      <header class="flex-column">
        <div class="flex-row flex-between-start">
          <a id="jq-siteLogo" href="/" title="jQuery Home">
            <img src="/img/logo.svg" width="215" alt="jQuery: Write Less, Do More.">
          </a>
          <input class="hamburger-toggle visually-hidden" id="jq-menutoggle" type="checkbox">
          <label aria-label="Toggle Menu" for="jq-menutoggle" class="hamburger-lines flex-column flex-between-center">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </label>
          <div id="jq-menus">
            <nav id="jq-primaryNavigation">
              <h2 class="visually-hidden">jQuery sites navigation menu</h2>
              <ul class="nav">
                <li class="jq-jquery active">
                  <a href="https://jquery.com/" title="jQuery Home">jQuery</a>
                </li>
                <li class="jq-plugins">
                  <a href="https://plugins.jquery.com/" title="jQuery Plugins">Plugins</a>
                </li>
                <li class="jq-ui">
                  <a href="https://jqueryui.com/" title="jQuery UI">UI</a>
                </li>
                <li class="jq-meetup">
                  <a href="https://meetups.jquery.com/" title="jQuery Meetups">Meetups</a>
                </li>
                <li class="jq-forum">
                  <a href="https://forum.jquery.com/" title="jQuery Forum">Forum</a>
                </li>
                <li class="jq-blog">
                  <a href="https://blog.jquery.com/" title="jQuery Blog">Blog</a>
                </li>
                <li class="jq-about">
                  <a href="https://openjsf.org" title="About jQuery and OpenJS">About</a>
                </li>
                <li class="jq-donate">
                  <a href="https://openjsf.org/about/project-funding-opportunities/" title="Donate to OpenJS">Donate</a>
                </li>
              </ul>
            </nav>
            <nav id="jq-secondaryNavigation">
              <h2 class="visually-hidden">jQuery Core navigation menu</h2>
              <ul class="nav">
                <li class="jq-download">
                  <a href="https://jquery.com/download/">
                    Download
                  </a>
                </li>
                <li class="jq-documentation">
                  <a href="https://api.jquery.com/">
                    Documentation
                  </a>
                </li>
                <li class="jq-tutorials">
                  <a href="https://learn.jquery.com/">
                    Tutorials
                  </a>
                </li>
                <li class="jq-bugTracker">
                  <a href="https://github.com/jquery/jquery/issues">
                    Bug Tracker
                  </a>
                </li>
                <li class="jq-discussion">
                  <a href="https://forum.jquery.com/">
                    Discussion
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div id="bug-tracker-form" class="flex-column flex-between-center">
          <h1>Bug Tracker</h1>
          <div id="search"></div>
          
        </div>
      </header>
      <main id="skip" class="flex-column">
        <h2 class="visually-hidden">Side navigation</h2>
        <nav id="jq-sidenav" class="flex-column white-box">
          <h5 class="sidenav-header">Bug Tracker</h5>
          <a href="/newticket">New Ticket</a>
          <a href="/report">View Tickets</a>
          <a href="/ticketgraph">Ticket Graph</a>
          <a href="/roadmap">Roadmap</a>
          <a href="/timeline">Recent Changes</a>
        </nav>
        <div id="jq-content" class="white-box">
          

<div class="flex-column" data-pagefind-body="">
  

  <nav class="content-nav">
    <ul class="flex-row">
      
        <li>
          <a href="/ticket/6781/">← Previous Ticket</a>
        
      
      
        </li><li>
          <a href="/ticket/6783/">Next Ticket →</a>
        </li>
      
    </ul>
  </nav>


<div class="ticket-info">
  <div class="flex-row flex-between-start">
    <h3>
      <a href="" class="ticket-number">#6782</a>
      <span class="ticket-status">closed</span>
      <span class="ticket-type">enhancement</span>
      <span class="ticket-resolution">(fixed)</span>
    </h3>

    <div class="ticket-dates">
      <p>Opened July 11, 2010 04:23AM UTC</p>
      
        <p>Closed September 22, 2011 03:22AM UTC</p>
      
      
        <p>Last modified March 08, 2012 11:38PM UTC</p>
      
    </div>
  </div>

  <h1 class="ticket-title">carefully allow more strings to use innerHTML</h1>

  <table class="ticket-properties">
    <tr>
      <th>Reported by:</th>
      <td>
        cmcnulty
      </td>
      <th>Owned by:</th>
      <td>dmethvin</td>
    </tr>
    <tr>
      <th>
        Priority:
      </th>
      <td>
        blocker
      </td>
      
        <th class="missing">Milestone:</th>
      
      <td>
        <a href="/milestone/1.7">1.7</a>
      </td>
    </tr>
    <tr>
      <th>Component:</th>
      <td>manipulation</td>
      
        <th>Version:</th>
      
      <td>1.4.4</td>
    </tr>
    <tr>
      
        <th>Keywords:</th>
      
      <td>html,1.7-discuss</td>
      
        <th class="missing">Cc:</th>
      
      <td></td>
    </tr>
    <tr>
      <th class="missing">
        Blocked by:
      </th>
      <td></td>
      <th class="missing">
        Blocking:
      </th>
      <td></td>
    </tr>
  </table>
  <div class="ticket-info-bottom">
    <h5 class="ticket-description-title">Description</h5>
    <div class="ticket-description"><p>.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  </p><p>I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.</p><p>The new regex only excludes &lt;style and &lt;script for the following documented reasons:</p><p>style:</p><p><a href="http://dev.jquery.com/ticket/5977" class="ext-link"><span class="icon"></span>http://dev.jquery.com/ticket/5977</a></p><p>script:</p><p><a href="http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/" class="ext-link"><span class="icon"></span>http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/</a></p><p>&lt;object and &lt;embed </p><p>Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.</p><p>I discussed these changes a while back in this topic:</p><p><a href="http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382" class="ext-link"><span class="icon"></span>http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</a></p></div>
  </div>
</div>

<details>
  <summary class="ticket-details-summary">Attachments (2)</summary>

  <ul class="ticket-attachments">
    
      <li>
        <a href="/attachment/ticket/6782/html_innerhtml_patch.txt/index.html">html_innerhtml_patch.txt</a> (1.2 KB) - added by cmcnulty
        <strong>July 11, 2010 04:29AM UTC</strong>.<br>
        
      </li>
    
      <li>
        <a href="/attachment/ticket/6782/manipulation-innerHTML-tests.txt/index.html">manipulation-innerHTML-tests.txt</a> (1.4 KB) - added by cmcnulty
        <strong>July 11, 2010 04:29AM UTC</strong>.<br>
        
      </li>
    
  </ul>
</details>

<details open="">
  <summary class="ticket-details-summary">Change History (25)</summary>
  
    <div class="ticket-change flex-column" id="comment:1">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 12, 2010 02:40AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:1">comment:1</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old strikethrough">1.4.3</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Resetting milestone to future.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:2">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed November 21, 2010 04:23AM UTC by <span class="author">snover</span></span>
        <a class="ticket-change-link" href="#comment:2">comment:2</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-new">→ 1.5</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-new">→ high</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">new</span> → <span class="change-field-new">open</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>version:</th>
                  <td>
                    
                      <span class="change-field-old">1.4.2</span> → <span class="change-field-new">1.4.4</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:3">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed February 24, 2011 11:24PM UTC by <span class="author">cmcnulty</span></span>
        <a class="ticket-change-link" href="#comment:3">comment:3</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Created a jsperf test to show the performance increase:</p><p><a href="http://jsperf.com/tweaks-to-rnocache" class="ext-link"><span class="icon"></span>http://jsperf.com/tweaks-to-rnocache</a></p><p>I extend jquery to create a .html2() which is identical to .html() except that rather than using nocache it uses a regex test that it optimized for .html()</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:4">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed March 10, 2011 07:44PM UTC by <span class="author">cmcnulty</span></span>
        <a class="ticket-change-link" href="#comment:4">comment:4</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="https://github.com/jquery/jquery/pull/248" class="ext-link"><span class="icon"></span>Pull requested</a></p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:5">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2011 12:50AM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:5">comment:5</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-new">→ 1.next</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:6">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2011 12:52AM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:6">comment:6</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/7156">#7156</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:7">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 17, 2011 05:41AM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:7">comment:7</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p><a href="/ticket/7338">#7338</a> is a duplicate of this ticket.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:8">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 18, 2011 01:48AM UTC by <span class="author">wookiehangover</span></span>
        <a class="ticket-change-link" href="#comment:8">comment:8</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-new">→ wookiehangover</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">open</span> → <span class="change-field-new">assigned</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>I'm gonna take crack at this.</p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:9">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed April 19, 2011 02:15PM UTC by <span class="author">cmcnulty</span></span>
        <a class="ticket-change-link" href="#comment:9">comment:9</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Glad to hear this has been assigned.  I've been pushing for this change for a long time and am very familiar with at least some of the issues involved.  Feel free to let me know if you have any questions!  I'm not convinced that this little change is going to be a cure-all for the <a href="/ticket/7341">#7341</a> problems, but it should help a bit in IE 7,8,9.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:10">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 22, 2011 07:27PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:10">comment:10</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>keywords:</th>
                  <td>
                    
                      <span class="change-field-old">html</span> → <span class="change-field-new">html,1.7-discuss</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Nominating ticket for 1.7 discussion.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:11">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 23, 2011 12:04AM UTC by <span class="author">jaubourg</span></span>
        <a class="ticket-change-link" href="#comment:11">comment:11</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span> → <span class="change-field-new">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+0, What about IE6? Need proof.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:12">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 23, 2011 02:10AM UTC by <span class="author">ajpiano</span></span>
        <a class="ticket-change-link" href="#comment:12">comment:12</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span> → <span class="change-field-new">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+1, If the perf here is demonstrable in IE, then let's go for it. </p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:13">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 23, 2011 03:22AM UTC by <span class="author">timmywil</span></span>
        <a class="ticket-change-link" href="#comment:13">comment:13</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span> → <span class="change-field-new">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+1, I'm all for perf improvements.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:14">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 23, 2011 02:58PM UTC by <span class="author">cmcnulty</span></span>
        <a class="ticket-change-link" href="#comment:14">comment:14</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:11 jaubourg]:</p><blockquote> +0, What about IE6? Need proof.</blockquote><p>IE6 sees near 100% performance increase, passes all unit tests.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:15">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 23, 2011 03:18PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:15">comment:15</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span> → <span class="change-field-new">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>@cmcnulty can you provide a test case that we can view in IE6?</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:16">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 23, 2011 03:35PM UTC by <span class="author">cmcnulty</span></span>
        <a class="ticket-change-link" href="#comment:16">comment:16</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Replying to [comment:15 rwaldron]:</p><blockquote> @cmcnulty can you provide a test case that we can view in IE6?</blockquote><p>I'd be happy to, but I'm not sure exactly what you're looking for.  I've tested the change in <a href="http://jsperf.com/tweaks-to-rnocache" class="ext-link"><span class="icon"></span>jsperf</a> with IE6, and the <a href="https://github.com/jquery/jquery/pull/248" class="ext-link"><span class="icon"></span>pull request</a> passes all of the unit tests.  The nice thing about this change is that existing unit tests already cover pretty much this entire change ''<strong>except</strong>'' for &lt;EMBED which is the only thing the pull request adds a unit test for.  (None currently exist for EMBED anywhere in the unit tests)  Other than that, there are already tests in place for, for instance, making sure that an option stays selected, making sure the &lt;OBJECT is inserted properly, etc.</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:17">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed May 23, 2011 09:41PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:17">comment:17</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+1</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:18">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 03, 2011 01:33PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:18">comment:18</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span> → <span class="change-field-new">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+1, If we think that this might work as we expect it to, then let's go for it.</p>
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:19">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 03, 2011 02:48PM UTC by <span class="author">scottgonzalez</span></span>
        <a class="ticket-change-link" href="#comment:19">comment:19</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+1</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:20">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 04, 2011 10:18PM UTC by <span class="author">addyosmani</span></span>
        <a class="ticket-change-link" href="#comment:20">comment:20</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+1</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:21">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 05, 2011 09:15PM UTC by <span class="author">rwaldron</span></span>
        <a class="ticket-change-link" href="#comment:21">comment:21</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+1</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:22">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed June 06, 2011 03:50PM UTC by <span class="author">jzaefferer</span></span>
        <a class="ticket-change-link" href="#comment:22">comment:22</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>+0</p>
            </div>
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:23">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 12, 2011 03:14PM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:23">comment:23</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>description:</th>
                  <td>
                    
                      <span class="change-field-old">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span> → <span class="change-field-new">.html() uses rnocache to determine both if a snippet should be cached by buildFragment() and also whether or not html() should use append or innerHTMLto insert the snippet.  The problem is that buildFragment requires more stringent rules than innerHTML does, and therefore fewer strings use innerHTML than otherwise could, and that hurts performance, particularly by stripping all snippets with an &lt;option anywhere in the string.  &#92;
&#92;
I therefore suggest a new regex rule explicitly to determine if innerHTML or append method should be used.  Not only will the improve performance, but it also makes the code cleaner, more readable and make more sense.&#92;
&#92;
The new regex only excludes &lt;style and &lt;script for the following documented reasons:&#92;
&#92;
style:&#92;
http://dev.jquery.com/ticket/5977&#92;
&#92;
script:&#92;
http://poeticcode.wordpress.com/2007/10/03/innerhtml-and-script-tags/&#92;
&#92;
&lt;object and &lt;embed &#92;
&#92;
Have tests added to them, and cause no new failures in IE7, FF3.7 or Chrome 5.&#92;
&#92;
I discussed these changes a while back in this topic:&#92;
&#92;
http://forum.jquery.com/topic/html-performance-vs-cruft#14737000000784382</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>milestone:</th>
                  <td>
                    
                      <span class="change-field-old">1.next</span> → <span class="change-field-new">1.7</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>priority:</th>
                  <td>
                    
                      <span class="change-field-old">high</span> → <span class="change-field-new">blocker</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:24">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed July 25, 2011 04:15PM UTC by <span class="author">john</span></span>
        <a class="ticket-change-link" href="#comment:24">comment:24</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>owner:</th>
                  <td>
                    
                      <span class="change-field-old">wookiehangover</span> → <span class="change-field-new">dmethvin</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              
            </div>
          
        
          
        
      </div>
    </div>
  
    <div class="ticket-change flex-column" id="comment:25">
      <h3 class="flex-row flex-between-start ticket-change-header">
        <span>Changed September 22, 2011 03:22AM UTC by <span class="author">dmethvin</span></span>
        <a class="ticket-change-link" href="#comment:25">comment:25</a>
      </h3>

      <div class="ticket-change-content">
        <table class="ticket-changes">
          <tbody>
            
              
            
              
                <tr>
                  <th>resolution:</th>
                  <td>
                    
                      <span class="change-field-new">→ fixed</span>
                    
                  </td>
                </tr>
              
            
              
                <tr>
                  <th>status:</th>
                  <td>
                    
                      <span class="change-field-old">assigned</span> → <span class="change-field-new">closed</span>
                    
                  </td>
                </tr>
              
            
          </tbody>
        </table>
        
          
            <div class="ticket-comment-body">
              <p>Landed for 1.7: <a href="https://github.com/jquery/jquery/commit/d638aa9c6d6394db0c06431560b3d8b83cacc61c" class="ext-link"><span class="icon"></span>https://github.com/jquery/jquery/commit/d638aa9c6d6394db0c06431560b3d8b83cacc61c</a></p>
            </div>
          
        
          
        
          
        
      </div>
    </div>
  
</details>
</div>
        </div>
      </main>
      <footer>
        Copyright &copy; 2024
        <a href="https://openjsf.org">The OpenJS Foundation</a>
      </footer>
    </div>
    <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  </body>
</html>
